import{an as q,b2 as J,ag as o,a_ as Q,bi as X,a$ as Z,by as ee,bf as te,b0 as se,ad as ae,bx as U,b3 as C,b4 as le,bz as oe,au as B,av as M,a4 as _,aF as b,ah as n,b8 as ne,bA as D,aH as a,b5 as d,aY as ce,b7 as re,bc as E,be as ie,bd as ue,bC as de,bb as fe,bk as ve,bg as pe,at as _e}from"./index-1e3b5e9c.js";import{B as ge,W as me}from"./burn-icon-93c9a88e.js";import{C as he}from"./CloseOutlined-0d6f8edf.js";import{T as xe}from"./index-f42bfe17.js";const be={class:"selectNFTModal"},ye={class:"flex selectNFTBox"},we={class:"flex flex-col w-full p-4 space-y-2 m_modal"},Ne={class:"flex justify-between m_modal_header"},Te={class:"flex-shrink-0 text-lg text-white"},ke={class:"flex-grow overflow-hidden m_modal_content"},Ce=["onClick"],Be={class:"absolute z-10 left-1 top-1"},Me=["src"],Se={class:"top-[150px] absolute right-1 text-[#BBF74C] text-[12px] m_ko"},Fe={class:"p-[13px] m_nft"},Ie={class:"text-[15px] text-white omit m_meta_name"},Ae={class:"text-[#666666] text-xs default-family m_name"},Re={class:"flex justify-center w-full pt-4 pb-[20px]"},Ue={class:"text-sm font-bold text-black font-f"},r=28,De=q({__name:"SelectNFTModal",emits:["success"],setup(Ee,{expose:L,emit:W}){const{chain:e}=J(),I=o(),$=o(()=>I.value),{t:y}=Q(),z=o(0),S=o(-1),w=o(),g=new ne,H=W,m=X({open:!1});let c=o();const i=Z(),O=ee(),u=o(!1),N=o(!1),f=o(!1),V=o("loading..."),j=te(),T=o(0),F=o(!0),k=j.path,{open:A}=se(),h=o(!0),G=(t,l)=>{w.value=t,S.value=l,t.accountType=="BURN"?t.status="BURN":g.estimateNftStatus(i.address,{tokenAddress:t.nftAddress,tokenId:t.nftTokenId,chainId:e==null?void 0:e.id}).then(x=>{console.log(x),x.state=="unApproved"?t.status="unApproved":t.status="approved"})};ae(async()=>{if(!i.address||!e){A();return}});async function K(){if(console.log("打开弹窗"),!i.address){A();return}if(O===null)throw new Error("chain_id is null");if(u.value=!0,k=="/ring/create")try{c.value=await g.getMyNftList(i.address,{start:0,length:r,accountType:"",chainId:e==null?void 0:e.id}),u.value=!1}catch(t){C(t.message,"error",!1,3),u.value=!1}else if(k=="/ring/challengeRing")try{c.value=await g.getMyNftChalleng(i.address,{start:0,length:r,accountType:"",chainId:e==null?void 0:e.id}),u.value=!1}catch(t){C(t.message,"error",!1,3),u.value=!1}u.value=!1}const P=U.throttle(async()=>{w?(m.open=!1,H("success",w.value)):C(y("views.ring.t13"),"error",!1,3)},200),Y=async t=>{if(N.value=!0,!w.value){C(y("views.ring.t14"),"warning",!1,3),N.value=!1;return}t==0&&(console.log("select"),P(),N.value=!1)},R=U.throttle(async t=>{var s,v;const l=t.target;if(l.scrollTop+l.clientHeight>=l.scrollHeight&&F.value&&h.value){if(f.value=!0,k=="/ring/create"){h.value=!1;const p=await g.getMyNftList(i.address,{start:r+r*T.value,length:r,accountType:"",chainId:e==null?void 0:e.id});if(T.value+=1,p.length==0){F.value=!1,f.value=!1;return}c.value=(s=c.value)==null?void 0:s.concat(p),f.value=!1,h.value=!0}else if(k=="/ring/challengeRing"){h.value=!1;const p=await g.getMyNftChalleng(i.address,{start:r+r*T.value,length:r,accountType:"",chainId:e==null?void 0:e.id});if(T.value+=1,p.length==0){F.value=!1,f.value=!1;return}c.value=(v=c.value)==null?void 0:v.concat(p),f.value=!1,h.value=!0}}},300);return L({openModal:()=>{m.open=!0,c.value||K()}}),le(()=>{S.value=-1}),(t,l)=>{const x=oe("loading");return B(),M("div",{ref_key:"aModal",ref:I},[_(n(pe),{open:m.open,"onUpdate:open":l[3]||(l[3]=s=>m.open=s),closable:!1,footer:null,style:{width:"800px",height:"500px"},maskStyle:{animation:"none"},getContainer:$.value},{default:b(()=>[D((B(),M("div",be,[a("div",ye,[a("section",we,[a("div",Ne,[a("p",Te,d(n(y)("views.ring.select.chooseNft")),1),_(n(he),{class:"text-white cursor-pointer",onClick:l[0]||(l[0]=s=>m.open=!1)})]),a("div",ke,[a("div",{class:"grid max-h-full grid-cols-4 gap-2 overflow-y-auto scrollBar-y m_item",onScroll:l[1]||(l[1]=(...s)=>n(R)&&n(R)(...s))},[(B(!0),M(ce,null,re(n(c),(s,v)=>(B(),M("div",{key:v,class:E([S.value==v?"selectItem":"","relative bg-[#141414] border-solid border-[1px] font-pf cursor-pointer itemStyle"]),onClick:p=>G(s,v)},[_(n(ie),{src:s.imageUri},null,8,["src"]),a("div",Be,[a("img",{src:s.accountType=="BURN"?n(ge):n(me),class:E("bg-[#000]/[0.4] w-[30px]")},null,8,Me)]),a("div",Se,"K.O."+d(s.koScore),1),a("div",Fe,[_(n(xe),null,{title:b(()=>[ue(d(s.metaName),1)]),default:b(()=>[a("p",Ie,d(s.metaName),1)]),_:2},1024),a("p",Ae,d(s.name),1)])],10,Ce))),128)),D(a("div",{class:"text-[#666] text-center w-[716px] text-lg"},d(V.value),513),[[de,f.value]])],32)])])]),a("div",Re,[_(n(fe),{spinning:N.value},{default:b(()=>[_(n(ve),{class:"submit-btn",onClick:l[2]||(l[2]=s=>Y(z.value))},{default:b(()=>[a("span",Ue,d(n(y)("views.ring.select.choose")),1)]),_:1})]),_:1},8,["spinning"])])])),[[x,u.value]])]),_:1},8,["open","getContainer"])],512)}}});const He=_e(De,[["__scopeId","data-v-8b983a0a"]]);export{He as S};
