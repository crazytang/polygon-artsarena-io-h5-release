import{gc as l1,gd as f1,ge as d1,gf as p1,gg as g1,gh as y1,gi as m1,gj as v1,gk as w1,gl as b1,gm as Hc,gn as Bc,go as kc,gp as Kc,ep as _1,gq as xn,gr as ue,gs as E1,gt as $f,gu as Fo,gv as I1,gw as Vc,gx as Df,gy as Ff,gz as S1,gA as Uf,gB as x1,gC as P1,eA as Br,aZ as jf,bR as O1}from"./index-1e3b5e9c.js";import{e as $r,$ as Wc}from"./events-3d118bf1.js";function Gc(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function Lf(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Gc(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Ac(n,t){t||(t=n.reduce((a,h)=>a+h.length,0));const r=Lf(t);let s=0;for(const a of n)r.set(a,s),s+=a.length;return Gc(r)}const ul={...l1,...f1,...d1,...p1,...g1,...y1,...m1,...v1,...w1,...b1};function Mf(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const hl=Mf("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),hc=Mf("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=Lf(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),qf={utf8:hl,"utf-8":hl,hex:ul.base16,latin1:hc,ascii:hc,binary:hc,...ul};function gr(n,t="utf8"){const r=qf[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Gc(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}function sr(n,t="utf8"){const r=qf[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):r.encoder.encode(n).substring(1)}var ll=globalThis&&globalThis.__spreadArray||function(n,t,r){if(r||arguments.length===2)for(var s=0,a=t.length,h;s<a;s++)(h||!(s in t))&&(h||(h=Array.prototype.slice.call(t,0,s)),h[s]=t[s]);return n.concat(h||Array.prototype.slice.call(t))},A1=function(){function n(t,r,s){this.name=t,this.version=r,this.os=s,this.type="browser"}return n}(),R1=function(){function n(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return n}(),T1=function(){function n(t,r,s,a){this.name=t,this.version=r,this.os=s,this.bot=a,this.type="bot-device"}return n}(),N1=function(){function n(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return n}(),C1=function(){function n(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return n}(),$1=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,D1=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,fl=3,F1=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",$1]],dl=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function U1(n){return n?pl(n):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new C1:typeof navigator<"u"?pl(navigator.userAgent):M1()}function j1(n){return n!==""&&F1.reduce(function(t,r){var s=r[0],a=r[1];if(t)return t;var h=a.exec(n);return!!h&&[s,h]},!1)}function pl(n){var t=j1(n);if(!t)return null;var r=t[0],s=t[1];if(r==="searchbot")return new N1;var a=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);a?a.length<fl&&(a=ll(ll([],a,!0),q1(fl-a.length),!0)):a=[];var h=a.join("."),d=L1(n),v=D1.exec(n);return v&&v[1]?new T1(r,h,d,v[1]):new A1(r,h,d)}function L1(n){for(var t=0,r=dl.length;t<r;t++){var s=dl[t],a=s[0],h=s[1],d=h.exec(n);if(d)return a}return null}function M1(){var n=typeof process<"u"&&process.version;return n?new R1(process.version.slice(1)):null}function q1(n){for(var t=[],r=0;r<n;r++)t.push("0");return t}const z1={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};var H1={};(function(n){const t=kc,r=Kc,s=Hc,a=Bc,h=f=>f==null,d=Symbol("encodeFragmentIdentifier");function v(f){switch(f.arrayFormat){case"index":return y=>(b,w)=>{const g=b.length;return w===void 0||f.skipNull&&w===null||f.skipEmptyString&&w===""?b:w===null?[...b,[S(y,f),"[",g,"]"].join("")]:[...b,[S(y,f),"[",S(g,f),"]=",S(w,f)].join("")]};case"bracket":return y=>(b,w)=>w===void 0||f.skipNull&&w===null||f.skipEmptyString&&w===""?b:w===null?[...b,[S(y,f),"[]"].join("")]:[...b,[S(y,f),"[]=",S(w,f)].join("")];case"colon-list-separator":return y=>(b,w)=>w===void 0||f.skipNull&&w===null||f.skipEmptyString&&w===""?b:w===null?[...b,[S(y,f),":list="].join("")]:[...b,[S(y,f),":list=",S(w,f)].join("")];case"comma":case"separator":case"bracket-separator":{const y=f.arrayFormat==="bracket-separator"?"[]=":"=";return b=>(w,g)=>g===void 0||f.skipNull&&g===null||f.skipEmptyString&&g===""?w:(g=g===null?"":g,w.length===0?[[S(b,f),y,S(g,f)].join("")]:[[w,S(g,f)].join(f.arrayFormatSeparator)])}default:return y=>(b,w)=>w===void 0||f.skipNull&&w===null||f.skipEmptyString&&w===""?b:w===null?[...b,S(y,f)]:[...b,[S(y,f),"=",S(w,f)].join("")]}}function P(f){let y;switch(f.arrayFormat){case"index":return(b,w,g)=>{if(y=/\[(\d*)\]$/.exec(b),b=b.replace(/\[\d*\]$/,""),!y){g[b]=w;return}g[b]===void 0&&(g[b]={}),g[b][y[1]]=w};case"bracket":return(b,w,g)=>{if(y=/(\[\])$/.exec(b),b=b.replace(/\[\]$/,""),!y){g[b]=w;return}if(g[b]===void 0){g[b]=[w];return}g[b]=[].concat(g[b],w)};case"colon-list-separator":return(b,w,g)=>{if(y=/(:list)$/.exec(b),b=b.replace(/:list$/,""),!y){g[b]=w;return}if(g[b]===void 0){g[b]=[w];return}g[b]=[].concat(g[b],w)};case"comma":case"separator":return(b,w,g)=>{const C=typeof w=="string"&&w.includes(f.arrayFormatSeparator),R=typeof w=="string"&&!C&&A(w,f).includes(f.arrayFormatSeparator);w=R?A(w,f):w;const X=C||R?w.split(f.arrayFormatSeparator).map(oe=>A(oe,f)):w===null?w:A(w,f);g[b]=X};case"bracket-separator":return(b,w,g)=>{const C=/(\[\])$/.test(b);if(b=b.replace(/\[\]$/,""),!C){g[b]=w&&A(w,f);return}const R=w===null?[]:w.split(f.arrayFormatSeparator).map(X=>A(X,f));if(g[b]===void 0){g[b]=R;return}g[b]=[].concat(g[b],R)};default:return(b,w,g)=>{if(g[b]===void 0){g[b]=w;return}g[b]=[].concat(g[b],w)}}}function _(f){if(typeof f!="string"||f.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function S(f,y){return y.encode?y.strict?t(f):encodeURIComponent(f):f}function A(f,y){return y.decode?r(f):f}function j(f){return Array.isArray(f)?f.sort():typeof f=="object"?j(Object.keys(f)).sort((y,b)=>Number(y)-Number(b)).map(y=>f[y]):f}function B(f){const y=f.indexOf("#");return y!==-1&&(f=f.slice(0,y)),f}function L(f){let y="";const b=f.indexOf("#");return b!==-1&&(y=f.slice(b)),y}function J(f){f=B(f);const y=f.indexOf("?");return y===-1?"":f.slice(y+1)}function se(f,y){return y.parseNumbers&&!Number.isNaN(Number(f))&&typeof f=="string"&&f.trim()!==""?f=Number(f):y.parseBooleans&&f!==null&&(f.toLowerCase()==="true"||f.toLowerCase()==="false")&&(f=f.toLowerCase()==="true"),f}function he(f,y){y=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},y),_(y.arrayFormatSeparator);const b=P(y),w=Object.create(null);if(typeof f!="string"||(f=f.trim().replace(/^[?#&]/,""),!f))return w;for(const g of f.split("&")){if(g==="")continue;let[C,R]=s(y.decode?g.replace(/\+/g," "):g,"=");R=R===void 0?null:["comma","separator","bracket-separator"].includes(y.arrayFormat)?R:A(R,y),b(A(C,y),R,w)}for(const g of Object.keys(w)){const C=w[g];if(typeof C=="object"&&C!==null)for(const R of Object.keys(C))C[R]=se(C[R],y);else w[g]=se(C,y)}return y.sort===!1?w:(y.sort===!0?Object.keys(w).sort():Object.keys(w).sort(y.sort)).reduce((g,C)=>{const R=w[C];return R&&typeof R=="object"&&!Array.isArray(R)?g[C]=j(R):g[C]=R,g},Object.create(null))}n.extract=J,n.parse=he,n.stringify=(f,y)=>{if(!f)return"";y=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},y),_(y.arrayFormatSeparator);const b=R=>y.skipNull&&h(f[R])||y.skipEmptyString&&f[R]==="",w=v(y),g={};for(const R of Object.keys(f))b(R)||(g[R]=f[R]);const C=Object.keys(g);return y.sort!==!1&&C.sort(y.sort),C.map(R=>{const X=f[R];return X===void 0?"":X===null?S(R,y):Array.isArray(X)?X.length===0&&y.arrayFormat==="bracket-separator"?S(R,y)+"[]":X.reduce(w(R),[]).join("&"):S(R,y)+"="+S(X,y)}).filter(R=>R.length>0).join("&")},n.parseUrl=(f,y)=>{y=Object.assign({decode:!0},y);const[b,w]=s(f,"#");return Object.assign({url:b.split("?")[0]||"",query:he(J(f),y)},y&&y.parseFragmentIdentifier&&w?{fragmentIdentifier:A(w,y)}:{})},n.stringifyUrl=(f,y)=>{y=Object.assign({encode:!0,strict:!0,[d]:!0},y);const b=B(f.url).split("?")[0]||"",w=n.extract(f.url),g=n.parse(w,{sort:!1}),C=Object.assign(g,f.query);let R=n.stringify(C,y);R&&(R=`?${R}`);let X=L(f.url);return f.fragmentIdentifier&&(X=`#${y[d]?S(f.fragmentIdentifier,y):f.fragmentIdentifier}`),`${b}${R}${X}`},n.pick=(f,y,b)=>{b=Object.assign({parseFragmentIdentifier:!0,[d]:!1},b);const{url:w,query:g,fragmentIdentifier:C}=n.parseUrl(f,b);return n.stringifyUrl({url:w,query:a(g,y),fragmentIdentifier:C},b)},n.exclude=(f,y,b)=>{const w=Array.isArray(y)?g=>!y.includes(g):(g,C)=>!y(g,C);return n.pick(f,w,b)}})(H1);function B1(n,t=[]){const r=[];return Object.keys(n).forEach(s=>{if(t.length&&!t.includes(s))return;const a=n[s];r.push(...a.accounts)}),r}const k1={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function K1(n,t){const{message:r,code:s}=k1[n];return{message:t?`${r} ${t}`:r,code:s}}function Rc(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}const V1=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,W1=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,G1=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function J1(n,t){if(n==="__proto__"||n==="constructor"&&t&&typeof t=="object"&&"prototype"in t){Q1(n);return}return t}function Q1(n){console.warn(`[destr] Dropping "${n}" key to prevent prototype pollution.`)}function bo(n,t={}){if(typeof n!="string")return n;const r=n.trim();if(n[0]==='"'&&n.at(-1)==='"'&&!n.includes("\\"))return r.slice(1,-1);if(r.length<=9){const s=r.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!G1.test(n)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return n}try{if(V1.test(n)||W1.test(n)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(n,J1)}return JSON.parse(n)}catch(s){if(t.strict)throw s;return n}}function Y1(n){return!n||typeof n.then!="function"?Promise.resolve(n):n}function qt(n,...t){try{return Y1(n(...t))}catch(r){return Promise.reject(r)}}function X1(n){const t=typeof n;return n===null||t!=="object"&&t!=="function"}function Z1(n){const t=Object.getPrototypeOf(n);return!t||t.isPrototypeOf(Object)}function Po(n){if(X1(n))return String(n);if(Z1(n)||Array.isArray(n))return JSON.stringify(n);if(typeof n.toJSON=="function")return Po(n.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function zf(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const Tc="base64:";function ew(n){if(typeof n=="string")return n;zf();const t=Buffer.from(n).toString("base64");return Tc+t}function tw(n){return typeof n!="string"||!n.startsWith(Tc)?n:(zf(),Buffer.from(n.slice(Tc.length),"base64"))}function dr(n){return n?n.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function rw(...n){return dr(n.join(":"))}function _o(n){return n=dr(n),n?n+":":""}const iw="memory",nw=()=>{const n=new Map;return{name:iw,options:{},hasItem(t){return n.has(t)},getItem(t){return n.get(t)??null},getItemRaw(t){return n.get(t)??null},setItem(t,r){n.set(t,r)},setItemRaw(t,r){n.set(t,r)},removeItem(t){n.delete(t)},getKeys(){return Array.from(n.keys())},clear(){n.clear()},dispose(){n.clear()}}};function sw(n={}){const t={mounts:{"":n.driver||nw()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=_=>{for(const S of t.mountpoints)if(_.startsWith(S))return{base:S,relativeKey:_.slice(S.length),driver:t.mounts[S]};return{base:"",relativeKey:_,driver:t.mounts[""]}},s=(_,S)=>t.mountpoints.filter(A=>A.startsWith(_)||S&&_.startsWith(A)).map(A=>({relativeBase:_.length>A.length?_.slice(A.length):void 0,mountpoint:A,driver:t.mounts[A]})),a=(_,S)=>{if(t.watching){S=dr(S);for(const A of t.watchListeners)A(_,S)}},h=async()=>{if(!t.watching){t.watching=!0;for(const _ in t.mounts)t.unwatch[_]=await gl(t.mounts[_],a,_)}},d=async()=>{if(t.watching){for(const _ in t.unwatch)await t.unwatch[_]();t.unwatch={},t.watching=!1}},v=(_,S,A)=>{const j=new Map,B=L=>{let J=j.get(L.base);return J||(J={driver:L.driver,base:L.base,items:[]},j.set(L.base,J)),J};for(const L of _){const J=typeof L=="string",se=dr(J?L:L.key),he=J?void 0:L.value,f=J||!L.options?S:{...S,...L.options},y=r(se);B(y).items.push({key:se,value:he,relativeKey:y.relativeKey,options:f})}return Promise.all([...j.values()].map(L=>A(L))).then(L=>L.flat())},P={hasItem(_,S={}){_=dr(_);const{relativeKey:A,driver:j}=r(_);return qt(j.hasItem,A,S)},getItem(_,S={}){_=dr(_);const{relativeKey:A,driver:j}=r(_);return qt(j.getItem,A,S).then(B=>bo(B))},getItems(_,S){return v(_,S,A=>A.driver.getItems?qt(A.driver.getItems,A.items.map(j=>({key:j.relativeKey,options:j.options})),S).then(j=>j.map(B=>({key:rw(A.base,B.key),value:bo(B.value)}))):Promise.all(A.items.map(j=>qt(A.driver.getItem,j.relativeKey,j.options).then(B=>({key:j.key,value:bo(B)})))))},getItemRaw(_,S={}){_=dr(_);const{relativeKey:A,driver:j}=r(_);return j.getItemRaw?qt(j.getItemRaw,A,S):qt(j.getItem,A,S).then(B=>tw(B))},async setItem(_,S,A={}){if(S===void 0)return P.removeItem(_);_=dr(_);const{relativeKey:j,driver:B}=r(_);B.setItem&&(await qt(B.setItem,j,Po(S),A),B.watch||a("update",_))},async setItems(_,S){await v(_,S,async A=>{A.driver.setItems&&await qt(A.driver.setItems,A.items.map(j=>({key:j.relativeKey,value:Po(j.value),options:j.options})),S),A.driver.setItem&&await Promise.all(A.items.map(j=>qt(A.driver.setItem,j.relativeKey,Po(j.value),j.options)))})},async setItemRaw(_,S,A={}){if(S===void 0)return P.removeItem(_,A);_=dr(_);const{relativeKey:j,driver:B}=r(_);if(B.setItemRaw)await qt(B.setItemRaw,j,S,A);else if(B.setItem)await qt(B.setItem,j,ew(S),A);else return;B.watch||a("update",_)},async removeItem(_,S={}){typeof S=="boolean"&&(S={removeMeta:S}),_=dr(_);const{relativeKey:A,driver:j}=r(_);j.removeItem&&(await qt(j.removeItem,A,S),(S.removeMeta||S.removeMata)&&await qt(j.removeItem,A+"$",S),j.watch||a("remove",_))},async getMeta(_,S={}){typeof S=="boolean"&&(S={nativeOnly:S}),_=dr(_);const{relativeKey:A,driver:j}=r(_),B=Object.create(null);if(j.getMeta&&Object.assign(B,await qt(j.getMeta,A,S)),!S.nativeOnly){const L=await qt(j.getItem,A+"$",S).then(J=>bo(J));L&&typeof L=="object"&&(typeof L.atime=="string"&&(L.atime=new Date(L.atime)),typeof L.mtime=="string"&&(L.mtime=new Date(L.mtime)),Object.assign(B,L))}return B},setMeta(_,S,A={}){return this.setItem(_+"$",S,A)},removeMeta(_,S={}){return this.removeItem(_+"$",S)},async getKeys(_,S={}){_=_o(_);const A=s(_,!0);let j=[];const B=[];for(const L of A){const se=(await qt(L.driver.getKeys,L.relativeBase,S)).map(he=>L.mountpoint+dr(he)).filter(he=>!j.some(f=>he.startsWith(f)));B.push(...se),j=[L.mountpoint,...j.filter(he=>!he.startsWith(L.mountpoint))]}return _?B.filter(L=>L.startsWith(_)&&!L.endsWith("$")):B.filter(L=>!L.endsWith("$"))},async clear(_,S={}){_=_o(_),await Promise.all(s(_,!1).map(async A=>{if(A.driver.clear)return qt(A.driver.clear,A.relativeBase,S);if(A.driver.removeItem){const j=await A.driver.getKeys(A.relativeBase||"",S);return Promise.all(j.map(B=>A.driver.removeItem(B,S)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(_=>yl(_)))},async watch(_){return await h(),t.watchListeners.push(_),async()=>{t.watchListeners=t.watchListeners.filter(S=>S!==_),t.watchListeners.length===0&&await d()}},async unwatch(){t.watchListeners=[],await d()},mount(_,S){if(_=_o(_),_&&t.mounts[_])throw new Error(`already mounted at ${_}`);return _&&(t.mountpoints.push(_),t.mountpoints.sort((A,j)=>j.length-A.length)),t.mounts[_]=S,t.watching&&Promise.resolve(gl(S,a,_)).then(A=>{t.unwatch[_]=A}).catch(console.error),P},async unmount(_,S=!0){_=_o(_),!(!_||!t.mounts[_])&&(t.watching&&_ in t.unwatch&&(t.unwatch[_](),delete t.unwatch[_]),S&&await yl(t.mounts[_]),t.mountpoints=t.mountpoints.filter(A=>A!==_),delete t.mounts[_])},getMount(_=""){_=dr(_)+":";const S=r(_);return{driver:S.driver,base:S.base}},getMounts(_="",S={}){return _=dr(_),s(_,S.parents).map(j=>({driver:j.driver,base:j.mountpoint}))}};return P}function gl(n,t,r){return n.watch?n.watch((s,a)=>t(s,r+a)):()=>{}}async function yl(n){typeof n.dispose=="function"&&await qt(n.dispose)}function Qi(n){return new Promise((t,r)=>{n.oncomplete=n.onsuccess=()=>t(n.result),n.onabort=n.onerror=()=>r(n.error)})}function Hf(n,t){const r=indexedDB.open(n);r.onupgradeneeded=()=>r.result.createObjectStore(t);const s=Qi(r);return(a,h)=>s.then(d=>h(d.transaction(t,a).objectStore(t)))}let lc;function us(){return lc||(lc=Hf("keyval-store","keyval")),lc}function ml(n,t=us()){return t("readonly",r=>Qi(r.get(n)))}function ow(n,t,r=us()){return r("readwrite",s=>(s.put(t,n),Qi(s.transaction)))}function aw(n,t=us()){return t("readwrite",r=>(r.delete(n),Qi(r.transaction)))}function cw(n=us()){return n("readwrite",t=>(t.clear(),Qi(t.transaction)))}function uw(n,t){return n.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Qi(n.transaction)}function hw(n=us()){return n("readonly",t=>{if(t.getAllKeys)return Qi(t.getAllKeys());const r=[];return uw(t,s=>r.push(s.key)).then(()=>r)})}const lw=n=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),fw=n=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function hs(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return fw(n)}catch{return n}}function Ji(n){return typeof n=="string"?n:lw(n)||""}const dw="idb-keyval";var pw=(n={})=>{const t=n.base&&n.base.length>0?`${n.base}:`:"",r=a=>t+a;let s;return n.dbName&&n.storeName&&(s=Hf(n.dbName,n.storeName)),{name:dw,options:n,async hasItem(a){return!(typeof await ml(r(a),s)>"u")},async getItem(a){return await ml(r(a),s)??null},setItem(a,h){return ow(r(a),h,s)},removeItem(a){return aw(r(a),s)},getKeys(){return hw(s)},clear(){return cw(s)}}};const gw="WALLET_CONNECT_V2_INDEXED_DB",yw="keyvaluestorage";let mw=class{constructor(){this.indexedDb=sw({driver:pw({dbName:gw,storeName:yw})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const r=await this.indexedDb.getItem(t);if(r!==null)return r}async setItem(t,r){await this.indexedDb.setItem(t,Ji(r))}async removeItem(t){await this.indexedDb.removeItem(t)}};var fc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Oo={exports:{}};(function(){let n;function t(){}n=t,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof fc<"u"&&fc.localStorage?Oo.exports=fc.localStorage:typeof window<"u"&&window.localStorage?Oo.exports=window.localStorage:Oo.exports=new t})();function vw(n){var t;return[n[0],hs((t=n[1])!=null?t:"")]}let ww=class{constructor(){this.localStorage=Oo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(vw)}async getItem(t){const r=this.localStorage.getItem(t);if(r!==null)return hs(r)}async setItem(t,r){this.localStorage.setItem(t,Ji(r))}async removeItem(t){this.localStorage.removeItem(t)}};const bw="wc_storage_version",vl=1,_w=async(n,t,r)=>{const s=bw,a=await t.getItem(s);if(a&&a>=vl){r(t);return}const h=await n.getKeys();if(!h.length){r(t);return}const d=[];for(;h.length;){const v=h.shift();if(!v)continue;const P=v.toLowerCase();if(P.includes("wc@")||P.includes("walletconnect")||P.includes("wc_")||P.includes("wallet_connect")){const _=await n.getItem(v);await t.setItem(v,_),d.push(v)}}await t.setItem(s,vl),r(t),Ew(n,d)},Ew=async(n,t)=>{t.length&&t.forEach(async r=>{await n.removeItem(r)})};let Iw=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const t=new ww;this.storage=t;try{const r=new mw;_w(t,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,r){return await this.initialize(),this.storage.setItem(t,r)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),t())},20)})}};var Pn={},Jn={},dc={},Qn={};let Yi=class{};const Sw=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Yi},Symbol.toStringTag,{value:"Module"})),xw=_1(Sw);var wl;function Pw(){if(wl)return Qn;wl=1,Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.IHeartBeat=void 0;const n=xw;class t extends n.IEvents{constructor(s){super()}}return Qn.IHeartBeat=t,Qn}var bl;function Bf(){return bl||(bl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),xn.__exportStar(Pw(),n)}(dc)),dc}var pc={},Vi={},_l;function Ow(){if(_l)return Vi;_l=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.HEARTBEAT_EVENTS=Vi.HEARTBEAT_INTERVAL=void 0;const n=ue;return Vi.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,Vi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Vi}var El;function kf(){return El||(El=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),xn.__exportStar(Ow(),n)}(pc)),pc}var Il;function Aw(){if(Il)return Jn;Il=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.HeartBeat=void 0;const n=xn,t=$r,r=ue,s=Bf(),a=kf();class h extends s.IHeartBeat{constructor(v){super(v),this.events=new t.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(v==null?void 0:v.interval)||a.HEARTBEAT_INTERVAL}static init(v){return n.__awaiter(this,void 0,void 0,function*(){const P=new h(v);return yield P.init(),P})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(v,P){this.events.on(v,P)}once(v,P){this.events.once(v,P)}off(v,P){this.events.off(v,P)}removeListener(v,P){this.events.removeListener(v,P)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return Jn.HeartBeat=h,Jn}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=xn;t.__exportStar(Aw(),n),t.__exportStar(Bf(),n),t.__exportStar(kf(),n)})(Pn);var Te={},gc,Sl;function Rw(){if(Sl)return gc;Sl=1;function n(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}gc=t;function t(r,s,a){var h=a&&a.stringify||n,d=1;if(typeof r=="object"&&r!==null){var v=s.length+d;if(v===1)return r;var P=new Array(v);P[0]=h(r);for(var _=1;_<v;_++)P[_]=h(s[_]);return P.join(" ")}if(typeof r!="string")return r;var S=s.length;if(S===0)return r;for(var A="",j=1-d,B=-1,L=r&&r.length||0,J=0;J<L;){if(r.charCodeAt(J)===37&&J+1<L){switch(B=B>-1?B:0,r.charCodeAt(J+1)){case 100:case 102:if(j>=S||s[j]==null)break;B<J&&(A+=r.slice(B,J)),A+=Number(s[j]),B=J+2,J++;break;case 105:if(j>=S||s[j]==null)break;B<J&&(A+=r.slice(B,J)),A+=Math.floor(Number(s[j])),B=J+2,J++;break;case 79:case 111:case 106:if(j>=S||s[j]===void 0)break;B<J&&(A+=r.slice(B,J));var se=typeof s[j];if(se==="string"){A+="'"+s[j]+"'",B=J+2,J++;break}if(se==="function"){A+=s[j].name||"<anonymous>",B=J+2,J++;break}A+=h(s[j]),B=J+2,J++;break;case 115:if(j>=S)break;B<J&&(A+=r.slice(B,J)),A+=String(s[j]),B=J+2,J++;break;case 37:B<J&&(A+=r.slice(B,J)),A+="%",B=J+2,J++,j--;break}++j}++J}return B===-1?r:(B<L&&(A+=r.slice(B)),A)}return gc}var yc,xl;function Tw(){if(xl)return yc;xl=1;const n=Rw();yc=a;const t=w().console||{},r={mapHttpRequest:L,mapHttpResponse:L,wrapRequestSerializer:J,wrapResponseSerializer:J,wrapErrorSerializer:J,req:L,res:L,err:j};function s(g,C){return Array.isArray(g)?g.filter(function(X){return X!=="!stdSerializers.err"}):g===!0?Object.keys(C):!1}function a(g){g=g||{},g.browser=g.browser||{};const C=g.browser.transmit;if(C&&typeof C.send!="function")throw Error("pino: transmit option must have a send function");const R=g.browser.write||t;g.browser.write&&(g.browser.asObject=!0);const X=g.serializers||{},oe=s(g.browser.serialize,X);let ge=g.browser.serialize;Array.isArray(g.browser.serialize)&&g.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ge=!1);const Ne=["error","fatal","warn","info","debug","trace"];typeof R=="function"&&(R.error=R.fatal=R.warn=R.info=R.debug=R.trace=R),g.enabled===!1&&(g.level="silent");const qe=g.level||"info",I=Object.create(R);I.log||(I.log=se),Object.defineProperty(I,"levelVal",{get:ie}),Object.defineProperty(I,"level",{get:pe,set:Y});const N={transmit:C,serialize:oe,asObject:g.browser.asObject,levels:Ne,timestamp:B(g)};I.levels=a.levels,I.level=qe,I.setMaxListeners=I.getMaxListeners=I.emit=I.addListener=I.on=I.prependListener=I.once=I.prependOnceListener=I.removeListener=I.removeAllListeners=I.listeners=I.listenerCount=I.eventNames=I.write=I.flush=se,I.serializers=X,I._serialize=oe,I._stdErrSerialize=ge,I.child=W,C&&(I._logEvent=A());function ie(){return this.level==="silent"?1/0:this.levels.values[this.level]}function pe(){return this._level}function Y(Q){if(Q!=="silent"&&!this.levels.values[Q])throw Error("unknown level "+Q);this._level=Q,h(N,I,"error","log"),h(N,I,"fatal","error"),h(N,I,"warn","error"),h(N,I,"info","log"),h(N,I,"debug","log"),h(N,I,"trace","log")}function W(Q,Z){if(!Q)throw new Error("missing bindings for child Pino");Z=Z||{},oe&&Q.serializers&&(Z.serializers=Q.serializers);const Je=Z.serializers;if(oe&&Je){var Be=Object.assign({},X,Je),kr=g.browser.serialize===!0?Object.keys(Be):oe;delete Q.serializers,P([Q],kr,Be,this._stdErrSerialize)}function Ie(It){this._childLevel=(It._childLevel|0)+1,this.error=_(It,Q,"error"),this.fatal=_(It,Q,"fatal"),this.warn=_(It,Q,"warn"),this.info=_(It,Q,"info"),this.debug=_(It,Q,"debug"),this.trace=_(It,Q,"trace"),Be&&(this.serializers=Be,this._serialize=kr),C&&(this._logEvent=A([].concat(It._logEvent.bindings,Q)))}return Ie.prototype=this,new Ie(this)}return I}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:he,epochTime:f,unixTime:y,isoTime:b});function h(g,C,R,X){const oe=Object.getPrototypeOf(C);C[R]=C.levelVal>C.levels.values[R]?se:oe[R]?oe[R]:t[R]||t[X]||se,d(g,C,R)}function d(g,C,R){!g.transmit&&C[R]===se||(C[R]=function(X){return function(){const ge=g.timestamp(),Ne=new Array(arguments.length),qe=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var I=0;I<Ne.length;I++)Ne[I]=arguments[I];if(g.serialize&&!g.asObject&&P(Ne,this._serialize,this.serializers,this._stdErrSerialize),g.asObject?X.call(qe,v(this,R,Ne,ge)):X.apply(qe,Ne),g.transmit){const N=g.transmit.level||C.level,ie=a.levels.values[N],pe=a.levels.values[R];if(pe<ie)return;S(this,{ts:ge,methodLevel:R,methodValue:pe,transmitLevel:N,transmitValue:a.levels.values[g.transmit.level||C.level],send:g.transmit.send,val:C.levelVal},Ne)}}}(C[R]))}function v(g,C,R,X){g._serialize&&P(R,g._serialize,g.serializers,g._stdErrSerialize);const oe=R.slice();let ge=oe[0];const Ne={};X&&(Ne.time=X),Ne.level=a.levels.values[C];let qe=(g._childLevel|0)+1;if(qe<1&&(qe=1),ge!==null&&typeof ge=="object"){for(;qe--&&typeof oe[0]=="object";)Object.assign(Ne,oe.shift());ge=oe.length?n(oe.shift(),oe):void 0}else typeof ge=="string"&&(ge=n(oe.shift(),oe));return ge!==void 0&&(Ne.msg=ge),Ne}function P(g,C,R,X){for(const oe in g)if(X&&g[oe]instanceof Error)g[oe]=a.stdSerializers.err(g[oe]);else if(typeof g[oe]=="object"&&!Array.isArray(g[oe]))for(const ge in g[oe])C&&C.indexOf(ge)>-1&&ge in R&&(g[oe][ge]=R[ge](g[oe][ge]))}function _(g,C,R){return function(){const X=new Array(1+arguments.length);X[0]=C;for(var oe=1;oe<X.length;oe++)X[oe]=arguments[oe-1];return g[R].apply(this,X)}}function S(g,C,R){const X=C.send,oe=C.ts,ge=C.methodLevel,Ne=C.methodValue,qe=C.val,I=g._logEvent.bindings;P(R,g._serialize||Object.keys(g.serializers),g.serializers,g._stdErrSerialize===void 0?!0:g._stdErrSerialize),g._logEvent.ts=oe,g._logEvent.messages=R.filter(function(N){return I.indexOf(N)===-1}),g._logEvent.level.label=ge,g._logEvent.level.value=Ne,X(ge,g._logEvent,qe),g._logEvent=A(I)}function A(g){return{ts:0,messages:[],bindings:g||[],level:{label:"",value:0}}}function j(g){const C={type:g.constructor.name,msg:g.message,stack:g.stack};for(const R in g)C[R]===void 0&&(C[R]=g[R]);return C}function B(g){return typeof g.timestamp=="function"?g.timestamp:g.timestamp===!1?he:f}function L(){return{}}function J(g){return g}function se(){}function he(){return!1}function f(){return Date.now()}function y(){return Math.round(Date.now()/1e3)}function b(){return new Date(Date.now()).toISOString()}function w(){function g(C){return typeof C<"u"&&C}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return g(self)||g(window)||g(this)||{}}}return yc}var Wi={},Pl;function Kf(){return Pl||(Pl=1,Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.PINO_CUSTOM_CONTEXT_KEY=Wi.PINO_LOGGER_DEFAULTS=void 0,Wi.PINO_LOGGER_DEFAULTS={level:"info"},Wi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Wi}var rr={},Ol;function Nw(){if(Ol)return rr;Ol=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.generateChildLogger=rr.formatChildLoggerContext=rr.getLoggerContext=rr.setBrowserLoggerContext=rr.getBrowserLoggerContext=rr.getDefaultLoggerOptions=void 0;const n=Kf();function t(v){return Object.assign(Object.assign({},v),{level:(v==null?void 0:v.level)||n.PINO_LOGGER_DEFAULTS.level})}rr.getDefaultLoggerOptions=t;function r(v,P=n.PINO_CUSTOM_CONTEXT_KEY){return v[P]||""}rr.getBrowserLoggerContext=r;function s(v,P,_=n.PINO_CUSTOM_CONTEXT_KEY){return v[_]=P,v}rr.setBrowserLoggerContext=s;function a(v,P=n.PINO_CUSTOM_CONTEXT_KEY){let _="";return typeof v.bindings>"u"?_=r(v,P):_=v.bindings().context||"",_}rr.getLoggerContext=a;function h(v,P,_=n.PINO_CUSTOM_CONTEXT_KEY){const S=a(v,_);return S.trim()?`${S}/${P}`:P}rr.formatChildLoggerContext=h;function d(v,P,_=n.PINO_CUSTOM_CONTEXT_KEY){const S=h(v,P,_),A=v.child({context:S});return s(A,S,_)}return rr.generateChildLogger=d,rr}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const t=xn,r=t.__importDefault(Tw());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(Kf(),n),t.__exportStar(Nw(),n)})(Te);class Cw extends Yi{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}let $w=class extends Yi{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}},Dw=class{constructor(t,r){this.logger=t,this.core=r}},Fw=class extends Yi{constructor(t,r){super(),this.relayer=t,this.logger=r}},Uw=class extends Yi{constructor(t){super()}},jw=class{constructor(t,r,s,a){this.core=t,this.logger=r,this.name=s}};class Lw extends Yi{constructor(t,r){super(),this.relayer=t,this.logger=r}}let Mw=class extends Yi{constructor(t,r){super(),this.core=t,this.logger=r}},qw=class{constructor(t,r){this.projectId=t,this.logger=r}},zw=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},Hw=class{constructor(t){this.client=t}};var Jc={},Vf={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=E1,r=$f;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function v(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return v.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},v.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},v.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},v.prototype.update=function(P,_){if(_===void 0&&(_=P.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var S=0;if(this._bytesHashed+=_,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&_>0;)this._buffer[this._bufferLength++]=P[S++],_--;this._bufferLength===this.blockSize&&(h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(_>=this.blockSize&&(S=h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,P,S,_),_%=this.blockSize);_>0;)this._buffer[this._bufferLength++]=P[S++],_--;return this},v.prototype.finish=function(P){if(!this._finished){var _=this._bytesHashed,S=this._bufferLength,A=_/536870912|0,j=_<<3,B=_%128<112?128:256;this._buffer[S]=128;for(var L=S+1;L<B-8;L++)this._buffer[L]=0;t.writeUint32BE(A,this._buffer,B-8),t.writeUint32BE(j,this._buffer,B-4),h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,B),this._finished=!0}for(var L=0;L<this.digestLength/8;L++)t.writeUint32BE(this._stateHi[L],P,L*8),t.writeUint32BE(this._stateLo[L],P,L*8+4);return this},v.prototype.digest=function(){var P=new Uint8Array(this.digestLength);return this.finish(P),P},v.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},v.prototype.restoreState=function(P){return this._stateHi.set(P.stateHi),this._stateLo.set(P.stateLo),this._bufferLength=P.bufferLength,P.buffer&&this._buffer.set(P.buffer),this._bytesHashed=P.bytesHashed,this._finished=!1,this},v.prototype.cleanSavedState=function(P){r.wipe(P.stateHi),r.wipe(P.stateLo),P.buffer&&r.wipe(P.buffer),P.bufferLength=0,P.bytesHashed=0},v}();n.SHA512=s;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function h(v,P,_,S,A,j,B){for(var L=_[0],J=_[1],se=_[2],he=_[3],f=_[4],y=_[5],b=_[6],w=_[7],g=S[0],C=S[1],R=S[2],X=S[3],oe=S[4],ge=S[5],Ne=S[6],qe=S[7],I,N,ie,pe,Y,W,Q,Z;B>=128;){for(var Je=0;Je<16;Je++){var Be=8*Je+j;v[Je]=t.readUint32BE(A,Be),P[Je]=t.readUint32BE(A,Be+4)}for(var Je=0;Je<80;Je++){var kr=L,Ie=J,It=se,z=he,q=f,U=y,u=b,T=w,ae=g,ye=C,_e=R,Ce=X,De=oe,Pe=ge,St=Ne,vt=qe;if(I=w,N=qe,Y=N&65535,W=N>>>16,Q=I&65535,Z=I>>>16,I=(f>>>14|oe<<32-14)^(f>>>18|oe<<32-18)^(oe>>>41-32|f<<32-(41-32)),N=(oe>>>14|f<<32-14)^(oe>>>18|f<<32-18)^(f>>>41-32|oe<<32-(41-32)),Y+=N&65535,W+=N>>>16,Q+=I&65535,Z+=I>>>16,I=f&y^~f&b,N=oe&ge^~oe&Ne,Y+=N&65535,W+=N>>>16,Q+=I&65535,Z+=I>>>16,I=a[Je*2],N=a[Je*2+1],Y+=N&65535,W+=N>>>16,Q+=I&65535,Z+=I>>>16,I=v[Je%16],N=P[Je%16],Y+=N&65535,W+=N>>>16,Q+=I&65535,Z+=I>>>16,W+=Y>>>16,Q+=W>>>16,Z+=Q>>>16,ie=Q&65535|Z<<16,pe=Y&65535|W<<16,I=ie,N=pe,Y=N&65535,W=N>>>16,Q=I&65535,Z=I>>>16,I=(L>>>28|g<<32-28)^(g>>>34-32|L<<32-(34-32))^(g>>>39-32|L<<32-(39-32)),N=(g>>>28|L<<32-28)^(L>>>34-32|g<<32-(34-32))^(L>>>39-32|g<<32-(39-32)),Y+=N&65535,W+=N>>>16,Q+=I&65535,Z+=I>>>16,I=L&J^L&se^J&se,N=g&C^g&R^C&R,Y+=N&65535,W+=N>>>16,Q+=I&65535,Z+=I>>>16,W+=Y>>>16,Q+=W>>>16,Z+=Q>>>16,T=Q&65535|Z<<16,vt=Y&65535|W<<16,I=z,N=Ce,Y=N&65535,W=N>>>16,Q=I&65535,Z=I>>>16,I=ie,N=pe,Y+=N&65535,W+=N>>>16,Q+=I&65535,Z+=I>>>16,W+=Y>>>16,Q+=W>>>16,Z+=Q>>>16,z=Q&65535|Z<<16,Ce=Y&65535|W<<16,J=kr,se=Ie,he=It,f=z,y=q,b=U,w=u,L=T,C=ae,R=ye,X=_e,oe=Ce,ge=De,Ne=Pe,qe=St,g=vt,Je%16===15)for(var Be=0;Be<16;Be++)I=v[Be],N=P[Be],Y=N&65535,W=N>>>16,Q=I&65535,Z=I>>>16,I=v[(Be+9)%16],N=P[(Be+9)%16],Y+=N&65535,W+=N>>>16,Q+=I&65535,Z+=I>>>16,ie=v[(Be+1)%16],pe=P[(Be+1)%16],I=(ie>>>1|pe<<32-1)^(ie>>>8|pe<<32-8)^ie>>>7,N=(pe>>>1|ie<<32-1)^(pe>>>8|ie<<32-8)^(pe>>>7|ie<<32-7),Y+=N&65535,W+=N>>>16,Q+=I&65535,Z+=I>>>16,ie=v[(Be+14)%16],pe=P[(Be+14)%16],I=(ie>>>19|pe<<32-19)^(pe>>>61-32|ie<<32-(61-32))^ie>>>6,N=(pe>>>19|ie<<32-19)^(ie>>>61-32|pe<<32-(61-32))^(pe>>>6|ie<<32-6),Y+=N&65535,W+=N>>>16,Q+=I&65535,Z+=I>>>16,W+=Y>>>16,Q+=W>>>16,Z+=Q>>>16,v[Be]=Q&65535|Z<<16,P[Be]=Y&65535|W<<16}I=L,N=g,Y=N&65535,W=N>>>16,Q=I&65535,Z=I>>>16,I=_[0],N=S[0],Y+=N&65535,W+=N>>>16,Q+=I&65535,Z+=I>>>16,W+=Y>>>16,Q+=W>>>16,Z+=Q>>>16,_[0]=L=Q&65535|Z<<16,S[0]=g=Y&65535|W<<16,I=J,N=C,Y=N&65535,W=N>>>16,Q=I&65535,Z=I>>>16,I=_[1],N=S[1],Y+=N&65535,W+=N>>>16,Q+=I&65535,Z+=I>>>16,W+=Y>>>16,Q+=W>>>16,Z+=Q>>>16,_[1]=J=Q&65535|Z<<16,S[1]=C=Y&65535|W<<16,I=se,N=R,Y=N&65535,W=N>>>16,Q=I&65535,Z=I>>>16,I=_[2],N=S[2],Y+=N&65535,W+=N>>>16,Q+=I&65535,Z+=I>>>16,W+=Y>>>16,Q+=W>>>16,Z+=Q>>>16,_[2]=se=Q&65535|Z<<16,S[2]=R=Y&65535|W<<16,I=he,N=X,Y=N&65535,W=N>>>16,Q=I&65535,Z=I>>>16,I=_[3],N=S[3],Y+=N&65535,W+=N>>>16,Q+=I&65535,Z+=I>>>16,W+=Y>>>16,Q+=W>>>16,Z+=Q>>>16,_[3]=he=Q&65535|Z<<16,S[3]=X=Y&65535|W<<16,I=f,N=oe,Y=N&65535,W=N>>>16,Q=I&65535,Z=I>>>16,I=_[4],N=S[4],Y+=N&65535,W+=N>>>16,Q+=I&65535,Z+=I>>>16,W+=Y>>>16,Q+=W>>>16,Z+=Q>>>16,_[4]=f=Q&65535|Z<<16,S[4]=oe=Y&65535|W<<16,I=y,N=ge,Y=N&65535,W=N>>>16,Q=I&65535,Z=I>>>16,I=_[5],N=S[5],Y+=N&65535,W+=N>>>16,Q+=I&65535,Z+=I>>>16,W+=Y>>>16,Q+=W>>>16,Z+=Q>>>16,_[5]=y=Q&65535|Z<<16,S[5]=ge=Y&65535|W<<16,I=b,N=Ne,Y=N&65535,W=N>>>16,Q=I&65535,Z=I>>>16,I=_[6],N=S[6],Y+=N&65535,W+=N>>>16,Q+=I&65535,Z+=I>>>16,W+=Y>>>16,Q+=W>>>16,Z+=Q>>>16,_[6]=b=Q&65535|Z<<16,S[6]=Ne=Y&65535|W<<16,I=w,N=qe,Y=N&65535,W=N>>>16,Q=I&65535,Z=I>>>16,I=_[7],N=S[7],Y+=N&65535,W+=N>>>16,Q+=I&65535,Z+=I>>>16,W+=Y>>>16,Q+=W>>>16,Z+=Q>>>16,_[7]=w=Q&65535|Z<<16,S[7]=qe=Y&65535|W<<16,j+=128,B-=128}return j}function d(v){var P=new s;P.update(v);var _=P.digest();return P.clean(),_}n.hash=d})(Vf);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const t=Fo,r=Vf,s=$f;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function a(z){const q=new Float64Array(16);if(z)for(let U=0;U<z.length;U++)q[U]=z[U];return q}const h=new Uint8Array(32);h[0]=9;const d=a(),v=a([1]),P=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),_=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),S=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),A=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),j=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function B(z,q){for(let U=0;U<16;U++)z[U]=q[U]|0}function L(z){let q=1;for(let U=0;U<16;U++){let u=z[U]+q+65535;q=Math.floor(u/65536),z[U]=u-q*65536}z[0]+=q-1+37*(q-1)}function J(z,q,U){const u=~(U-1);for(let T=0;T<16;T++){const ae=u&(z[T]^q[T]);z[T]^=ae,q[T]^=ae}}function se(z,q){const U=a(),u=a();for(let T=0;T<16;T++)u[T]=q[T];L(u),L(u),L(u);for(let T=0;T<2;T++){U[0]=u[0]-65517;for(let ye=1;ye<15;ye++)U[ye]=u[ye]-65535-(U[ye-1]>>16&1),U[ye-1]&=65535;U[15]=u[15]-32767-(U[14]>>16&1);const ae=U[15]>>16&1;U[14]&=65535,J(u,U,1-ae)}for(let T=0;T<16;T++)z[2*T]=u[T]&255,z[2*T+1]=u[T]>>8}function he(z,q){let U=0;for(let u=0;u<32;u++)U|=z[u]^q[u];return(1&U-1>>>8)-1}function f(z,q){const U=new Uint8Array(32),u=new Uint8Array(32);return se(U,z),se(u,q),he(U,u)}function y(z){const q=new Uint8Array(32);return se(q,z),q[0]&1}function b(z,q){for(let U=0;U<16;U++)z[U]=q[2*U]+(q[2*U+1]<<8);z[15]&=32767}function w(z,q,U){for(let u=0;u<16;u++)z[u]=q[u]+U[u]}function g(z,q,U){for(let u=0;u<16;u++)z[u]=q[u]-U[u]}function C(z,q,U){let u,T,ae=0,ye=0,_e=0,Ce=0,De=0,Pe=0,St=0,vt=0,ot=0,Ue=0,Ye=0,Xe=0,at=0,ze=0,Ze=0,$e=0,ke=0,ht=0,Le=0,xt=0,Dt=0,Bt=0,kt=0,jt=0,Qt=0,or=0,Kr=0,Yt=0,Xr=0,mi=0,Ci=0,lt=U[0],rt=U[1],ft=U[2],dt=U[3],ct=U[4],it=U[5],Pt=U[6],Ot=U[7],pt=U[8],At=U[9],gt=U[10],wt=U[11],yt=U[12],Qe=U[13],Rt=U[14],Tt=U[15];u=q[0],ae+=u*lt,ye+=u*rt,_e+=u*ft,Ce+=u*dt,De+=u*ct,Pe+=u*it,St+=u*Pt,vt+=u*Ot,ot+=u*pt,Ue+=u*At,Ye+=u*gt,Xe+=u*wt,at+=u*yt,ze+=u*Qe,Ze+=u*Rt,$e+=u*Tt,u=q[1],ye+=u*lt,_e+=u*rt,Ce+=u*ft,De+=u*dt,Pe+=u*ct,St+=u*it,vt+=u*Pt,ot+=u*Ot,Ue+=u*pt,Ye+=u*At,Xe+=u*gt,at+=u*wt,ze+=u*yt,Ze+=u*Qe,$e+=u*Rt,ke+=u*Tt,u=q[2],_e+=u*lt,Ce+=u*rt,De+=u*ft,Pe+=u*dt,St+=u*ct,vt+=u*it,ot+=u*Pt,Ue+=u*Ot,Ye+=u*pt,Xe+=u*At,at+=u*gt,ze+=u*wt,Ze+=u*yt,$e+=u*Qe,ke+=u*Rt,ht+=u*Tt,u=q[3],Ce+=u*lt,De+=u*rt,Pe+=u*ft,St+=u*dt,vt+=u*ct,ot+=u*it,Ue+=u*Pt,Ye+=u*Ot,Xe+=u*pt,at+=u*At,ze+=u*gt,Ze+=u*wt,$e+=u*yt,ke+=u*Qe,ht+=u*Rt,Le+=u*Tt,u=q[4],De+=u*lt,Pe+=u*rt,St+=u*ft,vt+=u*dt,ot+=u*ct,Ue+=u*it,Ye+=u*Pt,Xe+=u*Ot,at+=u*pt,ze+=u*At,Ze+=u*gt,$e+=u*wt,ke+=u*yt,ht+=u*Qe,Le+=u*Rt,xt+=u*Tt,u=q[5],Pe+=u*lt,St+=u*rt,vt+=u*ft,ot+=u*dt,Ue+=u*ct,Ye+=u*it,Xe+=u*Pt,at+=u*Ot,ze+=u*pt,Ze+=u*At,$e+=u*gt,ke+=u*wt,ht+=u*yt,Le+=u*Qe,xt+=u*Rt,Dt+=u*Tt,u=q[6],St+=u*lt,vt+=u*rt,ot+=u*ft,Ue+=u*dt,Ye+=u*ct,Xe+=u*it,at+=u*Pt,ze+=u*Ot,Ze+=u*pt,$e+=u*At,ke+=u*gt,ht+=u*wt,Le+=u*yt,xt+=u*Qe,Dt+=u*Rt,Bt+=u*Tt,u=q[7],vt+=u*lt,ot+=u*rt,Ue+=u*ft,Ye+=u*dt,Xe+=u*ct,at+=u*it,ze+=u*Pt,Ze+=u*Ot,$e+=u*pt,ke+=u*At,ht+=u*gt,Le+=u*wt,xt+=u*yt,Dt+=u*Qe,Bt+=u*Rt,kt+=u*Tt,u=q[8],ot+=u*lt,Ue+=u*rt,Ye+=u*ft,Xe+=u*dt,at+=u*ct,ze+=u*it,Ze+=u*Pt,$e+=u*Ot,ke+=u*pt,ht+=u*At,Le+=u*gt,xt+=u*wt,Dt+=u*yt,Bt+=u*Qe,kt+=u*Rt,jt+=u*Tt,u=q[9],Ue+=u*lt,Ye+=u*rt,Xe+=u*ft,at+=u*dt,ze+=u*ct,Ze+=u*it,$e+=u*Pt,ke+=u*Ot,ht+=u*pt,Le+=u*At,xt+=u*gt,Dt+=u*wt,Bt+=u*yt,kt+=u*Qe,jt+=u*Rt,Qt+=u*Tt,u=q[10],Ye+=u*lt,Xe+=u*rt,at+=u*ft,ze+=u*dt,Ze+=u*ct,$e+=u*it,ke+=u*Pt,ht+=u*Ot,Le+=u*pt,xt+=u*At,Dt+=u*gt,Bt+=u*wt,kt+=u*yt,jt+=u*Qe,Qt+=u*Rt,or+=u*Tt,u=q[11],Xe+=u*lt,at+=u*rt,ze+=u*ft,Ze+=u*dt,$e+=u*ct,ke+=u*it,ht+=u*Pt,Le+=u*Ot,xt+=u*pt,Dt+=u*At,Bt+=u*gt,kt+=u*wt,jt+=u*yt,Qt+=u*Qe,or+=u*Rt,Kr+=u*Tt,u=q[12],at+=u*lt,ze+=u*rt,Ze+=u*ft,$e+=u*dt,ke+=u*ct,ht+=u*it,Le+=u*Pt,xt+=u*Ot,Dt+=u*pt,Bt+=u*At,kt+=u*gt,jt+=u*wt,Qt+=u*yt,or+=u*Qe,Kr+=u*Rt,Yt+=u*Tt,u=q[13],ze+=u*lt,Ze+=u*rt,$e+=u*ft,ke+=u*dt,ht+=u*ct,Le+=u*it,xt+=u*Pt,Dt+=u*Ot,Bt+=u*pt,kt+=u*At,jt+=u*gt,Qt+=u*wt,or+=u*yt,Kr+=u*Qe,Yt+=u*Rt,Xr+=u*Tt,u=q[14],Ze+=u*lt,$e+=u*rt,ke+=u*ft,ht+=u*dt,Le+=u*ct,xt+=u*it,Dt+=u*Pt,Bt+=u*Ot,kt+=u*pt,jt+=u*At,Qt+=u*gt,or+=u*wt,Kr+=u*yt,Yt+=u*Qe,Xr+=u*Rt,mi+=u*Tt,u=q[15],$e+=u*lt,ke+=u*rt,ht+=u*ft,Le+=u*dt,xt+=u*ct,Dt+=u*it,Bt+=u*Pt,kt+=u*Ot,jt+=u*pt,Qt+=u*At,or+=u*gt,Kr+=u*wt,Yt+=u*yt,Xr+=u*Qe,mi+=u*Rt,Ci+=u*Tt,ae+=38*ke,ye+=38*ht,_e+=38*Le,Ce+=38*xt,De+=38*Dt,Pe+=38*Bt,St+=38*kt,vt+=38*jt,ot+=38*Qt,Ue+=38*or,Ye+=38*Kr,Xe+=38*Yt,at+=38*Xr,ze+=38*mi,Ze+=38*Ci,T=1,u=ae+T+65535,T=Math.floor(u/65536),ae=u-T*65536,u=ye+T+65535,T=Math.floor(u/65536),ye=u-T*65536,u=_e+T+65535,T=Math.floor(u/65536),_e=u-T*65536,u=Ce+T+65535,T=Math.floor(u/65536),Ce=u-T*65536,u=De+T+65535,T=Math.floor(u/65536),De=u-T*65536,u=Pe+T+65535,T=Math.floor(u/65536),Pe=u-T*65536,u=St+T+65535,T=Math.floor(u/65536),St=u-T*65536,u=vt+T+65535,T=Math.floor(u/65536),vt=u-T*65536,u=ot+T+65535,T=Math.floor(u/65536),ot=u-T*65536,u=Ue+T+65535,T=Math.floor(u/65536),Ue=u-T*65536,u=Ye+T+65535,T=Math.floor(u/65536),Ye=u-T*65536,u=Xe+T+65535,T=Math.floor(u/65536),Xe=u-T*65536,u=at+T+65535,T=Math.floor(u/65536),at=u-T*65536,u=ze+T+65535,T=Math.floor(u/65536),ze=u-T*65536,u=Ze+T+65535,T=Math.floor(u/65536),Ze=u-T*65536,u=$e+T+65535,T=Math.floor(u/65536),$e=u-T*65536,ae+=T-1+37*(T-1),T=1,u=ae+T+65535,T=Math.floor(u/65536),ae=u-T*65536,u=ye+T+65535,T=Math.floor(u/65536),ye=u-T*65536,u=_e+T+65535,T=Math.floor(u/65536),_e=u-T*65536,u=Ce+T+65535,T=Math.floor(u/65536),Ce=u-T*65536,u=De+T+65535,T=Math.floor(u/65536),De=u-T*65536,u=Pe+T+65535,T=Math.floor(u/65536),Pe=u-T*65536,u=St+T+65535,T=Math.floor(u/65536),St=u-T*65536,u=vt+T+65535,T=Math.floor(u/65536),vt=u-T*65536,u=ot+T+65535,T=Math.floor(u/65536),ot=u-T*65536,u=Ue+T+65535,T=Math.floor(u/65536),Ue=u-T*65536,u=Ye+T+65535,T=Math.floor(u/65536),Ye=u-T*65536,u=Xe+T+65535,T=Math.floor(u/65536),Xe=u-T*65536,u=at+T+65535,T=Math.floor(u/65536),at=u-T*65536,u=ze+T+65535,T=Math.floor(u/65536),ze=u-T*65536,u=Ze+T+65535,T=Math.floor(u/65536),Ze=u-T*65536,u=$e+T+65535,T=Math.floor(u/65536),$e=u-T*65536,ae+=T-1+37*(T-1),z[0]=ae,z[1]=ye,z[2]=_e,z[3]=Ce,z[4]=De,z[5]=Pe,z[6]=St,z[7]=vt,z[8]=ot,z[9]=Ue,z[10]=Ye,z[11]=Xe,z[12]=at,z[13]=ze,z[14]=Ze,z[15]=$e}function R(z,q){C(z,q,q)}function X(z,q){const U=a();let u;for(u=0;u<16;u++)U[u]=q[u];for(u=253;u>=0;u--)R(U,U),u!==2&&u!==4&&C(U,U,q);for(u=0;u<16;u++)z[u]=U[u]}function oe(z,q){const U=a();let u;for(u=0;u<16;u++)U[u]=q[u];for(u=250;u>=0;u--)R(U,U),u!==1&&C(U,U,q);for(u=0;u<16;u++)z[u]=U[u]}function ge(z,q){const U=a(),u=a(),T=a(),ae=a(),ye=a(),_e=a(),Ce=a(),De=a(),Pe=a();g(U,z[1],z[0]),g(Pe,q[1],q[0]),C(U,U,Pe),w(u,z[0],z[1]),w(Pe,q[0],q[1]),C(u,u,Pe),C(T,z[3],q[3]),C(T,T,_),C(ae,z[2],q[2]),w(ae,ae,ae),g(ye,u,U),g(_e,ae,T),w(Ce,ae,T),w(De,u,U),C(z[0],ye,_e),C(z[1],De,Ce),C(z[2],Ce,_e),C(z[3],ye,De)}function Ne(z,q,U){for(let u=0;u<4;u++)J(z[u],q[u],U)}function qe(z,q){const U=a(),u=a(),T=a();X(T,q[2]),C(U,q[0],T),C(u,q[1],T),se(z,u),z[31]^=y(U)<<7}function I(z,q,U){B(z[0],d),B(z[1],v),B(z[2],v),B(z[3],d);for(let u=255;u>=0;--u){const T=U[u/8|0]>>(u&7)&1;Ne(z,q,T),ge(q,z),ge(z,z),Ne(z,q,T)}}function N(z,q){const U=[a(),a(),a(),a()];B(U[0],S),B(U[1],A),B(U[2],v),C(U[3],S,A),I(z,U,q)}function ie(z){if(z.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const q=(0,r.hash)(z);q[0]&=248,q[31]&=127,q[31]|=64;const U=new Uint8Array(32),u=[a(),a(),a(),a()];N(u,q),qe(U,u);const T=new Uint8Array(64);return T.set(z),T.set(U,32),{publicKey:U,secretKey:T}}n.generateKeyPairFromSeed=ie;function pe(z){const q=(0,t.randomBytes)(32,z),U=ie(q);return(0,s.wipe)(q),U}n.generateKeyPair=pe;function Y(z){if(z.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(z.subarray(32))}n.extractPublicKeyFromSecretKey=Y;const W=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Q(z,q){let U,u,T,ae;for(u=63;u>=32;--u){for(U=0,T=u-32,ae=u-12;T<ae;++T)q[T]+=U-16*q[u]*W[T-(u-32)],U=Math.floor((q[T]+128)/256),q[T]-=U*256;q[T]+=U,q[u]=0}for(U=0,T=0;T<32;T++)q[T]+=U-(q[31]>>4)*W[T],U=q[T]>>8,q[T]&=255;for(T=0;T<32;T++)q[T]-=U*W[T];for(u=0;u<32;u++)q[u+1]+=q[u]>>8,z[u]=q[u]&255}function Z(z){const q=new Float64Array(64);for(let U=0;U<64;U++)q[U]=z[U];for(let U=0;U<64;U++)z[U]=0;Q(z,q)}function Je(z,q){const U=new Float64Array(64),u=[a(),a(),a(),a()],T=(0,r.hash)(z.subarray(0,32));T[0]&=248,T[31]&=127,T[31]|=64;const ae=new Uint8Array(64);ae.set(T.subarray(32),32);const ye=new r.SHA512;ye.update(ae.subarray(32)),ye.update(q);const _e=ye.digest();ye.clean(),Z(_e),N(u,_e),qe(ae,u),ye.reset(),ye.update(ae.subarray(0,32)),ye.update(z.subarray(32)),ye.update(q);const Ce=ye.digest();Z(Ce);for(let De=0;De<32;De++)U[De]=_e[De];for(let De=0;De<32;De++)for(let Pe=0;Pe<32;Pe++)U[De+Pe]+=Ce[De]*T[Pe];return Q(ae.subarray(32),U),ae}n.sign=Je;function Be(z,q){const U=a(),u=a(),T=a(),ae=a(),ye=a(),_e=a(),Ce=a();return B(z[2],v),b(z[1],q),R(T,z[1]),C(ae,T,P),g(T,T,z[2]),w(ae,z[2],ae),R(ye,ae),R(_e,ye),C(Ce,_e,ye),C(U,Ce,T),C(U,U,ae),oe(U,U),C(U,U,T),C(U,U,ae),C(U,U,ae),C(z[0],U,ae),R(u,z[0]),C(u,u,ae),f(u,T)&&C(z[0],z[0],j),R(u,z[0]),C(u,u,ae),f(u,T)?-1:(y(z[0])===q[31]>>7&&g(z[0],d,z[0]),C(z[3],z[0],z[1]),0)}function kr(z,q,U){const u=new Uint8Array(32),T=[a(),a(),a(),a()],ae=[a(),a(),a(),a()];if(U.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(Be(ae,z))return!1;const ye=new r.SHA512;ye.update(U.subarray(0,32)),ye.update(z),ye.update(q);const _e=ye.digest();return Z(_e),I(T,ae,_e),N(ae,U.subarray(32)),ge(T,ae),qe(u,T),!he(U,u)}n.verify=kr;function Ie(z){let q=[a(),a(),a(),a()];if(Be(q,z))throw new Error("Ed25519: invalid public key");let U=a(),u=a(),T=q[1];w(U,v,T),g(u,v,T),X(u,u),C(U,U,u);let ae=new Uint8Array(32);return se(ae,U),ae}n.convertPublicKeyToX25519=Ie;function It(z){const q=(0,r.hash)(z.subarray(0,32));q[0]&=248,q[31]&=127,q[31]|=64;const U=new Uint8Array(q.subarray(0,32));return(0,s.wipe)(q),U}n.convertSecretKeyToX25519=It})(Jc);const Bw="EdDSA",kw="JWT",Wf=".",Gf="base64url",Kw="utf8",Vw="utf8",Ww=":",Gw="did",Jw="key",Al="base58btc",Qw="z",Yw="K36",Xw=32;function To(n){return sr(gr(Ji(n),Kw),Gf)}function Jf(n){const t=gr(Yw,Al),r=Qw+sr(Ac([t,n]),Al);return[Gw,Jw,r].join(Ww)}function Zw(n){return sr(n,Gf)}function eb(n){return gr([To(n.header),To(n.payload)].join(Wf),Vw)}function tb(n){return[To(n.header),To(n.payload),Zw(n.signature)].join(Wf)}function Rl(n=Fo.randomBytes(Xw)){return Jc.generateKeyPairFromSeed(n)}async function rb(n,t,r,s,a=ue.fromMiliseconds(Date.now())){const h={alg:Bw,typ:kw},d=Jf(s.publicKey),v=a+r,P={iss:d,sub:n,aud:t,iat:a,exp:v},_=eb({header:h,payload:P}),S=Jc.sign(s.secretKey,_);return tb({header:h,payload:P,signature:S})}var as={};(function(n){const t=kc,r=Kc,s=Hc,a=Bc,h=f=>f==null,d=Symbol("encodeFragmentIdentifier");function v(f){switch(f.arrayFormat){case"index":return y=>(b,w)=>{const g=b.length;return w===void 0||f.skipNull&&w===null||f.skipEmptyString&&w===""?b:w===null?[...b,[S(y,f),"[",g,"]"].join("")]:[...b,[S(y,f),"[",S(g,f),"]=",S(w,f)].join("")]};case"bracket":return y=>(b,w)=>w===void 0||f.skipNull&&w===null||f.skipEmptyString&&w===""?b:w===null?[...b,[S(y,f),"[]"].join("")]:[...b,[S(y,f),"[]=",S(w,f)].join("")];case"colon-list-separator":return y=>(b,w)=>w===void 0||f.skipNull&&w===null||f.skipEmptyString&&w===""?b:w===null?[...b,[S(y,f),":list="].join("")]:[...b,[S(y,f),":list=",S(w,f)].join("")];case"comma":case"separator":case"bracket-separator":{const y=f.arrayFormat==="bracket-separator"?"[]=":"=";return b=>(w,g)=>g===void 0||f.skipNull&&g===null||f.skipEmptyString&&g===""?w:(g=g===null?"":g,w.length===0?[[S(b,f),y,S(g,f)].join("")]:[[w,S(g,f)].join(f.arrayFormatSeparator)])}default:return y=>(b,w)=>w===void 0||f.skipNull&&w===null||f.skipEmptyString&&w===""?b:w===null?[...b,S(y,f)]:[...b,[S(y,f),"=",S(w,f)].join("")]}}function P(f){let y;switch(f.arrayFormat){case"index":return(b,w,g)=>{if(y=/\[(\d*)\]$/.exec(b),b=b.replace(/\[\d*\]$/,""),!y){g[b]=w;return}g[b]===void 0&&(g[b]={}),g[b][y[1]]=w};case"bracket":return(b,w,g)=>{if(y=/(\[\])$/.exec(b),b=b.replace(/\[\]$/,""),!y){g[b]=w;return}if(g[b]===void 0){g[b]=[w];return}g[b]=[].concat(g[b],w)};case"colon-list-separator":return(b,w,g)=>{if(y=/(:list)$/.exec(b),b=b.replace(/:list$/,""),!y){g[b]=w;return}if(g[b]===void 0){g[b]=[w];return}g[b]=[].concat(g[b],w)};case"comma":case"separator":return(b,w,g)=>{const C=typeof w=="string"&&w.includes(f.arrayFormatSeparator),R=typeof w=="string"&&!C&&A(w,f).includes(f.arrayFormatSeparator);w=R?A(w,f):w;const X=C||R?w.split(f.arrayFormatSeparator).map(oe=>A(oe,f)):w===null?w:A(w,f);g[b]=X};case"bracket-separator":return(b,w,g)=>{const C=/(\[\])$/.test(b);if(b=b.replace(/\[\]$/,""),!C){g[b]=w&&A(w,f);return}const R=w===null?[]:w.split(f.arrayFormatSeparator).map(X=>A(X,f));if(g[b]===void 0){g[b]=R;return}g[b]=[].concat(g[b],R)};default:return(b,w,g)=>{if(g[b]===void 0){g[b]=w;return}g[b]=[].concat(g[b],w)}}}function _(f){if(typeof f!="string"||f.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function S(f,y){return y.encode?y.strict?t(f):encodeURIComponent(f):f}function A(f,y){return y.decode?r(f):f}function j(f){return Array.isArray(f)?f.sort():typeof f=="object"?j(Object.keys(f)).sort((y,b)=>Number(y)-Number(b)).map(y=>f[y]):f}function B(f){const y=f.indexOf("#");return y!==-1&&(f=f.slice(0,y)),f}function L(f){let y="";const b=f.indexOf("#");return b!==-1&&(y=f.slice(b)),y}function J(f){f=B(f);const y=f.indexOf("?");return y===-1?"":f.slice(y+1)}function se(f,y){return y.parseNumbers&&!Number.isNaN(Number(f))&&typeof f=="string"&&f.trim()!==""?f=Number(f):y.parseBooleans&&f!==null&&(f.toLowerCase()==="true"||f.toLowerCase()==="false")&&(f=f.toLowerCase()==="true"),f}function he(f,y){y=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},y),_(y.arrayFormatSeparator);const b=P(y),w=Object.create(null);if(typeof f!="string"||(f=f.trim().replace(/^[?#&]/,""),!f))return w;for(const g of f.split("&")){if(g==="")continue;let[C,R]=s(y.decode?g.replace(/\+/g," "):g,"=");R=R===void 0?null:["comma","separator","bracket-separator"].includes(y.arrayFormat)?R:A(R,y),b(A(C,y),R,w)}for(const g of Object.keys(w)){const C=w[g];if(typeof C=="object"&&C!==null)for(const R of Object.keys(C))C[R]=se(C[R],y);else w[g]=se(C,y)}return y.sort===!1?w:(y.sort===!0?Object.keys(w).sort():Object.keys(w).sort(y.sort)).reduce((g,C)=>{const R=w[C];return R&&typeof R=="object"&&!Array.isArray(R)?g[C]=j(R):g[C]=R,g},Object.create(null))}n.extract=J,n.parse=he,n.stringify=(f,y)=>{if(!f)return"";y=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},y),_(y.arrayFormatSeparator);const b=R=>y.skipNull&&h(f[R])||y.skipEmptyString&&f[R]==="",w=v(y),g={};for(const R of Object.keys(f))b(R)||(g[R]=f[R]);const C=Object.keys(g);return y.sort!==!1&&C.sort(y.sort),C.map(R=>{const X=f[R];return X===void 0?"":X===null?S(R,y):Array.isArray(X)?X.length===0&&y.arrayFormat==="bracket-separator"?S(R,y)+"[]":X.reduce(w(R),[]).join("&"):S(R,y)+"="+S(X,y)}).filter(R=>R.length>0).join("&")},n.parseUrl=(f,y)=>{y=Object.assign({decode:!0},y);const[b,w]=s(f,"#");return Object.assign({url:b.split("?")[0]||"",query:he(J(f),y)},y&&y.parseFragmentIdentifier&&w?{fragmentIdentifier:A(w,y)}:{})},n.stringifyUrl=(f,y)=>{y=Object.assign({encode:!0,strict:!0,[d]:!0},y);const b=B(f.url).split("?")[0]||"",w=n.extract(f.url),g=n.parse(w,{sort:!1}),C=Object.assign(g,f.query);let R=n.stringify(C,y);R&&(R=`?${R}`);let X=L(f.url);return f.fragmentIdentifier&&(X=`#${y[d]?S(f.fragmentIdentifier,y):f.fragmentIdentifier}`),`${b}${R}${X}`},n.pick=(f,y,b)=>{b=Object.assign({parseFragmentIdentifier:!0,[d]:!1},b);const{url:w,query:g,fragmentIdentifier:C}=n.parseUrl(f,b);return n.stringifyUrl({url:w,query:a(g,y),fragmentIdentifier:C},b)},n.exclude=(f,y,b)=>{const w=Array.isArray(y)?g=>!y.includes(g):(g,C)=>!y(g,C);return n.pick(f,w,b)}})(as);function Qf(n,t){return n.includes(":")?[n]:t.chains||[]}const Yf="base10",nr="base16",Nc="base64pad",Qc="utf8",Xf=0,Xi=1,ib=0,Tl=1,Cc=12,Yc=32;function nb(){const n=Ff.generateKeyPair();return{privateKey:sr(n.secretKey,nr),publicKey:sr(n.publicKey,nr)}}function $c(){const n=Fo.randomBytes(Yc);return sr(n,nr)}function sb(n,t){const r=Ff.sharedKey(gr(n,nr),gr(t,nr),!0),s=new S1(Vc.SHA256,r).expand(Yc);return sr(s,nr)}function ob(n){const t=Vc.hash(gr(n,nr));return sr(t,nr)}function In(n){const t=Vc.hash(gr(n,Qc));return sr(t,nr)}function ab(n){return gr(`${n}`,Yf)}function ls(n){return Number(sr(n,Yf))}function cb(n){const t=ab(typeof n.type<"u"?n.type:Xf);if(ls(t)===Xi&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof n.senderPublicKey<"u"?gr(n.senderPublicKey,nr):void 0,s=typeof n.iv<"u"?gr(n.iv,nr):Fo.randomBytes(Cc),a=new Uf.ChaCha20Poly1305(gr(n.symKey,nr)).seal(s,gr(n.message,Qc));return hb({type:t,sealed:a,iv:s,senderPublicKey:r})}function ub(n){const t=new Uf.ChaCha20Poly1305(gr(n.symKey,nr)),{sealed:r,iv:s}=No(n.encoded),a=t.open(s,r);if(a===null)throw new Error("Failed to decrypt");return sr(a,Qc)}function hb(n){if(ls(n.type)===Xi){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return sr(Ac([n.type,n.senderPublicKey,n.iv,n.sealed]),Nc)}return sr(Ac([n.type,n.iv,n.sealed]),Nc)}function No(n){const t=gr(n,Nc),r=t.slice(ib,Tl),s=Tl;if(ls(r)===Xi){const v=s+Yc,P=v+Cc,_=t.slice(s,v),S=t.slice(v,P),A=t.slice(P);return{type:r,sealed:A,iv:S,senderPublicKey:_}}const a=s+Cc,h=t.slice(s,a),d=t.slice(a);return{type:r,sealed:d,iv:h}}function lb(n,t){const r=No(n);return Zf({type:ls(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?sr(r.senderPublicKey,nr):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function Zf(n){const t=(n==null?void 0:n.type)||Xf;if(t===Xi){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function Nl(n){return n.type===Xi&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var fb=Object.defineProperty,Cl=Object.getOwnPropertySymbols,db=Object.prototype.hasOwnProperty,pb=Object.prototype.propertyIsEnumerable,$l=(n,t,r)=>t in n?fb(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Dl=(n,t)=>{for(var r in t||(t={}))db.call(t,r)&&$l(n,r,t[r]);if(Cl)for(var r of Cl(t))pb.call(t,r)&&$l(n,r,t[r]);return n};const gb="ReactNative",Er={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},yb="js";function Xc(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function On(){return!x1()&&!!Df()&&navigator.product===gb}function An(){return!Xc()&&!!Df()}function fs(){return On()?Er.reactNative:Xc()?Er.node:An()?Er.browser:Er.unknown}function mb(){var n;try{return On()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(n=global.Application)==null?void 0:n.applicationId:void 0}catch{return}}function vb(n,t){let r=as.parse(n);return r=Dl(Dl({},r),t),n=as.stringify(r),n}function wb(){return I1()||{name:"",description:"",url:"",icons:[""]}}function bb(){if(fs()===Er.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:s}=global.Platform;return[r,s].join("-")}const n=U1();if(n===null)return"unknown";const t=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[t,n.name,n.version].join("-"):[t,n.version].join("-")}function _b(){var n;const t=fs();return t===Er.browser?[t,((n=P1())==null?void 0:n.host)||"unknown"].join(":"):t}function Eb(n,t,r){const s=bb(),a=_b();return[[n,t].join("-"),[yb,r].join("-"),s,a].join("/")}function Ib({protocol:n,version:t,relayUrl:r,sdkVersion:s,auth:a,projectId:h,useOnCloseEvent:d,bundleId:v}){const P=r.split("?"),_=Eb(n,t,s),S={auth:a,ua:_,projectId:h,useOnCloseEvent:d||void 0,origin:v||void 0},A=vb(P[1]||"",S);return P[0]+"?"+A}function Gi(n,t){return n.filter(r=>t.includes(r)).length===n.length}function ed(n){return Object.fromEntries(n.entries())}function td(n){return new Map(Object.entries(n))}function _n(n=ue.FIVE_MINUTES,t){const r=ue.toMiliseconds(n||ue.FIVE_MINUTES);let s,a,h;return{resolve:d=>{h&&s&&(clearTimeout(h),s(d))},reject:d=>{h&&a&&(clearTimeout(h),a(d))},done:()=>new Promise((d,v)=>{h=setTimeout(()=>{v(new Error(t))},r),s=d,a=v})}}function cs(n,t,r){return new Promise(async(s,a)=>{const h=setTimeout(()=>a(new Error(r)),t);try{const d=await n;s(d)}catch(d){a(d)}clearTimeout(h)})}function rd(n,t){if(typeof t=="string"&&t.startsWith(`${n}:`))return t;if(n.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(n.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${n}`)}function Sb(n){return rd("topic",n)}function xb(n){return rd("id",n)}function id(n){const[t,r]=n.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function zr(n,t){return ue.fromMiliseconds((t||Date.now())+ue.toMiliseconds(n))}function Ai(n){return Date.now()>=ue.toMiliseconds(n)}function $t(n,t){return`${n}${t?`:${t}`:""}`}async function Pb({id:n,topic:t,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let a=s==null?void 0:s.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const h=`${a}/wc?requestId=${n}&sessionTopic=${t}`,d=fs();d===Er.browser?h.startsWith("https://")?window.open(h,"_blank","noreferrer noopener"):window.open(h,"_self","noreferrer noopener"):d===Er.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(h)}catch(s){console.error(s)}}async function Ob(n,t){try{return await n.getItem(t)||(An()?localStorage.getItem(t):void 0)}catch(r){console.error(r)}}const Ab="irn";function Dc(n){return(n==null?void 0:n.relay)||{protocol:Ab}}function Ao(n){const t=z1[n];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${n}`);return t}var Rb=Object.defineProperty,Fl=Object.getOwnPropertySymbols,Tb=Object.prototype.hasOwnProperty,Nb=Object.prototype.propertyIsEnumerable,Ul=(n,t,r)=>t in n?Rb(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Cb=(n,t)=>{for(var r in t||(t={}))Tb.call(t,r)&&Ul(n,r,t[r]);if(Fl)for(var r of Fl(t))Nb.call(t,r)&&Ul(n,r,t[r]);return n};function $b(n,t="-"){const r={},s="relay"+t;return Object.keys(n).forEach(a=>{if(a.startsWith(s)){const h=a.replace(s,""),d=n[a];r[h]=d}}),r}function jl(n){n=n.includes("wc://")?n.replace("wc://",""):n,n=n.includes("wc:")?n.replace("wc:",""):n;const t=n.indexOf(":"),r=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,t),a=n.substring(t+1,r).split("@"),h=typeof r<"u"?n.substring(r):"",d=as.parse(h);return{protocol:s,topic:Db(a[0]),version:parseInt(a[1],10),symKey:d.symKey,relay:$b(d)}}function Db(n){return n.startsWith("//")?n.substring(2):n}function Fb(n,t="-"){const r="relay",s={};return Object.keys(n).forEach(a=>{const h=r+t+a;n[a]&&(s[h]=n[a])}),s}function Ub(n){return`${n.protocol}:${n.topic}@${n.version}?`+as.stringify(Cb({symKey:n.symKey},Fb(n.relay)))}function Rn(n){const t=[];return n.forEach(r=>{const[s,a]=r.split(":");t.push(`${s}:${a}`)}),t}function jb(n){const t=[];return Object.values(n).forEach(r=>{t.push(...Rn(r.accounts))}),t}function Lb(n,t){const r=[];return Object.values(n).forEach(s=>{Rn(s.accounts).includes(t)&&r.push(...s.methods)}),r}function Mb(n,t){const r=[];return Object.values(n).forEach(s=>{Rn(s.accounts).includes(t)&&r.push(...s.events)}),r}function qb(n,t){const r=Ro(n,t);if(r)throw new Error(r.message);const s={};for(const[a,h]of Object.entries(n))s[a]={methods:h.methods,events:h.events,chains:h.accounts.map(d=>`${d.split(":")[0]}:${d.split(":")[1]}`)};return s}const zb={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Hb={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ee(n,t){const{message:r,code:s}=Hb[n];return{message:t?`${r} ${t}`:r,code:s}}function zt(n,t){const{message:r,code:s}=zb[n];return{message:t?`${r} ${t}`:r,code:s}}function ds(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function ss(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function ir(n){return typeof n>"u"}function Ht(n,t){return t&&ir(n)?!0:typeof n=="string"&&!!n.trim().length}function Zc(n,t){return t&&ir(n)?!0:typeof n=="number"&&!isNaN(n)}function Bb(n,t){const{requiredNamespaces:r}=t,s=Object.keys(n.namespaces),a=Object.keys(r);let h=!0;return Gi(a,s)?(s.forEach(d=>{const{accounts:v,methods:P,events:_}=n.namespaces[d],S=Rn(v),A=r[d];(!Gi(Qf(d,A),S)||!Gi(A.methods,P)||!Gi(A.events,_))&&(h=!1)}),h):!1}function Co(n){return Ht(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function kb(n){if(Ht(n,!1)&&n.includes(":")){const t=n.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&Co(r)}}return!1}function Kb(n){if(Ht(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function Vb(n){var t;return(t=n==null?void 0:n.proposer)==null?void 0:t.publicKey}function Wb(n){return n==null?void 0:n.topic}function Gb(n,t){let r=null;return Ht(n==null?void 0:n.publicKey,!1)||(r=ee("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function Ll(n){let t=!0;return ds(n)?n.length&&(t=n.every(r=>Ht(r,!1))):t=!1,t}function Jb(n,t,r){let s=null;return ds(t)&&t.length?t.forEach(a=>{s||Co(a)||(s=zt("UNSUPPORTED_CHAINS",`${r}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):Co(n)||(s=zt("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function Qb(n,t,r){let s=null;return Object.entries(n).forEach(([a,h])=>{if(s)return;const d=Jb(a,Qf(a,h),`${t} ${r}`);d&&(s=d)}),s}function Yb(n,t){let r=null;return ds(n)?n.forEach(s=>{r||kb(s)||(r=zt("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=zt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Xb(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=Yb(s==null?void 0:s.accounts,`${t} namespace`);a&&(r=a)}),r}function Zb(n,t){let r=null;return Ll(n==null?void 0:n.methods)?Ll(n==null?void 0:n.events)||(r=zt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=zt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function nd(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=Zb(s,`${t}, namespace`);a&&(r=a)}),r}function e_(n,t,r){let s=null;if(n&&ss(n)){const a=nd(n,t);a&&(s=a);const h=Qb(n,t,r);h&&(s=h)}else s=ee("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function Ro(n,t){let r=null;if(n&&ss(n)){const s=nd(n,t);s&&(r=s);const a=Xb(n,t);a&&(r=a)}else r=ee("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function sd(n){return Ht(n.protocol,!0)}function t_(n,t){let r=!1;return t&&!n?r=!0:n&&ds(n)&&n.length&&n.forEach(s=>{r=sd(s)}),r}function r_(n){return typeof n=="number"}function pr(n){return typeof n<"u"&&typeof n!==null}function i_(n){return!(!n||typeof n!="object"||!n.code||!Zc(n.code,!1)||!n.message||!Ht(n.message,!1))}function n_(n){return!(ir(n)||!Ht(n.method,!1))}function s_(n){return!(ir(n)||ir(n.result)&&ir(n.error)||!Zc(n.id,!1)||!Ht(n.jsonrpc,!1))}function o_(n){return!(ir(n)||!Ht(n.name,!1))}function Ml(n,t){return!(!Co(t)||!jb(n).includes(t))}function a_(n,t,r){return Ht(r,!1)?Lb(n,t).includes(r):!1}function c_(n,t,r){return Ht(r,!1)?Mb(n,t).includes(r):!1}function ql(n,t,r){let s=null;const a=u_(n),h=h_(t),d=Object.keys(a),v=Object.keys(h),P=zl(Object.keys(n)),_=zl(Object.keys(t)),S=P.filter(A=>!_.includes(A));return S.length&&(s=ee("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${S.toString()}
      Received: ${Object.keys(t).toString()}`)),Gi(d,v)||(s=ee("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${d.toString()}
      Approved: ${v.toString()}`)),Object.keys(t).forEach(A=>{if(!A.includes(":")||s)return;const j=Rn(t[A].accounts);j.includes(A)||(s=ee("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${A}
        Required: ${A}
        Approved: ${j.toString()}`))}),d.forEach(A=>{s||(Gi(a[A].methods,h[A].methods)?Gi(a[A].events,h[A].events)||(s=ee("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${A}`)):s=ee("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${A}`))}),s}function u_(n){const t={};return Object.keys(n).forEach(r=>{var s;r.includes(":")?t[r]=n[r]:(s=n[r].chains)==null||s.forEach(a=>{t[a]={methods:n[r].methods,events:n[r].events}})}),t}function zl(n){return[...new Set(n.map(t=>t.includes(":")?t.split(":")[0]:t))]}function h_(n){const t={};return Object.keys(n).forEach(r=>{if(r.includes(":"))t[r]=n[r];else{const s=Rn(n[r].accounts);s==null||s.forEach(a=>{t[a]={accounts:n[r].accounts.filter(h=>h.includes(`${a}:`)),methods:n[r].methods,events:n[r].events}})}}),t}function l_(n,t){return Zc(n,!1)&&n<=t.max&&n>=t.min}function Hl(){const n=fs();return new Promise(t=>{switch(n){case Er.browser:t(f_());break;case Er.reactNative:t(d_());break;case Er.node:t(p_());break;default:t(!0)}})}function f_(){return An()&&(navigator==null?void 0:navigator.onLine)}async function d_(){if(On()&&typeof global<"u"&&global!=null&&global.NetInfo){const n=await(global==null?void 0:global.NetInfo.fetch());return n==null?void 0:n.isConnected}return!0}function p_(){return!0}function g_(n){switch(fs()){case Er.browser:y_(n);break;case Er.reactNative:m_(n);break}}function y_(n){!On()&&An()&&(window.addEventListener("online",()=>n(!0)),window.addEventListener("offline",()=>n(!1)))}function m_(n){On()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(t=>n(t==null?void 0:t.isConnected)))}const mc={};let Eo=class{static get(t){return mc[t]}static set(t,r){mc[t]=r}static delete(t){delete mc[t]}};const v_="PARSE_ERROR",w_="INVALID_REQUEST",b_="METHOD_NOT_FOUND",__="INVALID_PARAMS",od="INTERNAL_ERROR",eu="SERVER_ERROR",E_=[-32700,-32600,-32601,-32602,-32603],os={[v_]:{code:-32700,message:"Parse error"},[w_]:{code:-32600,message:"Invalid Request"},[b_]:{code:-32601,message:"Method not found"},[__]:{code:-32602,message:"Invalid params"},[od]:{code:-32603,message:"Internal error"},[eu]:{code:-32e3,message:"Server error"}},ad=eu;function I_(n){return E_.includes(n)}function Bl(n){return Object.keys(os).includes(n)?os[n]:os[ad]}function S_(n){const t=Object.values(os).find(r=>r.code===n);return t||os[ad]}function cd(n,t,r){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):n}var ud={},hi={},kl;function x_(){if(kl)return hi;kl=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.isBrowserCryptoAvailable=hi.getSubtleCrypto=hi.getBrowerCrypto=void 0;function n(){return(Br===null||Br===void 0?void 0:Br.crypto)||(Br===null||Br===void 0?void 0:Br.msCrypto)||{}}hi.getBrowerCrypto=n;function t(){const s=n();return s.subtle||s.webkitSubtle}hi.getSubtleCrypto=t;function r(){return!!n()&&!!t()}return hi.isBrowserCryptoAvailable=r,hi}var li={},Kl;function P_(){if(Kl)return li;Kl=1,Object.defineProperty(li,"__esModule",{value:!0}),li.isBrowser=li.isNode=li.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}li.isReactNative=n;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}li.isNode=t;function r(){return!n()&&!t()}return li.isBrowser=r,li}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=xn;t.__exportStar(x_(),n),t.__exportStar(P_(),n)})(ud);function tu(n=3){const t=Date.now()*Math.pow(10,n),r=Math.floor(Math.random()*Math.pow(10,n));return t+r}function hd(n=6){return BigInt(tu(n))}function Sn(n,t,r){return{id:r||tu(),jsonrpc:"2.0",method:n,params:t}}function ru(n,t){return{id:n,jsonrpc:"2.0",result:t}}function Uo(n,t,r){return{id:n,jsonrpc:"2.0",error:O_(t,r)}}function O_(n,t){return typeof n>"u"?Bl(od):(typeof n=="string"&&(n=Object.assign(Object.assign({},Bl(eu)),{message:n})),typeof t<"u"&&(n.data=t),I_(n.code)&&(n=S_(n.code)),n)}class A_{}class R_ extends A_{constructor(){super()}}class T_ extends R_{constructor(t){super()}}const N_="^https?:",C_="^wss?:";function $_(n){const t=n.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function ld(n,t){const r=$_(n);return typeof r>"u"?!1:new RegExp(t).test(r)}function Vl(n){return ld(n,N_)}function Wl(n){return ld(n,C_)}function D_(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function fd(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function iu(n){return fd(n)&&"method"in n}function jo(n){return fd(n)&&(pi(n)||Hr(n))}function pi(n){return"result"in n}function Hr(n){return"error"in n}class gi extends T_{constructor(t){super(t),this.events=new $r.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Sn(t.method,t.params||[],t.id||hd().toString()),r)}async requestStrict(t,r){return new Promise(async(s,a)=>{if(!this.connection.connected)try{await this.open()}catch(h){a(h)}this.events.on(`${t.id}`,h=>{Hr(h)?a(h.error):s(h.result)});try{await this.connection.send(t,r)}catch(h){a(h)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),jo(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const F_=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),U_=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Gl=n=>n.split("?")[0],Jl=10,j_=F_();let L_=class{constructor(t){if(this.url=t,this.events=new $r.EventEmitter,this.registering=!1,!Wl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Ji(t))}catch(r){this.onError(t.id,r)}}register(t=this.url){if(!Wl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),a(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,s)=>{const a=new URLSearchParams(t).get("origin"),h=ud.isReactNative()?{headers:{origin:a}}:{rejectUnauthorized:!D_(t)},d=new j_(t,[],h);U_()?d.onerror=v=>{const P=v;s(this.emitError(P.error))}:d.on("error",v=>{s(this.emitError(v))}),d.onopen=()=>{this.onOpen(d),r(d)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?hs(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),h=Uo(t,a);this.events.emit("payload",h)}parseError(t,r=this.url){return cd(t,Gl(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Jl&&this.events.setMaxListeners(Jl)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${Gl(this.url)}`));return this.events.emit("register_error",r),r}};var $o={exports:{}};$o.exports;(function(n,t){var r=200,s="__lodash_hash_undefined__",a=1,h=2,d=9007199254740991,v="[object Arguments]",P="[object Array]",_="[object AsyncFunction]",S="[object Boolean]",A="[object Date]",j="[object Error]",B="[object Function]",L="[object GeneratorFunction]",J="[object Map]",se="[object Number]",he="[object Null]",f="[object Object]",y="[object Promise]",b="[object Proxy]",w="[object RegExp]",g="[object Set]",C="[object String]",R="[object Symbol]",X="[object Undefined]",oe="[object WeakMap]",ge="[object ArrayBuffer]",Ne="[object DataView]",qe="[object Float32Array]",I="[object Float64Array]",N="[object Int8Array]",ie="[object Int16Array]",pe="[object Int32Array]",Y="[object Uint8Array]",W="[object Uint8ClampedArray]",Q="[object Uint16Array]",Z="[object Uint32Array]",Je=/[\\^$.*+?()[\]{}|]/g,Be=/^\[object .+?Constructor\]$/,kr=/^(?:0|[1-9]\d*)$/,Ie={};Ie[qe]=Ie[I]=Ie[N]=Ie[ie]=Ie[pe]=Ie[Y]=Ie[W]=Ie[Q]=Ie[Z]=!0,Ie[v]=Ie[P]=Ie[ge]=Ie[S]=Ie[Ne]=Ie[A]=Ie[j]=Ie[B]=Ie[J]=Ie[se]=Ie[f]=Ie[w]=Ie[g]=Ie[C]=Ie[oe]=!1;var It=typeof Br=="object"&&Br&&Br.Object===Object&&Br,z=typeof self=="object"&&self&&self.Object===Object&&self,q=It||z||Function("return this")(),U=t&&!t.nodeType&&t,u=U&&!0&&n&&!n.nodeType&&n,T=u&&u.exports===U,ae=T&&It.process,ye=function(){try{return ae&&ae.binding&&ae.binding("util")}catch{}}(),_e=ye&&ye.isTypedArray;function Ce(E,$){for(var V=-1,re=E==null?0:E.length,Ve=0,ve=[];++V<re;){var et=E[V];$(et,V,E)&&(ve[Ve++]=et)}return ve}function De(E,$){for(var V=-1,re=$.length,Ve=E.length;++V<re;)E[Ve+V]=$[V];return E}function Pe(E,$){for(var V=-1,re=E==null?0:E.length;++V<re;)if($(E[V],V,E))return!0;return!1}function St(E,$){for(var V=-1,re=Array(E);++V<E;)re[V]=$(V);return re}function vt(E){return function($){return E($)}}function ot(E,$){return E.has($)}function Ue(E,$){return E==null?void 0:E[$]}function Ye(E){var $=-1,V=Array(E.size);return E.forEach(function(re,Ve){V[++$]=[Ve,re]}),V}function Xe(E,$){return function(V){return E($(V))}}function at(E){var $=-1,V=Array(E.size);return E.forEach(function(re){V[++$]=re}),V}var ze=Array.prototype,Ze=Function.prototype,$e=Object.prototype,ke=q["__core-js_shared__"],ht=Ze.toString,Le=$e.hasOwnProperty,xt=function(){var E=/[^.]+$/.exec(ke&&ke.keys&&ke.keys.IE_PROTO||"");return E?"Symbol(src)_1."+E:""}(),Dt=$e.toString,Bt=RegExp("^"+ht.call(Le).replace(Je,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),kt=T?q.Buffer:void 0,jt=q.Symbol,Qt=q.Uint8Array,or=$e.propertyIsEnumerable,Kr=ze.splice,Yt=jt?jt.toStringTag:void 0,Xr=Object.getOwnPropertySymbols,mi=kt?kt.isBuffer:void 0,Ci=Xe(Object.keys,Object),lt=yr(q,"DataView"),rt=yr(q,"Map"),ft=yr(q,"Promise"),dt=yr(q,"Set"),ct=yr(q,"WeakMap"),it=yr(Object,"create"),Pt=ei(lt),Ot=ei(rt),pt=ei(ft),At=ei(dt),gt=ei(ct),wt=jt?jt.prototype:void 0,yt=wt?wt.valueOf:void 0;function Qe(E){var $=-1,V=E==null?0:E.length;for(this.clear();++$<V;){var re=E[$];this.set(re[0],re[1])}}function Rt(){this.__data__=it?it(null):{},this.size=0}function Tt(E){var $=this.has(E)&&delete this.__data__[E];return this.size-=$?1:0,$}function qo(E){var $=this.__data__;if(it){var V=$[E];return V===s?void 0:V}return Le.call($,E)?$[E]:void 0}function zo(E){var $=this.__data__;return it?$[E]!==void 0:Le.call($,E)}function Ho(E,$){var V=this.__data__;return this.size+=this.has(E)?0:1,V[E]=it&&$===void 0?s:$,this}Qe.prototype.clear=Rt,Qe.prototype.delete=Tt,Qe.prototype.get=qo,Qe.prototype.has=zo,Qe.prototype.set=Ho;function Ir(E){var $=-1,V=E==null?0:E.length;for(this.clear();++$<V;){var re=E[$];this.set(re[0],re[1])}}function Bo(){this.__data__=[],this.size=0}function ko(E){var $=this.__data__,V=$i($,E);if(V<0)return!1;var re=$.length-1;return V==re?$.pop():Kr.call($,V,1),--this.size,!0}function Ko(E){var $=this.__data__,V=$i($,E);return V<0?void 0:$[V][1]}function Vo(E){return $i(this.__data__,E)>-1}function Wo(E,$){var V=this.__data__,re=$i(V,E);return re<0?(++this.size,V.push([E,$])):V[re][1]=$,this}Ir.prototype.clear=Bo,Ir.prototype.delete=ko,Ir.prototype.get=Ko,Ir.prototype.has=Vo,Ir.prototype.set=Wo;function Zr(E){var $=-1,V=E==null?0:E.length;for(this.clear();++$<V;){var re=E[$];this.set(re[0],re[1])}}function en(){this.size=0,this.__data__={hash:new Qe,map:new(rt||Ir),string:new Qe}}function Go(E){var $=vi(this,E).delete(E);return this.size-=$?1:0,$}function tn(E){return vi(this,E).get(E)}function Jo(E){return vi(this,E).has(E)}function Qo(E,$){var V=vi(this,E),re=V.size;return V.set(E,$),this.size+=V.size==re?0:1,this}Zr.prototype.clear=en,Zr.prototype.delete=Go,Zr.prototype.get=tn,Zr.prototype.has=Jo,Zr.prototype.set=Qo;function rn(E){var $=-1,V=E==null?0:E.length;for(this.__data__=new Zr;++$<V;)this.add(E[$])}function gs(E){return this.__data__.set(E,s),this}function ys(E){return this.__data__.has(E)}rn.prototype.add=rn.prototype.push=gs,rn.prototype.has=ys;function Dr(E){var $=this.__data__=new Ir(E);this.size=$.size}function Yo(){this.__data__=new Ir,this.size=0}function Xo(E){var $=this.__data__,V=$.delete(E);return this.size=$.size,V}function Zo(E){return this.__data__.get(E)}function ea(E){return this.__data__.has(E)}function ms(E,$){var V=this.__data__;if(V instanceof Ir){var re=V.__data__;if(!rt||re.length<r-1)return re.push([E,$]),this.size=++V.size,this;V=this.__data__=new Zr(re)}return V.set(E,$),this.size=V.size,this}Dr.prototype.clear=Yo,Dr.prototype.delete=Xo,Dr.prototype.get=Zo,Dr.prototype.has=ea,Dr.prototype.set=ms;function vs(E,$){var V=on(E),re=!V&&Ts(E),Ve=!V&&!re&&Cn(E),ve=!V&&!re&&!Ve&&$s(E),et=V||re||Ve||ve,Nt=et?St(E.length,String):[],Ae=Nt.length;for(var We in E)($||Le.call(E,We))&&!(et&&(We=="length"||Ve&&(We=="offset"||We=="parent")||ve&&(We=="buffer"||We=="byteLength"||We=="byteOffset")||xs(We,Ae)))&&Nt.push(We);return Nt}function $i(E,$){for(var V=E.length;V--;)if(Rs(E[V][0],$))return V;return-1}function Tn(E,$,V){var re=$(E);return on(E)?re:De(re,V(E))}function Di(E){return E==null?E===void 0?X:he:Yt&&Yt in Object(E)?Is(E):ia(E)}function Nn(E){return Ui(E)&&Di(E)==v}function Fi(E,$,V,re,Ve){return E===$?!0:E==null||$==null||!Ui(E)&&!Ui($)?E!==E&&$!==$:ws(E,$,V,re,Fi,Ve)}function ws(E,$,V,re,Ve,ve){var et=on(E),Nt=on($),Ae=et?P:Vr(E),We=Nt?P:Vr($);Ae=Ae==v?f:Ae,We=We==v?f:We;var bt=Ae==f,ar=We==f,Ct=Ae==We;if(Ct&&Cn(E)){if(!Cn($))return!1;et=!0,bt=!1}if(Ct&&!bt)return ve||(ve=new Dr),et||$s(E)?nn(E,$,V,re,Ve,ve):ra(E,$,Ae,V,re,Ve,ve);if(!(V&a)){var tt=bt&&Le.call(E,"__wrapped__"),Xt=ar&&Le.call($,"__wrapped__");if(tt||Xt){var Fr=tt?E.value():E,Sr=Xt?$.value():$;return ve||(ve=new Dr),Ve(Fr,Sr,V,re,ve)}}return Ct?(ve||(ve=new Dr),Es(E,$,V,re,Ve,ve)):!1}function ta(E){if(!Cs(E)||Os(E))return!1;var $=an(E)?Bt:Be;return $.test(ei(E))}function bs(E){return Ui(E)&&Ns(E.length)&&!!Ie[Di(E)]}function _s(E){if(!As(E))return Ci(E);var $=[];for(var V in Object(E))Le.call(E,V)&&V!="constructor"&&$.push(V);return $}function nn(E,$,V,re,Ve,ve){var et=V&a,Nt=E.length,Ae=$.length;if(Nt!=Ae&&!(et&&Ae>Nt))return!1;var We=ve.get(E);if(We&&ve.get($))return We==$;var bt=-1,ar=!0,Ct=V&h?new rn:void 0;for(ve.set(E,$),ve.set($,E);++bt<Nt;){var tt=E[bt],Xt=$[bt];if(re)var Fr=et?re(Xt,tt,bt,$,E,ve):re(tt,Xt,bt,E,$,ve);if(Fr!==void 0){if(Fr)continue;ar=!1;break}if(Ct){if(!Pe($,function(Sr,Wr){if(!ot(Ct,Wr)&&(tt===Sr||Ve(tt,Sr,V,re,ve)))return Ct.push(Wr)})){ar=!1;break}}else if(!(tt===Xt||Ve(tt,Xt,V,re,ve))){ar=!1;break}}return ve.delete(E),ve.delete($),ar}function ra(E,$,V,re,Ve,ve,et){switch(V){case Ne:if(E.byteLength!=$.byteLength||E.byteOffset!=$.byteOffset)return!1;E=E.buffer,$=$.buffer;case ge:return!(E.byteLength!=$.byteLength||!ve(new Qt(E),new Qt($)));case S:case A:case se:return Rs(+E,+$);case j:return E.name==$.name&&E.message==$.message;case w:case C:return E==$+"";case J:var Nt=Ye;case g:var Ae=re&a;if(Nt||(Nt=at),E.size!=$.size&&!Ae)return!1;var We=et.get(E);if(We)return We==$;re|=h,et.set(E,$);var bt=nn(Nt(E),Nt($),re,Ve,ve,et);return et.delete(E),bt;case R:if(yt)return yt.call(E)==yt.call($)}return!1}function Es(E,$,V,re,Ve,ve){var et=V&a,Nt=sn(E),Ae=Nt.length,We=sn($),bt=We.length;if(Ae!=bt&&!et)return!1;for(var ar=Ae;ar--;){var Ct=Nt[ar];if(!(et?Ct in $:Le.call($,Ct)))return!1}var tt=ve.get(E);if(tt&&ve.get($))return tt==$;var Xt=!0;ve.set(E,$),ve.set($,E);for(var Fr=et;++ar<Ae;){Ct=Nt[ar];var Sr=E[Ct],Wr=$[Ct];if(re)var $n=et?re(Wr,Sr,Ct,$,E,ve):re(Sr,Wr,Ct,E,$,ve);if(!($n===void 0?Sr===Wr||Ve(Sr,Wr,V,re,ve):$n)){Xt=!1;break}Fr||(Fr=Ct=="constructor")}if(Xt&&!Fr){var ji=E.constructor,Lt=$.constructor;ji!=Lt&&"constructor"in E&&"constructor"in $&&!(typeof ji=="function"&&ji instanceof ji&&typeof Lt=="function"&&Lt instanceof Lt)&&(Xt=!1)}return ve.delete(E),ve.delete($),Xt}function sn(E){return Tn(E,oa,Ss)}function vi(E,$){var V=E.__data__;return Ps($)?V[typeof $=="string"?"string":"hash"]:V.map}function yr(E,$){var V=Ue(E,$);return ta(V)?V:void 0}function Is(E){var $=Le.call(E,Yt),V=E[Yt];try{E[Yt]=void 0;var re=!0}catch{}var Ve=Dt.call(E);return re&&($?E[Yt]=V:delete E[Yt]),Ve}var Ss=Xr?function(E){return E==null?[]:(E=Object(E),Ce(Xr(E),function($){return or.call(E,$)}))}:Ke,Vr=Di;(lt&&Vr(new lt(new ArrayBuffer(1)))!=Ne||rt&&Vr(new rt)!=J||ft&&Vr(ft.resolve())!=y||dt&&Vr(new dt)!=g||ct&&Vr(new ct)!=oe)&&(Vr=function(E){var $=Di(E),V=$==f?E.constructor:void 0,re=V?ei(V):"";if(re)switch(re){case Pt:return Ne;case Ot:return J;case pt:return y;case At:return g;case gt:return oe}return $});function xs(E,$){return $=$??d,!!$&&(typeof E=="number"||kr.test(E))&&E>-1&&E%1==0&&E<$}function Ps(E){var $=typeof E;return $=="string"||$=="number"||$=="symbol"||$=="boolean"?E!=="__proto__":E===null}function Os(E){return!!xt&&xt in E}function As(E){var $=E&&E.constructor,V=typeof $=="function"&&$.prototype||$e;return E===V}function ia(E){return Dt.call(E)}function ei(E){if(E!=null){try{return ht.call(E)}catch{}try{return E+""}catch{}}return""}function Rs(E,$){return E===$||E!==E&&$!==$}var Ts=Nn(function(){return arguments}())?Nn:function(E){return Ui(E)&&Le.call(E,"callee")&&!or.call(E,"callee")},on=Array.isArray;function na(E){return E!=null&&Ns(E.length)&&!an(E)}var Cn=mi||He;function sa(E,$){return Fi(E,$)}function an(E){if(!Cs(E))return!1;var $=Di(E);return $==B||$==L||$==_||$==b}function Ns(E){return typeof E=="number"&&E>-1&&E%1==0&&E<=d}function Cs(E){var $=typeof E;return E!=null&&($=="object"||$=="function")}function Ui(E){return E!=null&&typeof E=="object"}var $s=_e?vt(_e):bs;function oa(E){return na(E)?vs(E):_s(E)}function Ke(){return[]}function He(){return!1}n.exports=sa})($o,$o.exports);var M_=$o.exports;const q_=jf(M_);function z_(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<n.length;a++){var h=n.charAt(a),d=h.charCodeAt(0);if(r[d]!==255)throw new TypeError(h+" is ambiguous");r[d]=a}var v=n.length,P=n.charAt(0),_=Math.log(v)/Math.log(256),S=Math.log(256)/Math.log(v);function A(L){if(L instanceof Uint8Array||(ArrayBuffer.isView(L)?L=new Uint8Array(L.buffer,L.byteOffset,L.byteLength):Array.isArray(L)&&(L=Uint8Array.from(L))),!(L instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(L.length===0)return"";for(var J=0,se=0,he=0,f=L.length;he!==f&&L[he]===0;)he++,J++;for(var y=(f-he)*S+1>>>0,b=new Uint8Array(y);he!==f;){for(var w=L[he],g=0,C=y-1;(w!==0||g<se)&&C!==-1;C--,g++)w+=256*b[C]>>>0,b[C]=w%v>>>0,w=w/v>>>0;if(w!==0)throw new Error("Non-zero carry");se=g,he++}for(var R=y-se;R!==y&&b[R]===0;)R++;for(var X=P.repeat(J);R<y;++R)X+=n.charAt(b[R]);return X}function j(L){if(typeof L!="string")throw new TypeError("Expected String");if(L.length===0)return new Uint8Array;var J=0;if(L[J]!==" "){for(var se=0,he=0;L[J]===P;)se++,J++;for(var f=(L.length-J)*_+1>>>0,y=new Uint8Array(f);L[J];){var b=r[L.charCodeAt(J)];if(b===255)return;for(var w=0,g=f-1;(b!==0||w<he)&&g!==-1;g--,w++)b+=v*y[g]>>>0,y[g]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");he=w,J++}if(L[J]!==" "){for(var C=f-he;C!==f&&y[C]===0;)C++;for(var R=new Uint8Array(se+(f-C)),X=se;C!==f;)R[X++]=y[C++];return R}}}function B(L){var J=j(L);if(J)return J;throw new Error(`Non-${t} character`)}return{encode:A,decodeUnsafe:j,decode:B}}var H_=z_,B_=H_;const dd=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},k_=n=>new TextEncoder().encode(n),K_=n=>new TextDecoder().decode(n);class V_{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class W_{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return pd(this,t)}}let G_=class{constructor(t){this.decoders=t}or(t){return pd(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const pd=(n,t)=>new G_({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class J_{constructor(t,r,s,a){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new V_(t,r,s),this.decoder=new W_(t,r,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Lo=({name:n,prefix:t,encode:r,decode:s})=>new J_(n,t,r,s),ps=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:a}=B_(r,t);return Lo({prefix:n,name:t,encode:s,decode:h=>dd(a(h))})},Q_=(n,t,r,s)=>{const a={};for(let S=0;S<t.length;++S)a[t[S]]=S;let h=n.length;for(;n[h-1]==="=";)--h;const d=new Uint8Array(h*r/8|0);let v=0,P=0,_=0;for(let S=0;S<h;++S){const A=a[n[S]];if(A===void 0)throw new SyntaxError(`Non-${s} character`);P=P<<r|A,v+=r,v>=8&&(v-=8,d[_++]=255&P>>v)}if(v>=r||255&P<<8-v)throw new SyntaxError("Unexpected end of data");return d},Y_=(n,t,r)=>{const s=t[t.length-1]==="=",a=(1<<r)-1;let h="",d=0,v=0;for(let P=0;P<n.length;++P)for(v=v<<8|n[P],d+=8;d>r;)d-=r,h+=t[a&v>>d];if(d&&(h+=t[a&v<<r-d]),s)for(;h.length*r&7;)h+="=";return h},Vt=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>Lo({prefix:t,name:n,encode(a){return Y_(a,s,r)},decode(a){return Q_(a,s,r,n)}}),X_=Lo({prefix:"\0",name:"identity",encode:n=>K_(n),decode:n=>k_(n)});var Z_=Object.freeze({__proto__:null,identity:X_});const eE=Vt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var tE=Object.freeze({__proto__:null,base2:eE});const rE=Vt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var iE=Object.freeze({__proto__:null,base8:rE});const nE=ps({prefix:"9",name:"base10",alphabet:"0123456789"});var sE=Object.freeze({__proto__:null,base10:nE});const oE=Vt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),aE=Vt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var cE=Object.freeze({__proto__:null,base16:oE,base16upper:aE});const uE=Vt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),hE=Vt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),lE=Vt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),fE=Vt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),dE=Vt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),pE=Vt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),gE=Vt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),yE=Vt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),mE=Vt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var vE=Object.freeze({__proto__:null,base32:uE,base32upper:hE,base32pad:lE,base32padupper:fE,base32hex:dE,base32hexupper:pE,base32hexpad:gE,base32hexpadupper:yE,base32z:mE});const wE=ps({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),bE=ps({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var _E=Object.freeze({__proto__:null,base36:wE,base36upper:bE});const EE=ps({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),IE=ps({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var SE=Object.freeze({__proto__:null,base58btc:EE,base58flickr:IE});const xE=Vt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),PE=Vt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),OE=Vt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),AE=Vt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var RE=Object.freeze({__proto__:null,base64:xE,base64pad:PE,base64url:OE,base64urlpad:AE});const gd=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),TE=gd.reduce((n,t,r)=>(n[r]=t,n),[]),NE=gd.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function CE(n){return n.reduce((t,r)=>(t+=TE[r],t),"")}function $E(n){const t=[];for(const r of n){const s=NE[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const DE=Lo({prefix:"🚀",name:"base256emoji",encode:CE,decode:$E});var FE=Object.freeze({__proto__:null,base256emoji:DE}),UE=yd,Ql=128,jE=127,LE=~jE,ME=Math.pow(2,31);function yd(n,t,r){t=t||[],r=r||0;for(var s=r;n>=ME;)t[r++]=n&255|Ql,n/=128;for(;n&LE;)t[r++]=n&255|Ql,n>>>=7;return t[r]=n|0,yd.bytes=r-s+1,t}var qE=Fc,zE=128,Yl=127;function Fc(n,s){var r=0,s=s||0,a=0,h=s,d,v=n.length;do{if(h>=v)throw Fc.bytes=0,new RangeError("Could not decode varint");d=n[h++],r+=a<28?(d&Yl)<<a:(d&Yl)*Math.pow(2,a),a+=7}while(d>=zE);return Fc.bytes=h-s,r}var HE=Math.pow(2,7),BE=Math.pow(2,14),kE=Math.pow(2,21),KE=Math.pow(2,28),VE=Math.pow(2,35),WE=Math.pow(2,42),GE=Math.pow(2,49),JE=Math.pow(2,56),QE=Math.pow(2,63),YE=function(n){return n<HE?1:n<BE?2:n<kE?3:n<KE?4:n<VE?5:n<WE?6:n<GE?7:n<JE?8:n<QE?9:10},XE={encode:UE,decode:qE,encodingLength:YE},md=XE;const Xl=(n,t,r=0)=>(md.encode(n,t,r),t),Zl=n=>md.encodingLength(n),Uc=(n,t)=>{const r=t.byteLength,s=Zl(n),a=s+Zl(r),h=new Uint8Array(a+r);return Xl(n,h,0),Xl(r,h,s),h.set(t,a),new ZE(n,r,t,h)};class ZE{constructor(t,r,s,a){this.code=t,this.size=r,this.digest=s,this.bytes=a}}const vd=({name:n,code:t,encode:r})=>new eI(n,t,r);class eI{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Uc(this.code,r):r.then(s=>Uc(this.code,s))}else throw Error("Unknown type, must be binary type")}}const wd=n=>async t=>new Uint8Array(await crypto.subtle.digest(n,t)),tI=vd({name:"sha2-256",code:18,encode:wd("SHA-256")}),rI=vd({name:"sha2-512",code:19,encode:wd("SHA-512")});var iI=Object.freeze({__proto__:null,sha256:tI,sha512:rI});const bd=0,nI="identity",_d=dd,sI=n=>Uc(bd,_d(n)),oI={code:bd,name:nI,encode:_d,digest:sI};var aI=Object.freeze({__proto__:null,identity:oI});new TextEncoder,new TextDecoder;const ef={...Z_,...tE,...iE,...sE,...cE,...vE,..._E,...SE,...RE,...FE};({...iI,...aI});function Ed(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function cI(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Ed(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Id(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const tf=Id("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),vc=Id("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=cI(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),uI={utf8:tf,"utf-8":tf,hex:ef.base16,latin1:vc,ascii:vc,binary:vc,...ef};function hI(n,t="utf8"){const r=uI[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Ed(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const Sd="wc",lI=2,nu="core",Ri=`${Sd}@2:${nu}:`,fI={name:nu,logger:"error"},dI={database:":memory:"},pI="crypto",rf="client_ed25519_seed",gI=ue.ONE_DAY,yI="keychain",mI="0.3",vI="messages",wI="0.3",bI=ue.SIX_HOURS,_I="publisher",xd="irn",EI="error",Pd="wss://relay.walletconnect.com",nf="wss://relay.walletconnect.org",II="relayer",Jt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},SI="_subscription",fi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},xI=ue.ONE_SECOND,PI="2.10.6",OI=1e4,AI="0.3",RI="WALLETCONNECT_CLIENT_ID",qr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},TI="subscription",NI="0.3",CI=ue.FIVE_SECONDS*1e3,$I="pairing",DI="0.3",Yn={wc_pairingDelete:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ue.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ue.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ue.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:0},res:{ttl:ue.ONE_DAY,prompt:!1,tag:0}}},rs={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Yr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},FI="history",UI="0.3",jI="expirer",Cr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},LI="0.3",wc="verify-api",En="https://verify.walletconnect.com",jc="https://verify.walletconnect.org",MI=[En,jc];class qI{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=yI,this.version=mI,this.initialized=!1,this.storagePrefix=Ri,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:h}=ee("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(h)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=Te.generateChildLogger(r,this.name)}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,ed(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?td(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=ee("NOT_INITIALIZED",this.name);throw new Error(t)}}}class zI{constructor(t,r,s){this.core=t,this.logger=r,this.name=pI,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),h=Rl(a);return Jf(h.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=nb();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const h=await this.getClientSeed(),d=Rl(h),v=$c();return await rb(v,a,gI,d)},this.generateSharedKey=(a,h,d)=>{this.isInitialized();const v=this.getPrivateKey(a),P=sb(v,h);return this.setSymKey(P,d)},this.setSymKey=async(a,h)=>{this.isInitialized();const d=h||ob(a);return await this.keychain.set(d,a),d},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,h,d)=>{this.isInitialized();const v=Zf(d),P=Ji(h);if(Nl(v)){const j=v.senderPublicKey,B=v.receiverPublicKey;a=await this.generateSharedKey(j,B)}const _=this.getSymKey(a),{type:S,senderPublicKey:A}=v;return cb({type:S,symKey:_,message:P,senderPublicKey:A})},this.decode=async(a,h,d)=>{this.isInitialized();const v=lb(h,d);if(Nl(v)){const P=v.receiverPublicKey,_=v.senderPublicKey;a=await this.generateSharedKey(P,_)}try{const P=this.getSymKey(a),_=ub({symKey:P,encoded:h});return hs(_)}catch(P){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(P)}},this.getPayloadType=a=>{const h=No(a);return ls(h.type)},this.getPayloadSenderPublicKey=a=>{const h=No(a);return h.senderPublicKey?sr(h.senderPublicKey,nr):void 0},this.core=t,this.logger=Te.generateChildLogger(r,this.name),this.keychain=s||new qI(this.core,this.logger)}get context(){return Te.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(rf)}catch{t=$c(),await this.keychain.set(rf,t)}return hI(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=ee("NOT_INITIALIZED",this.name);throw new Error(t)}}}class HI extends Dw{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=vI,this.version=wI,this.initialized=!1,this.storagePrefix=Ri,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const h=In(a);let d=this.messages.get(s);return typeof d>"u"&&(d={}),typeof d[h]<"u"||(d[h]=a,this.messages.set(s,d),await this.persist()),h},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const h=this.get(s),d=In(a);return typeof h[d]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Te.generateChildLogger(t,this.name),this.core=r}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,ed(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?td(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=ee("NOT_INITIALIZED",this.name);throw new Error(t)}}}class BI extends Fw{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new $r.EventEmitter,this.name=_I,this.queue=new Map,this.publishTimeout=ue.toMiliseconds(ue.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,a,h)=>{var d;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:h}});try{const v=(h==null?void 0:h.ttl)||bI,P=Dc(h),_=(h==null?void 0:h.prompt)||!1,S=(h==null?void 0:h.tag)||0,A=(h==null?void 0:h.id)||hd().toString(),j={topic:s,message:a,opts:{ttl:v,relay:P,prompt:_,tag:S,id:A}},B=setTimeout(()=>this.queue.set(A,j),this.publishTimeout);try{await await cs(this.rpcPublish(s,a,v,P,_,S,A),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(A),this.relayer.events.emit(Jt.publish,j)}catch(L){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(d=h==null?void 0:h.internal)!=null&&d.throwOnFailedPublish)throw this.removeRequestFromQueue(A),L;return}finally{clearTimeout(B)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:h}})}catch(v){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(v),v}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=t,this.logger=Te.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Te.getLoggerContext(this.logger)}rpcPublish(t,r,s,a,h,d,v){var P,_,S,A;const j={method:Ao(a.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:h,tag:d},id:v};return ir((P=j.params)==null?void 0:P.prompt)&&((_=j.params)==null||delete _.prompt),ir((S=j.params)==null?void 0:S.tag)&&((A=j.params)==null||delete A.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:j}),this.relayer.request(j)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:a}=t;await this.publish(r,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(Pn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Jt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Jt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class kI{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const a=s.filter(h=>h!==r);if(!a.length){this.map.delete(t);return}this.map.set(t,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var KI=Object.defineProperty,VI=Object.defineProperties,WI=Object.getOwnPropertyDescriptors,sf=Object.getOwnPropertySymbols,GI=Object.prototype.hasOwnProperty,JI=Object.prototype.propertyIsEnumerable,of=(n,t,r)=>t in n?KI(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Xn=(n,t)=>{for(var r in t||(t={}))GI.call(t,r)&&of(n,r,t[r]);if(sf)for(var r of sf(t))JI.call(t,r)&&of(n,r,t[r]);return n},bc=(n,t)=>VI(n,WI(t));class QI extends Lw{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new kI,this.events=new $r.EventEmitter,this.name=TI,this.version=NI,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ri,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const h=Dc(a),d={topic:s,relay:h};this.pending.set(s,d);const v=await this.rpcSubscribe(s,h);return this.onSubscribe(v,d),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}}),v}catch(h){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(h),h}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((a,h)=>{const d=new ue.Watch;d.start(this.pendingSubscriptionWatchLabel);const v=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(v),d.stop(this.pendingSubscriptionWatchLabel),a(!0)),d.elapsed(this.pendingSubscriptionWatchLabel)>=CI&&(clearInterval(v),d.stop(this.pendingSubscriptionWatchLabel),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Te.generateChildLogger(r,this.name),this.clientId=""}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async a=>await this.unsubscribeById(t,a,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const a=Dc(s);await this.rpcUnsubscribe(t,r,a);const h=zt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,h),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(t,r){const s={method:Ao(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await cs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Jt.connection_stalled)}return In(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:Ao(r.protocol).batchSubscribe,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await cs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Jt.connection_stalled)}}rpcUnsubscribe(t,r,s){const a={method:Ao(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(t,r){this.setSubscription(t,bc(Xn({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,Xn({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,Xn({},r)),this.topicMap.set(r.topic,t),this.events.emit(qr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=ee("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(qr.deleted,bc(Xn({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(qr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(qr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=ee("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);ds(r)&&this.onBatchSubscribe(r.map((s,a)=>bc(Xn({},t[a]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(Pn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Jt.connect,async()=>{await this.onConnect()}),this.relayer.on(Jt.disconnect,()=>{this.onDisconnect()}),this.events.on(qr.created,async t=>{const r=qr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(qr.deleted,async t=>{const r=qr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=ee("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var YI=Object.defineProperty,af=Object.getOwnPropertySymbols,XI=Object.prototype.hasOwnProperty,ZI=Object.prototype.propertyIsEnumerable,cf=(n,t,r)=>t in n?YI(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,eS=(n,t)=>{for(var r in t||(t={}))XI.call(t,r)&&cf(n,r,t[r]);if(af)for(var r of af(t))ZI.call(t,r)&&cf(n,r,t[r]);return n};class tS extends Uw{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new $r.EventEmitter,this.name=II,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Jt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Jt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(fi.payload,this.onPayloadHandler),this.provider.on(fi.connect,this.onConnectHandler),this.provider.on(fi.disconnect,this.onDisconnectHandler),this.provider.on(fi.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Te.generateChildLogger(t.logger,this.name):Te.pino(Te.getDefaultLoggerOptions({level:t.logger||EI})),this.messages=new HI(this.logger,t.core),this.subscriber=new QI(this,this.logger),this.publisher=new BI(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||Pd,this.projectId=t.projectId,this.bundleId=mb(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${nf}...`),await this.restartTransport(nf)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},OI)}get context(){return Te.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var s;this.isInitialized();let a=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";if(a)return a;let h;const d=v=>{v.topic===t&&(this.subscriber.off(qr.created,d),h())};return await Promise.all([new Promise(v=>{h=v,this.subscriber.on(qr.created,d)}),new Promise(async v=>{a=await this.subscriber.subscribe(t,r),v()})]),a}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await cs(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(qr.resubscribed,()=>{r()})}),new Promise(async(r,s)=>{try{await cs(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){s(a);return}r()})])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.provider.events.emit(fi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Hl())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new gi(new L_(Ib({sdkVersion:PI,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,s);return a&&this.logger.debug(`Ignoring duplicate message: ${s}`),a}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),iu(t)){if(!t.method.endsWith(SI))return;const r=t.params,{topic:s,message:a,publishedAt:h}=r.data,d={topic:s,message:a,publishedAt:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(eS({type:"event",event:r.id},d)),this.events.emit(r.id,d),await this.acknowledgePayload(t),await this.onMessageEvent(d)}else jo(t)&&this.events.emit(Jt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Jt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=ru(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(fi.payload,this.onPayloadHandler),this.provider.off(fi.connect,this.onConnectHandler),this.provider.off(fi.disconnect,this.onDisconnectHandler),this.provider.off(fi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Jt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await Hl();g_(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(Jt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},ue.toMiliseconds(xI)))}isInitialized(){if(!this.initialized){const{message:t}=ee("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var rS=Object.defineProperty,uf=Object.getOwnPropertySymbols,iS=Object.prototype.hasOwnProperty,nS=Object.prototype.propertyIsEnumerable,hf=(n,t,r)=>t in n?rS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,lf=(n,t)=>{for(var r in t||(t={}))iS.call(t,r)&&hf(n,r,t[r]);if(uf)for(var r of uf(t))nS.call(t,r)&&hf(n,r,t[r]);return n};class Mo extends jw{constructor(t,r,s,a=Ri,h=void 0){super(t,r,s,a),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=AI,this.cached=[],this.initialized=!1,this.storagePrefix=Ri,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(d=>{this.getKey&&d!==null&&!ir(d)?this.map.set(this.getKey(d),d):Vb(d)?this.map.set(d.id,d):Wb(d)&&this.map.set(d.topic,d)}),this.cached=[],this.initialized=!0)},this.set=async(d,v)=>{this.isInitialized(),this.map.has(d)?await this.update(d,v):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:d,value:v}),this.map.set(d,v),await this.persist())},this.get=d=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:d}),this.getData(d)),this.getAll=d=>(this.isInitialized(),d?this.values.filter(v=>Object.keys(d).every(P=>q_(v[P],d[P]))):this.values),this.update=async(d,v)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:d,update:v});const P=lf(lf({},this.getData(d)),v);this.map.set(d,P),await this.persist()},this.delete=async(d,v)=>{this.isInitialized(),this.map.has(d)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:d,reason:v}),this.map.delete(d),await this.persist())},this.logger=Te.generateChildLogger(r,this.name),this.storagePrefix=a,this.getKey=h}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=ee("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=ee("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=ee("NOT_INITIALIZED",this.name);throw new Error(t)}}}class sS{constructor(t,r){this.core=t,this.logger=r,this.name=$I,this.version=DI,this.events=new Wc,this.initialized=!1,this.storagePrefix=Ri,this.ignoredPayloadTypes=[Xi],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=$c(),a=await this.core.crypto.setSymKey(s),h=zr(ue.FIVE_MINUTES),d={protocol:xd},v={topic:a,expiry:h,relay:d,active:!1},P=Ub({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:d});return await this.pairings.set(a,v),await this.core.relayer.subscribe(a),this.core.expirer.set(a,h),{topic:a,uri:P}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:h,relay:d}=jl(s.uri);let v;if(this.pairings.keys.includes(a)&&(v=this.pairings.get(a),v.active))throw new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);const P=zr(ue.FIVE_MINUTES),_={topic:a,relay:d,expiry:P,active:!1};return await this.pairings.set(a,_),this.core.expirer.set(a,P),s.activatePairing&&await this.activate({topic:a}),this.events.emit(rs.create,_),this.core.crypto.keychain.has(a)||(await this.core.crypto.setSymKey(h,a),await this.core.relayer.subscribe(a,{relay:d})),_},this.activate=async({topic:s})=>{this.isInitialized();const a=zr(ue.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:a}),this.core.expirer.set(s,a)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const h=await this.sendRequest(a,"wc_pairingPing",{}),{done:d,resolve:v,reject:P}=_n();this.events.once($t("pairing_ping",h),({error:_})=>{_?P(_):v()}),await d()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",zt("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,h)=>{const d=Sn(a,h),v=await this.core.crypto.encode(s,d),P=Yn[a].req;return this.core.history.set(s,d),this.core.relayer.publish(s,v,P),d.id},this.sendResult=async(s,a,h)=>{const d=ru(s,h),v=await this.core.crypto.encode(a,d),P=await this.core.history.get(a,s),_=Yn[P.request.method].res;await this.core.relayer.publish(a,v,_),await this.core.history.resolve(d)},this.sendError=async(s,a,h)=>{const d=Uo(s,h),v=await this.core.crypto.encode(a,d),P=await this.core.history.get(a,s),_=Yn[P.request.method]?Yn[P.request.method].res:Yn.unregistered_method.res;await this.core.relayer.publish(a,v,_),await this.core.history.resolve(d)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,zt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>Ai(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:h}=s;switch(h.method){case"wc_pairingPing":return this.onPairingPingRequest(a,h);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,h);default:return this.onUnknownRpcMethodRequest(a,h)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:h}=s,d=(await this.core.history.get(a,h.id)).request.method;switch(d){case"wc_pairingPing":return this.onPairingPingResponse(a,h);default:return this.onUnknownRpcMethodResponse(d)}},this.onPairingPingRequest=async(s,a)=>{const{id:h}=a;try{this.isValidPing({topic:s}),await this.sendResult(h,s,!0),this.events.emit(rs.ping,{id:h,topic:s})}catch(d){await this.sendError(h,s,d),this.logger.error(d)}},this.onPairingPingResponse=(s,a)=>{const{id:h}=a;setTimeout(()=>{pi(a)?this.events.emit($t("pairing_ping",h),{}):Hr(a)&&this.events.emit($t("pairing_ping",h),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:h}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(rs.delete,{id:h,topic:s})}catch(d){await this.sendError(h,s,d),this.logger.error(d)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:h,method:d}=a;try{if(this.registeredMethods.includes(d))return;const v=zt("WC_METHOD_UNSUPPORTED",d);await this.sendError(h,s,v),this.logger.error(v)}catch(v){await this.sendError(h,s,v),this.logger.error(v)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(zt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var a;if(!pr(s)){const{message:d}=ee("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(d)}if(!Kb(s.uri)){const{message:d}=ee("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(d)}const h=jl(s.uri);if(!((a=h==null?void 0:h.relay)!=null&&a.protocol)){const{message:d}=ee("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(d)}if(!(h!=null&&h.symKey)){const{message:d}=ee("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(d)}},this.isValidPing=async s=>{if(!pr(s)){const{message:h}=ee("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(h)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!pr(s)){const{message:h}=ee("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(h)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!Ht(s,!1)){const{message:a}=ee("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=ee("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(Ai(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=ee("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=t,this.logger=Te.generateChildLogger(r,this.name),this.pairings=new Mo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Te.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=ee("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Jt.message,async t=>{const{topic:r,message:s}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(r,s);try{iu(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):jo(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(h){this.logger.error(h)}})}registerExpirerEvents(){this.core.expirer.on(Cr.expired,async t=>{const{topic:r}=id(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(rs.expire,{topic:r}))})}}class oS extends $w{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new $r.EventEmitter,this.name=FI,this.version=UI,this.cached=[],this.initialized=!1,this.storagePrefix=Ri,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,h)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:h}),this.records.has(a.id))return;const d={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:h,expiry:zr(ue.THIRTY_DAYS)};this.records.set(d.id,d),this.events.emit(Yr.created,d)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=Hr(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.events.emit(Yr.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(h=>{if(h.topic===s){if(typeof a<"u"&&h.id!==a)return;this.records.delete(h.id),this.events.emit(Yr.deleted,h)}})},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Te.generateChildLogger(r,this.name)}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:Sn(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=ee("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Yr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=ee("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Yr.created,t=>{const r=Yr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Yr.updated,t=>{const r=Yr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Yr.deleted,t=>{const r=Yr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(Pn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{ue.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=ee("NOT_INITIALIZED",this.name);throw new Error(t)}}}class aS extends Mw{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new $r.EventEmitter,this.name=jI,this.version=LI,this.cached=[],this.initialized=!1,this.storagePrefix=Ri,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(s,a)=>{this.isInitialized();const h=this.formatTarget(s),d={target:h,expiry:a};this.expirations.set(h,d),this.checkExpiry(h,d),this.events.emit(Cr.created,{target:h,expiration:d})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),h=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Cr.deleted,{target:a,expiration:h})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Te.generateChildLogger(r,this.name)}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Sb(t);if(typeof t=="number")return xb(t);const{message:r}=ee("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Cr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=ee("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=ee("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;ue.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Cr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(Pn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Cr.created,t=>{const r=Cr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Cr.expired,t=>{const r=Cr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Cr.deleted,t=>{const r=Cr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=ee("NOT_INITIALIZED",this.name);throw new Error(t)}}}class cS extends qw{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=wc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||On()||!An())return;const a=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h)}if(!this.initialized){this.removeIframe(),this.verifyUrl=jc;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const a=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let h;try{h=await this.fetchAttestation(s.attestationId,a)}catch(d){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${a}`),this.logger.info(d),h=await this.fetchAttestation(s.attestationId,jc)}return h},this.fetchAttestation=async(s,a)=>{this.logger.info(`resolving attestation: ${s} from url: ${a}`);const h=this.startAbortTimer(ue.ONE_SECOND*2),d=await fetch(`${a}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(h),d.status===200?await d.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const a=h=>{h.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),s())};await Promise.race([new Promise(h=>{if(document.getElementById(wc))return h();window.addEventListener("message",a);const d=document.createElement("iframe");d.id=wc,d.src=`${this.verifyUrl}/${this.projectId}`,d.style.display="none",document.body.append(d),this.iframe=d,s=h}),new Promise((h,d)=>setTimeout(()=>{window.removeEventListener("message",a),d("verify iframe load timeout")},ue.toMiliseconds(ue.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let a=s||En;return MI.includes(a)||(this.logger.info(`verify url: ${a}, not included in trusted list, assigning default: ${En}`),a=En),a},this.logger=Te.generateChildLogger(r,this.name),this.verifyUrl=En,this.abortController=new AbortController,this.isDevEnv=Xc()&&{}.IS_VITEST}get context(){return Te.getLoggerContext(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ue.toMiliseconds(t))}}var uS=Object.defineProperty,ff=Object.getOwnPropertySymbols,hS=Object.prototype.hasOwnProperty,lS=Object.prototype.propertyIsEnumerable,df=(n,t,r)=>t in n?uS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,pf=(n,t)=>{for(var r in t||(t={}))hS.call(t,r)&&df(n,r,t[r]);if(ff)for(var r of ff(t))lS.call(t,r)&&df(n,r,t[r]);return n};class su extends Cw{constructor(t){super(t),this.protocol=Sd,this.version=lI,this.name=nu,this.events=new $r.EventEmitter,this.initialized=!1,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Pd,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Te.pino(Te.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||fI.logger}));this.logger=Te.generateChildLogger(r,this.name),this.heartbeat=new Pn.HeartBeat,this.crypto=new zI(this,this.logger,t==null?void 0:t.keychain),this.history=new oS(this,this.logger),this.expirer=new aS(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new Iw(pf(pf({},dI),t==null?void 0:t.storageOptions)),this.relayer=new tS({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new sS(this,this.logger),this.verify=new cS(this.projectId||"",this.logger)}static async init(t){const r=new su(t);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(RI,s),r}get context(){return Te.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const fS=su,Od="wc",Ad=2,Rd="client",ou=`${Od}@${Ad}:${Rd}:`,_c={name:Rd,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},gf="WALLETCONNECT_DEEPLINK_CHOICE",dS="proposal",Td="Proposal expired",pS="session",Io=ue.SEVEN_DAYS,gS="engine",Zn={wc_sessionPropose:{req:{ttl:ue.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ue.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ue.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ue.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ue.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ue.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ue.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ue.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ue.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ue.THIRTY_SECONDS,prompt:!1,tag:1115}}},Ec={min:ue.FIVE_MINUTES,max:ue.SEVEN_DAYS},di={idle:"IDLE",active:"ACTIVE"},yS="request",mS=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var vS=Object.defineProperty,wS=Object.defineProperties,bS=Object.getOwnPropertyDescriptors,yf=Object.getOwnPropertySymbols,_S=Object.prototype.hasOwnProperty,ES=Object.prototype.propertyIsEnumerable,mf=(n,t,r)=>t in n?vS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,fr=(n,t)=>{for(var r in t||(t={}))_S.call(t,r)&&mf(n,r,t[r]);if(yf)for(var r of yf(t))ES.call(t,r)&&mf(n,r,t[r]);return n},es=(n,t)=>wS(n,bS(t));class IS extends Hw{constructor(t){super(t),this.name=gS,this.events=new Wc,this.initialized=!1,this.ignoredPayloadTypes=[Xi],this.requestQueue={state:di.idle,queue:[]},this.sessionRequestQueue={state:di.idle,queue:[]},this.requestQueueDelay=ue.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Zn)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ue.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const s=es(fr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:h,optionalNamespaces:d,sessionProperties:v,relays:P}=s;let _=a,S,A=!1;if(_&&(A=this.client.core.pairing.pairings.get(_).active),!_||!A){const{topic:y,uri:b}=await this.client.core.pairing.create();_=y,S=b}const j=await this.client.core.crypto.generateKeyPair(),B=fr({requiredNamespaces:h,optionalNamespaces:d,relays:P??[{protocol:xd}],proposer:{publicKey:j,metadata:this.client.metadata}},v&&{sessionProperties:v}),{reject:L,resolve:J,done:se}=_n(ue.FIVE_MINUTES,Td);if(this.events.once($t("session_connect"),async({error:y,session:b})=>{if(y)L(y);else if(b){b.self.publicKey=j;const w=es(fr({},b),{requiredNamespaces:b.requiredNamespaces,optionalNamespaces:b.optionalNamespaces});await this.client.session.set(b.topic,w),await this.setExpiry(b.topic,b.expiry),_&&await this.client.core.pairing.updateMetadata({topic:_,metadata:b.peer.metadata}),J(w)}}),!_){const{message:y}=ee("NO_MATCHING_KEY",`connect() pairing topic: ${_}`);throw new Error(y)}const he=await this.sendRequest({topic:_,method:"wc_sessionPropose",params:B}),f=zr(ue.FIVE_MINUTES);return await this.setProposal(he,fr({id:he,expiry:f},B)),{uri:S,approval:se}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:a,namespaces:h,sessionProperties:d}=r,v=this.client.proposal.get(s);let{pairingTopic:P,proposer:_,requiredNamespaces:S,optionalNamespaces:A}=v;P=P||"",ss(S)||(S=qb(h,"approve()"));const j=await this.client.core.crypto.generateKeyPair(),B=_.publicKey,L=await this.client.core.crypto.generateSharedKey(j,B);P&&s&&(await this.client.core.pairing.updateMetadata({topic:P,metadata:_.metadata}),await this.sendResult({id:s,topic:P,result:{relay:{protocol:a??"irn"},responderPublicKey:j}}),await this.client.proposal.delete(s,zt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:P}));const J=fr({relay:{protocol:a??"irn"},namespaces:h,requiredNamespaces:S,optionalNamespaces:A,pairingTopic:P,controller:{publicKey:j,metadata:this.client.metadata},expiry:zr(Io)},d&&{sessionProperties:d});await this.client.core.relayer.subscribe(L),await this.sendRequest({topic:L,method:"wc_sessionSettle",params:J,throwOnFailedPublish:!0});const se=es(fr({},J),{topic:L,pairingTopic:P,acknowledged:!1,self:J.controller,peer:{publicKey:_.publicKey,metadata:_.metadata},controller:j});return await this.client.session.set(L,se),await this.setExpiry(L,zr(Io)),{topic:L,acknowledged:()=>new Promise(he=>setTimeout(()=>he(this.client.session.get(L)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:s,reason:a}=r,{pairingTopic:h}=this.client.proposal.get(s);h&&(await this.sendError(s,h,a),await this.client.proposal.delete(s,zt("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:a}=r,h=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:d,resolve:v,reject:P}=_n();return this.events.once($t("session_update",h),({error:_})=>{_?P(_):v()}),await this.client.session.update(s,{namespaces:a}),{acknowledged:d}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,a=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:h,resolve:d,reject:v}=_n();return this.events.once($t("session_extend",a),({error:P})=>{P?v(P):d()}),await this.setExpiry(s,zr(Io)),{acknowledged:h}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:a,topic:h,expiry:d}=r,v=tu(),{done:P,resolve:_,reject:S}=_n(d,"Request expired. Please try again.");return this.events.once($t("session_request",v),({error:A,result:j})=>{A?S(A):_(j)}),await Promise.all([new Promise(async A=>{await this.sendRequest({clientRpcId:v,topic:h,method:"wc_sessionRequest",params:{request:a,chainId:s},expiry:d,throwOnFailedPublish:!0}).catch(j=>S(j)),this.client.events.emit("session_request_sent",{topic:h,request:a,chainId:s,id:v}),A()}),new Promise(async A=>{const j=await Ob(this.client.core.storage,gf);Pb({id:v,topic:h,wcDeepLink:j}),A()}),P()]).then(A=>A[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:a}=r,{id:h}=a;pi(a)?await this.sendResult({id:h,topic:s,result:a.result,throwOnFailedPublish:!0}):Hr(a)&&await this.sendError(h,s,a.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:h,resolve:d,reject:v}=_n();this.events.once($t("session_ping",a),({error:P})=>{P?v(P):d()}),await h()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:a,chainId:h}=r;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:a,chainId:h}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:zt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>Bb(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(h=>{var d,v;return((d=h.peerMetadata)==null?void 0:d.url)&&((v=h.peerMetadata)==null?void 0:v.url)===r.peer.metadata.url&&h.topic&&h.topic!==s.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(h=>this.client.core.pairing.disconnect({topic:h.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,zt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r),this.client.core.storage.removeItem(gf).catch(h=>this.client.logger.warn(h))},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,zt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),a?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(h=>h.id!==r),a&&(this.sessionRequestQueue.state=di.idle)},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=Zn.wc_sessionRequest.req.ttl,{id:a,topic:h,params:d,verifyContext:v}=r;await this.client.pendingRequest.set(a,{id:a,topic:h,params:d,verifyContext:v}),s&&this.client.core.expirer.set(a,zr(s))},this.sendRequest=async r=>{const{topic:s,method:a,params:h,expiry:d,relayRpcId:v,clientRpcId:P,throwOnFailedPublish:_}=r,S=Sn(a,h,P);if(An()&&mS.includes(a)){const B=In(JSON.stringify(S));this.client.core.verify.register({attestationId:B})}const A=await this.client.core.crypto.encode(s,S),j=Zn[a].req;return d&&(j.ttl=d),v&&(j.id=v),this.client.core.history.set(s,S),_?(j.internal=es(fr({},j.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,A,j)):this.client.core.relayer.publish(s,A,j).catch(B=>this.client.logger.error(B)),S.id},this.sendResult=async r=>{const{id:s,topic:a,result:h,throwOnFailedPublish:d}=r,v=ru(s,h),P=await this.client.core.crypto.encode(a,v),_=await this.client.core.history.get(a,s),S=Zn[_.request.method].res;d?(S.internal=es(fr({},S.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,P,S)):this.client.core.relayer.publish(a,P,S).catch(A=>this.client.logger.error(A)),await this.client.core.history.resolve(v)},this.sendError=async(r,s,a)=>{const h=Uo(r,a),d=await this.client.core.crypto.encode(s,h),v=await this.client.core.history.get(s,r),P=Zn[v.request.method].res;this.client.core.relayer.publish(s,d,P),await this.client.core.history.resolve(h)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(a=>{Ai(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{Ai(a.expiry)&&s.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===di.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=di.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=di.idle},this.processRequest=r=>{const{topic:s,payload:a}=r,h=a.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return this.onSessionExtendRequest(s,a);case"wc_sessionPing":return this.onSessionPingRequest(s,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return this.onSessionRequest(s,a);case"wc_sessionEvent":return this.onSessionEventRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${h}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:a}=r,h=(await this.client.core.history.get(s,a.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:a}=ee("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,s)=>{const{params:a,id:h}=s;try{this.isValidConnect(fr({},s.params));const d=zr(ue.FIVE_MINUTES),v=fr({id:h,pairingTopic:r,expiry:d},a);await this.setProposal(h,v);const P=In(JSON.stringify(s)),_=await this.getVerifyContext(P,v.proposer.metadata);this.client.events.emit("session_proposal",{id:h,params:v,verifyContext:_})}catch(d){await this.sendError(h,r,d),this.client.logger.error(d)}},this.onSessionProposeResponse=async(r,s)=>{const{id:a}=s;if(pi(s)){const{result:h}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const d=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:d});const v=d.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:v});const P=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:P});const _=await this.client.core.crypto.generateSharedKey(v,P);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:_});const S=await this.client.core.relayer.subscribe(_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:S}),await this.client.core.pairing.activate({topic:r})}else Hr(s)&&(await this.client.proposal.delete(a,zt("USER_DISCONNECTED")),this.events.emit($t("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:a,params:h}=s;try{this.isValidSessionSettleRequest(h);const{relay:d,controller:v,expiry:P,namespaces:_,requiredNamespaces:S,optionalNamespaces:A,sessionProperties:j,pairingTopic:B}=s.params,L=fr({topic:r,relay:d,expiry:P,namespaces:_,acknowledged:!0,pairingTopic:B,requiredNamespaces:S,optionalNamespaces:A,controller:v.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:v.publicKey,metadata:v.metadata}},j&&{sessionProperties:j});await this.sendResult({id:s.id,topic:r,result:!0}),this.events.emit($t("session_connect"),{session:L}),this.cleanupDuplicatePairings(L)}catch(d){await this.sendError(a,r,d),this.client.logger.error(d)}},this.onSessionSettleResponse=async(r,s)=>{const{id:a}=s;pi(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit($t("session_approve",a),{})):Hr(s)&&(await this.client.session.delete(r,zt("USER_DISCONNECTED")),this.events.emit($t("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:a,id:h}=s;try{const d=`${r}_session_update`,v=Eo.get(d);if(v&&this.isRequestOutOfSync(v,h)){this.client.logger.info(`Discarding out of sync request - ${h}`);return}this.isValidUpdate(fr({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:h,topic:r,result:!0}),this.client.events.emit("session_update",{id:h,topic:r,params:a}),Eo.set(d,h)}catch(d){await this.sendError(h,r,d),this.client.logger.error(d)}},this.isRequestOutOfSync=(r,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,s)=>{const{id:a}=s;pi(s)?this.events.emit($t("session_update",a),{}):Hr(s)&&this.events.emit($t("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:a}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,zr(Io)),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(h){await this.sendError(a,r,h),this.client.logger.error(h)}},this.onSessionExtendResponse=(r,s)=>{const{id:a}=s;pi(s)?this.events.emit($t("session_extend",a),{}):Hr(s)&&this.events.emit($t("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:a}=s;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(h){await this.sendError(a,r,h),this.client.logger.error(h)}},this.onSessionPingResponse=(r,s)=>{const{id:a}=s;setTimeout(()=>{pi(s)?this.events.emit($t("session_ping",a),{}):Hr(s)&&this.events.emit($t("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(h=>{this.client.core.relayer.once(Jt.publish,async()=>{h(await this.deleteSession(r))})}),this.sendResult({id:a,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(h){this.client.logger.error(h)}},this.onSessionRequest=async(r,s)=>{const{id:a,params:h}=s;try{this.isValidRequest(fr({topic:r},h));const d=In(JSON.stringify(Sn("wc_sessionRequest",h,a))),v=this.client.session.get(r),P=await this.getVerifyContext(d,v.peer.metadata),_={id:a,topic:r,params:h,verifyContext:P};await this.setPendingSessionRequest(_),this.addSessionRequestToSessionRequestQueue(_),this.processSessionRequestQueue()}catch(d){await this.sendError(a,r,d),this.client.logger.error(d)}},this.onSessionRequestResponse=(r,s)=>{const{id:a}=s;pi(s)?this.events.emit($t("session_request",a),{result:s.result}):Hr(s)&&this.events.emit($t("session_request",a),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:a,params:h}=s;try{const d=`${r}_session_event_${h.event.name}`,v=Eo.get(d);if(v&&this.isRequestOutOfSync(v,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(fr({topic:r},h)),this.client.events.emit("session_event",{id:a,topic:r,params:h}),Eo.set(d,a)}catch(d){await this.sendError(a,r,d),this.client.logger.error(d)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=di.idle,this.processSessionRequestQueue()},ue.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===di.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=di.active,this.client.events.emit("session_request",r)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=r=>{if(r.active)return;const s=this.client.proposal.getAll().find(a=>a.pairingTopic===r.topic);s&&this.onSessionProposeRequest(r.topic,Sn("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async r=>{if(!pr(r)){const{message:P}=ee("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(P)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:h,sessionProperties:d,relays:v}=r;if(ir(s)||await this.isValidPairingTopic(s),!t_(v,!0)){const{message:P}=ee("MISSING_OR_INVALID",`connect() relays: ${v}`);throw new Error(P)}!ir(a)&&ss(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!ir(h)&&ss(h)!==0&&this.validateNamespaces(h,"optionalNamespaces"),ir(d)||this.validateSessionProps(d,"sessionProperties")},this.validateNamespaces=(r,s)=>{const a=e_(r,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!pr(r))throw new Error(ee("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:a,relayProtocol:h,sessionProperties:d}=r;await this.isValidProposalId(s);const v=this.client.proposal.get(s),P=Ro(a,"approve()");if(P)throw new Error(P.message);const _=ql(v.requiredNamespaces,a,"approve()");if(_)throw new Error(_.message);if(!Ht(h,!0)){const{message:S}=ee("MISSING_OR_INVALID",`approve() relayProtocol: ${h}`);throw new Error(S)}ir(d)||this.validateSessionProps(d,"sessionProperties")},this.isValidReject=async r=>{if(!pr(r)){const{message:h}=ee("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(h)}const{id:s,reason:a}=r;if(await this.isValidProposalId(s),!i_(a)){const{message:h}=ee("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(h)}},this.isValidSessionSettleRequest=r=>{if(!pr(r)){const{message:_}=ee("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(_)}const{relay:s,controller:a,namespaces:h,expiry:d}=r;if(!sd(s)){const{message:_}=ee("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(_)}const v=Gb(a,"onSessionSettleRequest()");if(v)throw new Error(v.message);const P=Ro(h,"onSessionSettleRequest()");if(P)throw new Error(P.message);if(Ai(d)){const{message:_}=ee("EXPIRED","onSessionSettleRequest()");throw new Error(_)}},this.isValidUpdate=async r=>{if(!pr(r)){const{message:P}=ee("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(P)}const{topic:s,namespaces:a}=r;await this.isValidSessionTopic(s);const h=this.client.session.get(s),d=Ro(a,"update()");if(d)throw new Error(d.message);const v=ql(h.requiredNamespaces,a,"update()");if(v)throw new Error(v.message)},this.isValidExtend=async r=>{if(!pr(r)){const{message:a}=ee("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!pr(r)){const{message:P}=ee("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(P)}const{topic:s,request:a,chainId:h,expiry:d}=r;await this.isValidSessionTopic(s);const{namespaces:v}=this.client.session.get(s);if(!Ml(v,h)){const{message:P}=ee("MISSING_OR_INVALID",`request() chainId: ${h}`);throw new Error(P)}if(!n_(a)){const{message:P}=ee("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(P)}if(!a_(v,h,a.method)){const{message:P}=ee("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(P)}if(d&&!l_(d,Ec)){const{message:P}=ee("MISSING_OR_INVALID",`request() expiry: ${d}. Expiry must be a number (in seconds) between ${Ec.min} and ${Ec.max}`);throw new Error(P)}},this.isValidRespond=async r=>{if(!pr(r)){const{message:h}=ee("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(h)}const{topic:s,response:a}=r;if(await this.isValidSessionTopic(s),!s_(a)){const{message:h}=ee("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(h)}},this.isValidPing=async r=>{if(!pr(r)){const{message:a}=ee("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!pr(r)){const{message:v}=ee("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(v)}const{topic:s,event:a,chainId:h}=r;await this.isValidSessionTopic(s);const{namespaces:d}=this.client.session.get(s);if(!Ml(d,h)){const{message:v}=ee("MISSING_OR_INVALID",`emit() chainId: ${h}`);throw new Error(v)}if(!o_(a)){const{message:v}=ee("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(v)}if(!c_(d,h,a.name)){const{message:v}=ee("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(v)}},this.isValidDisconnect=async r=>{if(!pr(r)){const{message:a}=ee("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const a={verified:{verifyUrl:s.verifyUrl||En,validation:"UNKNOWN",origin:s.url||""}};try{const h=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});h&&(a.verified.origin=h.origin,a.verified.isScam=h.isScam,a.verified.validation=h.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(h){this.client.logger.info(h)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(a=>{if(!Ht(a,!1)){const{message:h}=ee("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(h)}})}}async isInitialized(){if(!this.initialized){const{message:t}=ee("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Jt.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const a=await this.client.core.crypto.decode(r,s);try{iu(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):jo(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})}catch(h){this.client.logger.error(h)}})}registerExpirerEvents(){this.client.core.expirer.on(Cr.expired,async t=>{const{topic:r,id:s}=id(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ee("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(rs.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!Ht(t,!1)){const{message:r}=ee("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=ee("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Ai(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=ee("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!Ht(t,!1)){const{message:r}=ee("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=ee("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Ai(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=ee("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Ht(t,!1)){const{message:r}=ee("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=ee("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!r_(t)){const{message:r}=ee("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=ee("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Ai(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=ee("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class SS extends Mo{constructor(t,r){super(t,r,dS,ou),this.core=t,this.logger=r}}class xS extends Mo{constructor(t,r){super(t,r,pS,ou),this.core=t,this.logger=r}}class PS extends Mo{constructor(t,r){super(t,r,yS,ou,s=>s.id),this.core=t,this.logger=r}}let OS=class Nd extends zw{constructor(t){super(t),this.protocol=Od,this.version=Ad,this.name=_c.name,this.events=new $r.EventEmitter,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||_c.name,this.metadata=(t==null?void 0:t.metadata)||wb();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Te.pino(Te.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||_c.logger}));this.core=(t==null?void 0:t.core)||new fS(t),this.logger=Te.generateChildLogger(r,this.name),this.session=new xS(this.core,this.logger),this.proposal=new SS(this.core,this.logger),this.pendingRequest=new PS(this.core,this.logger),this.engine=new IS(this)}static async init(t){const r=new Nd(t);return await r.initialize(),r}get context(){return Te.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var AS={};(function(n){const t=kc,r=Kc,s=Hc,a=Bc,h=f=>f==null,d=Symbol("encodeFragmentIdentifier");function v(f){switch(f.arrayFormat){case"index":return y=>(b,w)=>{const g=b.length;return w===void 0||f.skipNull&&w===null||f.skipEmptyString&&w===""?b:w===null?[...b,[S(y,f),"[",g,"]"].join("")]:[...b,[S(y,f),"[",S(g,f),"]=",S(w,f)].join("")]};case"bracket":return y=>(b,w)=>w===void 0||f.skipNull&&w===null||f.skipEmptyString&&w===""?b:w===null?[...b,[S(y,f),"[]"].join("")]:[...b,[S(y,f),"[]=",S(w,f)].join("")];case"colon-list-separator":return y=>(b,w)=>w===void 0||f.skipNull&&w===null||f.skipEmptyString&&w===""?b:w===null?[...b,[S(y,f),":list="].join("")]:[...b,[S(y,f),":list=",S(w,f)].join("")];case"comma":case"separator":case"bracket-separator":{const y=f.arrayFormat==="bracket-separator"?"[]=":"=";return b=>(w,g)=>g===void 0||f.skipNull&&g===null||f.skipEmptyString&&g===""?w:(g=g===null?"":g,w.length===0?[[S(b,f),y,S(g,f)].join("")]:[[w,S(g,f)].join(f.arrayFormatSeparator)])}default:return y=>(b,w)=>w===void 0||f.skipNull&&w===null||f.skipEmptyString&&w===""?b:w===null?[...b,S(y,f)]:[...b,[S(y,f),"=",S(w,f)].join("")]}}function P(f){let y;switch(f.arrayFormat){case"index":return(b,w,g)=>{if(y=/\[(\d*)\]$/.exec(b),b=b.replace(/\[\d*\]$/,""),!y){g[b]=w;return}g[b]===void 0&&(g[b]={}),g[b][y[1]]=w};case"bracket":return(b,w,g)=>{if(y=/(\[\])$/.exec(b),b=b.replace(/\[\]$/,""),!y){g[b]=w;return}if(g[b]===void 0){g[b]=[w];return}g[b]=[].concat(g[b],w)};case"colon-list-separator":return(b,w,g)=>{if(y=/(:list)$/.exec(b),b=b.replace(/:list$/,""),!y){g[b]=w;return}if(g[b]===void 0){g[b]=[w];return}g[b]=[].concat(g[b],w)};case"comma":case"separator":return(b,w,g)=>{const C=typeof w=="string"&&w.includes(f.arrayFormatSeparator),R=typeof w=="string"&&!C&&A(w,f).includes(f.arrayFormatSeparator);w=R?A(w,f):w;const X=C||R?w.split(f.arrayFormatSeparator).map(oe=>A(oe,f)):w===null?w:A(w,f);g[b]=X};case"bracket-separator":return(b,w,g)=>{const C=/(\[\])$/.test(b);if(b=b.replace(/\[\]$/,""),!C){g[b]=w&&A(w,f);return}const R=w===null?[]:w.split(f.arrayFormatSeparator).map(X=>A(X,f));if(g[b]===void 0){g[b]=R;return}g[b]=[].concat(g[b],R)};default:return(b,w,g)=>{if(g[b]===void 0){g[b]=w;return}g[b]=[].concat(g[b],w)}}}function _(f){if(typeof f!="string"||f.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function S(f,y){return y.encode?y.strict?t(f):encodeURIComponent(f):f}function A(f,y){return y.decode?r(f):f}function j(f){return Array.isArray(f)?f.sort():typeof f=="object"?j(Object.keys(f)).sort((y,b)=>Number(y)-Number(b)).map(y=>f[y]):f}function B(f){const y=f.indexOf("#");return y!==-1&&(f=f.slice(0,y)),f}function L(f){let y="";const b=f.indexOf("#");return b!==-1&&(y=f.slice(b)),y}function J(f){f=B(f);const y=f.indexOf("?");return y===-1?"":f.slice(y+1)}function se(f,y){return y.parseNumbers&&!Number.isNaN(Number(f))&&typeof f=="string"&&f.trim()!==""?f=Number(f):y.parseBooleans&&f!==null&&(f.toLowerCase()==="true"||f.toLowerCase()==="false")&&(f=f.toLowerCase()==="true"),f}function he(f,y){y=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},y),_(y.arrayFormatSeparator);const b=P(y),w=Object.create(null);if(typeof f!="string"||(f=f.trim().replace(/^[?#&]/,""),!f))return w;for(const g of f.split("&")){if(g==="")continue;let[C,R]=s(y.decode?g.replace(/\+/g," "):g,"=");R=R===void 0?null:["comma","separator","bracket-separator"].includes(y.arrayFormat)?R:A(R,y),b(A(C,y),R,w)}for(const g of Object.keys(w)){const C=w[g];if(typeof C=="object"&&C!==null)for(const R of Object.keys(C))C[R]=se(C[R],y);else w[g]=se(C,y)}return y.sort===!1?w:(y.sort===!0?Object.keys(w).sort():Object.keys(w).sort(y.sort)).reduce((g,C)=>{const R=w[C];return R&&typeof R=="object"&&!Array.isArray(R)?g[C]=j(R):g[C]=R,g},Object.create(null))}n.extract=J,n.parse=he,n.stringify=(f,y)=>{if(!f)return"";y=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},y),_(y.arrayFormatSeparator);const b=R=>y.skipNull&&h(f[R])||y.skipEmptyString&&f[R]==="",w=v(y),g={};for(const R of Object.keys(f))b(R)||(g[R]=f[R]);const C=Object.keys(g);return y.sort!==!1&&C.sort(y.sort),C.map(R=>{const X=f[R];return X===void 0?"":X===null?S(R,y):Array.isArray(X)?X.length===0&&y.arrayFormat==="bracket-separator"?S(R,y)+"[]":X.reduce(w(R),[]).join("&"):S(R,y)+"="+S(X,y)}).filter(R=>R.length>0).join("&")},n.parseUrl=(f,y)=>{y=Object.assign({decode:!0},y);const[b,w]=s(f,"#");return Object.assign({url:b.split("?")[0]||"",query:he(J(f),y)},y&&y.parseFragmentIdentifier&&w?{fragmentIdentifier:A(w,y)}:{})},n.stringifyUrl=(f,y)=>{y=Object.assign({encode:!0,strict:!0,[d]:!0},y);const b=B(f.url).split("?")[0]||"",w=n.extract(f.url),g=n.parse(w,{sort:!1}),C=Object.assign(g,f.query);let R=n.stringify(C,y);R&&(R=`?${R}`);let X=L(f.url);return f.fragmentIdentifier&&(X=`#${y[d]?S(f.fragmentIdentifier,y):f.fragmentIdentifier}`),`${b}${R}${X}`},n.pick=(f,y,b)=>{b=Object.assign({parseFragmentIdentifier:!0,[d]:!1},b);const{url:w,query:g,fragmentIdentifier:C}=n.parseUrl(f,b);return n.stringifyUrl({url:w,query:a(g,y),fragmentIdentifier:C},b)},n.exclude=(f,y,b)=>{const w=Array.isArray(y)?g=>!y.includes(g):(g,C)=>!y(g,C);return n.pick(f,w,b)}})(AS);const RS=":";function TS(n){const[t,r]=n.split(RS);return{namespace:t,reference:r}}function Ic(n=[],t=[]){return[...new Set([...n,...t])]}function au(n){return n.includes(":")}function is(n){return au(n)?n.split(":")[0]:n}const NS={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function vf(n,t){const{message:r,code:s}=NS[n];return{message:t?`${r} ${t}`:r,code:s}}function wf(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function CS(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}var Lc={exports:{}};(function(n,t){var r=typeof self<"u"?self:Br,s=function(){function h(){this.fetch=!1,this.DOMException=r.DOMException}return h.prototype=r,new h}();(function(h){(function(d){var v={searchParams:"URLSearchParams"in h,iterable:"Symbol"in h&&"iterator"in Symbol,blob:"FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in h,arrayBuffer:"ArrayBuffer"in h};function P(I){return I&&DataView.prototype.isPrototypeOf(I)}if(v.arrayBuffer)var _=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],S=ArrayBuffer.isView||function(I){return I&&_.indexOf(Object.prototype.toString.call(I))>-1};function A(I){if(typeof I!="string"&&(I=String(I)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(I))throw new TypeError("Invalid character in header field name");return I.toLowerCase()}function j(I){return typeof I!="string"&&(I=String(I)),I}function B(I){var N={next:function(){var ie=I.shift();return{done:ie===void 0,value:ie}}};return v.iterable&&(N[Symbol.iterator]=function(){return N}),N}function L(I){this.map={},I instanceof L?I.forEach(function(N,ie){this.append(ie,N)},this):Array.isArray(I)?I.forEach(function(N){this.append(N[0],N[1])},this):I&&Object.getOwnPropertyNames(I).forEach(function(N){this.append(N,I[N])},this)}L.prototype.append=function(I,N){I=A(I),N=j(N);var ie=this.map[I];this.map[I]=ie?ie+", "+N:N},L.prototype.delete=function(I){delete this.map[A(I)]},L.prototype.get=function(I){return I=A(I),this.has(I)?this.map[I]:null},L.prototype.has=function(I){return this.map.hasOwnProperty(A(I))},L.prototype.set=function(I,N){this.map[A(I)]=j(N)},L.prototype.forEach=function(I,N){for(var ie in this.map)this.map.hasOwnProperty(ie)&&I.call(N,this.map[ie],ie,this)},L.prototype.keys=function(){var I=[];return this.forEach(function(N,ie){I.push(ie)}),B(I)},L.prototype.values=function(){var I=[];return this.forEach(function(N){I.push(N)}),B(I)},L.prototype.entries=function(){var I=[];return this.forEach(function(N,ie){I.push([ie,N])}),B(I)},v.iterable&&(L.prototype[Symbol.iterator]=L.prototype.entries);function J(I){if(I.bodyUsed)return Promise.reject(new TypeError("Already read"));I.bodyUsed=!0}function se(I){return new Promise(function(N,ie){I.onload=function(){N(I.result)},I.onerror=function(){ie(I.error)}})}function he(I){var N=new FileReader,ie=se(N);return N.readAsArrayBuffer(I),ie}function f(I){var N=new FileReader,ie=se(N);return N.readAsText(I),ie}function y(I){for(var N=new Uint8Array(I),ie=new Array(N.length),pe=0;pe<N.length;pe++)ie[pe]=String.fromCharCode(N[pe]);return ie.join("")}function b(I){if(I.slice)return I.slice(0);var N=new Uint8Array(I.byteLength);return N.set(new Uint8Array(I)),N.buffer}function w(){return this.bodyUsed=!1,this._initBody=function(I){this._bodyInit=I,I?typeof I=="string"?this._bodyText=I:v.blob&&Blob.prototype.isPrototypeOf(I)?this._bodyBlob=I:v.formData&&FormData.prototype.isPrototypeOf(I)?this._bodyFormData=I:v.searchParams&&URLSearchParams.prototype.isPrototypeOf(I)?this._bodyText=I.toString():v.arrayBuffer&&v.blob&&P(I)?(this._bodyArrayBuffer=b(I.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):v.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(I)||S(I))?this._bodyArrayBuffer=b(I):this._bodyText=I=Object.prototype.toString.call(I):this._bodyText="",this.headers.get("content-type")||(typeof I=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):v.searchParams&&URLSearchParams.prototype.isPrototypeOf(I)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},v.blob&&(this.blob=function(){var I=J(this);if(I)return I;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?J(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(he)}),this.text=function(){var I=J(this);if(I)return I;if(this._bodyBlob)return f(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(y(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},v.formData&&(this.formData=function(){return this.text().then(X)}),this.json=function(){return this.text().then(JSON.parse)},this}var g=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function C(I){var N=I.toUpperCase();return g.indexOf(N)>-1?N:I}function R(I,N){N=N||{};var ie=N.body;if(I instanceof R){if(I.bodyUsed)throw new TypeError("Already read");this.url=I.url,this.credentials=I.credentials,N.headers||(this.headers=new L(I.headers)),this.method=I.method,this.mode=I.mode,this.signal=I.signal,!ie&&I._bodyInit!=null&&(ie=I._bodyInit,I.bodyUsed=!0)}else this.url=String(I);if(this.credentials=N.credentials||this.credentials||"same-origin",(N.headers||!this.headers)&&(this.headers=new L(N.headers)),this.method=C(N.method||this.method||"GET"),this.mode=N.mode||this.mode||null,this.signal=N.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ie)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ie)}R.prototype.clone=function(){return new R(this,{body:this._bodyInit})};function X(I){var N=new FormData;return I.trim().split("&").forEach(function(ie){if(ie){var pe=ie.split("="),Y=pe.shift().replace(/\+/g," "),W=pe.join("=").replace(/\+/g," ");N.append(decodeURIComponent(Y),decodeURIComponent(W))}}),N}function oe(I){var N=new L,ie=I.replace(/\r?\n[\t ]+/g," ");return ie.split(/\r?\n/).forEach(function(pe){var Y=pe.split(":"),W=Y.shift().trim();if(W){var Q=Y.join(":").trim();N.append(W,Q)}}),N}w.call(R.prototype);function ge(I,N){N||(N={}),this.type="default",this.status=N.status===void 0?200:N.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in N?N.statusText:"OK",this.headers=new L(N.headers),this.url=N.url||"",this._initBody(I)}w.call(ge.prototype),ge.prototype.clone=function(){return new ge(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new L(this.headers),url:this.url})},ge.error=function(){var I=new ge(null,{status:0,statusText:""});return I.type="error",I};var Ne=[301,302,303,307,308];ge.redirect=function(I,N){if(Ne.indexOf(N)===-1)throw new RangeError("Invalid status code");return new ge(null,{status:N,headers:{location:I}})},d.DOMException=h.DOMException;try{new d.DOMException}catch{d.DOMException=function(N,ie){this.message=N,this.name=ie;var pe=Error(N);this.stack=pe.stack},d.DOMException.prototype=Object.create(Error.prototype),d.DOMException.prototype.constructor=d.DOMException}function qe(I,N){return new Promise(function(ie,pe){var Y=new R(I,N);if(Y.signal&&Y.signal.aborted)return pe(new d.DOMException("Aborted","AbortError"));var W=new XMLHttpRequest;function Q(){W.abort()}W.onload=function(){var Z={status:W.status,statusText:W.statusText,headers:oe(W.getAllResponseHeaders()||"")};Z.url="responseURL"in W?W.responseURL:Z.headers.get("X-Request-URL");var Je="response"in W?W.response:W.responseText;ie(new ge(Je,Z))},W.onerror=function(){pe(new TypeError("Network request failed"))},W.ontimeout=function(){pe(new TypeError("Network request failed"))},W.onabort=function(){pe(new d.DOMException("Aborted","AbortError"))},W.open(Y.method,Y.url,!0),Y.credentials==="include"?W.withCredentials=!0:Y.credentials==="omit"&&(W.withCredentials=!1),"responseType"in W&&v.blob&&(W.responseType="blob"),Y.headers.forEach(function(Z,Je){W.setRequestHeader(Je,Z)}),Y.signal&&(Y.signal.addEventListener("abort",Q),W.onreadystatechange=function(){W.readyState===4&&Y.signal.removeEventListener("abort",Q)}),W.send(typeof Y._bodyInit>"u"?null:Y._bodyInit)})}return qe.polyfill=!0,h.fetch||(h.fetch=qe,h.Headers=L,h.Request=R,h.Response=ge),d.Headers=L,d.Request=R,d.Response=ge,d.fetch=qe,Object.defineProperty(d,"__esModule",{value:!0}),d})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var a=s;t=a.fetch,t.default=a.fetch,t.fetch=a.fetch,t.Headers=a.Headers,t.Request=a.Request,t.Response=a.Response,n.exports=t})(Lc,Lc.exports);var $S=Lc.exports;const bf=jf($S),DS={Accept:"application/json","Content-Type":"application/json"},FS="POST",_f={headers:DS,method:FS},Ef=10;class Ni{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new $r.EventEmitter,this.isAvailable=!1,this.registering=!1,!Vl(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,r){this.isAvailable||await this.register();try{const s=Ji(t),h=await(await bf(this.url,Object.assign(Object.assign({},_f),{body:s}))).json();this.onPayload({data:h})}catch(s){this.onError(t.id,s)}}async register(t=this.url){if(!Vl(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),a(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return a(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=Ji({id:1,jsonrpc:"2.0",method:"test",params:[]});await bf(t,Object.assign(Object.assign({},_f),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?hs(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),h=Uo(t,a);this.events.emit("payload",h)}parseError(t,r=this.url){return cd(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Ef&&this.events.setMaxListeners(Ef)}}const If="error",US="wss://relay.walletconnect.com",jS="wc",LS="universal_provider",Sf=`${jS}@2:${LS}:`,MS="https://rpc.walletconnect.com/v1/",yi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ts=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Mc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,t){(function(){var r,s="4.17.21",a=200,h="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",v="Invalid `variable` option passed into `_.template`",P="__lodash_hash_undefined__",_=500,S="__lodash_placeholder__",A=1,j=2,B=4,L=1,J=2,se=1,he=2,f=4,y=8,b=16,w=32,g=64,C=128,R=256,X=512,oe=30,ge="...",Ne=800,qe=16,I=1,N=2,ie=3,pe=1/0,Y=9007199254740991,W=17976931348623157e292,Q=0/0,Z=4294967295,Je=Z-1,Be=Z>>>1,kr=[["ary",C],["bind",se],["bindKey",he],["curry",y],["curryRight",b],["flip",X],["partial",w],["partialRight",g],["rearg",R]],Ie="[object Arguments]",It="[object Array]",z="[object AsyncFunction]",q="[object Boolean]",U="[object Date]",u="[object DOMException]",T="[object Error]",ae="[object Function]",ye="[object GeneratorFunction]",_e="[object Map]",Ce="[object Number]",De="[object Null]",Pe="[object Object]",St="[object Promise]",vt="[object Proxy]",ot="[object RegExp]",Ue="[object Set]",Ye="[object String]",Xe="[object Symbol]",at="[object Undefined]",ze="[object WeakMap]",Ze="[object WeakSet]",$e="[object ArrayBuffer]",ke="[object DataView]",ht="[object Float32Array]",Le="[object Float64Array]",xt="[object Int8Array]",Dt="[object Int16Array]",Bt="[object Int32Array]",kt="[object Uint8Array]",jt="[object Uint8ClampedArray]",Qt="[object Uint16Array]",or="[object Uint32Array]",Kr=/\b__p \+= '';/g,Yt=/\b(__p \+=) '' \+/g,Xr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,mi=/&(?:amp|lt|gt|quot|#39);/g,Ci=/[&<>"']/g,lt=RegExp(mi.source),rt=RegExp(Ci.source),ft=/<%-([\s\S]+?)%>/g,dt=/<%([\s\S]+?)%>/g,ct=/<%=([\s\S]+?)%>/g,it=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Pt=/^\w*$/,Ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,pt=/[\\^$.*+?()[\]{}|]/g,At=RegExp(pt.source),gt=/^\s+/,wt=/\s/,yt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qe=/\{\n\/\* \[wrapped with (.+)\] \*/,Rt=/,? & /,Tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,qo=/[()=,{}\[\]\/\s]/,zo=/\\(\\)?/g,Ho=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ir=/\w*$/,Bo=/^[-+]0x[0-9a-f]+$/i,ko=/^0b[01]+$/i,Ko=/^\[object .+?Constructor\]$/,Vo=/^0o[0-7]+$/i,Wo=/^(?:0|[1-9]\d*)$/,Zr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,en=/($^)/,Go=/['\n\r\u2028\u2029\\]/g,tn="\\ud800-\\udfff",Jo="\\u0300-\\u036f",Qo="\\ufe20-\\ufe2f",rn="\\u20d0-\\u20ff",gs=Jo+Qo+rn,ys="\\u2700-\\u27bf",Dr="a-z\\xdf-\\xf6\\xf8-\\xff",Yo="\\xac\\xb1\\xd7\\xf7",Xo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Zo="\\u2000-\\u206f",ea=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ms="A-Z\\xc0-\\xd6\\xd8-\\xde",vs="\\ufe0e\\ufe0f",$i=Yo+Xo+Zo+ea,Tn="['’]",Di="["+tn+"]",Nn="["+$i+"]",Fi="["+gs+"]",ws="\\d+",ta="["+ys+"]",bs="["+Dr+"]",_s="[^"+tn+$i+ws+ys+Dr+ms+"]",nn="\\ud83c[\\udffb-\\udfff]",ra="(?:"+Fi+"|"+nn+")",Es="[^"+tn+"]",sn="(?:\\ud83c[\\udde6-\\uddff]){2}",vi="[\\ud800-\\udbff][\\udc00-\\udfff]",yr="["+ms+"]",Is="\\u200d",Ss="(?:"+bs+"|"+_s+")",Vr="(?:"+yr+"|"+_s+")",xs="(?:"+Tn+"(?:d|ll|m|re|s|t|ve))?",Ps="(?:"+Tn+"(?:D|LL|M|RE|S|T|VE))?",Os=ra+"?",As="["+vs+"]?",ia="(?:"+Is+"(?:"+[Es,sn,vi].join("|")+")"+As+Os+")*",ei="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Rs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ts=As+Os+ia,on="(?:"+[ta,sn,vi].join("|")+")"+Ts,na="(?:"+[Es+Fi+"?",Fi,sn,vi,Di].join("|")+")",Cn=RegExp(Tn,"g"),sa=RegExp(Fi,"g"),an=RegExp(nn+"(?="+nn+")|"+na+Ts,"g"),Ns=RegExp([yr+"?"+bs+"+"+xs+"(?="+[Nn,yr,"$"].join("|")+")",Vr+"+"+Ps+"(?="+[Nn,yr+Ss,"$"].join("|")+")",yr+"?"+Ss+"+"+xs,yr+"+"+Ps,Rs,ei,ws,on].join("|"),"g"),Cs=RegExp("["+Is+tn+gs+vs+"]"),Ui=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,$s=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],oa=-1,Ke={};Ke[ht]=Ke[Le]=Ke[xt]=Ke[Dt]=Ke[Bt]=Ke[kt]=Ke[jt]=Ke[Qt]=Ke[or]=!0,Ke[Ie]=Ke[It]=Ke[$e]=Ke[q]=Ke[ke]=Ke[U]=Ke[T]=Ke[ae]=Ke[_e]=Ke[Ce]=Ke[Pe]=Ke[ot]=Ke[Ue]=Ke[Ye]=Ke[ze]=!1;var He={};He[Ie]=He[It]=He[$e]=He[ke]=He[q]=He[U]=He[ht]=He[Le]=He[xt]=He[Dt]=He[Bt]=He[_e]=He[Ce]=He[Pe]=He[ot]=He[Ue]=He[Ye]=He[Xe]=He[kt]=He[jt]=He[Qt]=He[or]=!0,He[T]=He[ae]=He[ze]=!1;var E={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},$={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},V={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},re={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ve=parseFloat,ve=parseInt,et=typeof ts=="object"&&ts&&ts.Object===Object&&ts,Nt=typeof self=="object"&&self&&self.Object===Object&&self,Ae=et||Nt||Function("return this")(),We=t&&!t.nodeType&&t,bt=We&&!0&&n&&!n.nodeType&&n,ar=bt&&bt.exports===We,Ct=ar&&et.process,tt=function(){try{var D=bt&&bt.require&&bt.require("util").types;return D||Ct&&Ct.binding&&Ct.binding("util")}catch{}}(),Xt=tt&&tt.isArrayBuffer,Fr=tt&&tt.isDate,Sr=tt&&tt.isMap,Wr=tt&&tt.isRegExp,$n=tt&&tt.isSet,ji=tt&&tt.isTypedArray;function Lt(D,H,M){switch(M.length){case 0:return D.call(H);case 1:return D.call(H,M[0]);case 2:return D.call(H,M[0],M[1]);case 3:return D.call(H,M[0],M[1],M[2])}return D.apply(H,M)}function Dd(D,H,M,ne){for(var me=-1,Fe=D==null?0:D.length;++me<Fe;){var Ft=D[me];H(ne,Ft,M(Ft),D)}return ne}function xr(D,H){for(var M=-1,ne=D==null?0:D.length;++M<ne&&H(D[M],M,D)!==!1;);return D}function Fd(D,H){for(var M=D==null?0:D.length;M--&&H(D[M],M,D)!==!1;);return D}function hu(D,H){for(var M=-1,ne=D==null?0:D.length;++M<ne;)if(!H(D[M],M,D))return!1;return!0}function wi(D,H){for(var M=-1,ne=D==null?0:D.length,me=0,Fe=[];++M<ne;){var Ft=D[M];H(Ft,M,D)&&(Fe[me++]=Ft)}return Fe}function Ds(D,H){var M=D==null?0:D.length;return!!M&&cn(D,H,0)>-1}function aa(D,H,M){for(var ne=-1,me=D==null?0:D.length;++ne<me;)if(M(H,D[ne]))return!0;return!1}function nt(D,H){for(var M=-1,ne=D==null?0:D.length,me=Array(ne);++M<ne;)me[M]=H(D[M],M,D);return me}function bi(D,H){for(var M=-1,ne=H.length,me=D.length;++M<ne;)D[me+M]=H[M];return D}function ca(D,H,M,ne){var me=-1,Fe=D==null?0:D.length;for(ne&&Fe&&(M=D[++me]);++me<Fe;)M=H(M,D[me],me,D);return M}function Ud(D,H,M,ne){var me=D==null?0:D.length;for(ne&&me&&(M=D[--me]);me--;)M=H(M,D[me],me,D);return M}function ua(D,H){for(var M=-1,ne=D==null?0:D.length;++M<ne;)if(H(D[M],M,D))return!0;return!1}var jd=ha("length");function Ld(D){return D.split("")}function Md(D){return D.match(Tt)||[]}function lu(D,H,M){var ne;return M(D,function(me,Fe,Ft){if(H(me,Fe,Ft))return ne=Fe,!1}),ne}function Fs(D,H,M,ne){for(var me=D.length,Fe=M+(ne?1:-1);ne?Fe--:++Fe<me;)if(H(D[Fe],Fe,D))return Fe;return-1}function cn(D,H,M){return H===H?Yd(D,H,M):Fs(D,fu,M)}function qd(D,H,M,ne){for(var me=M-1,Fe=D.length;++me<Fe;)if(ne(D[me],H))return me;return-1}function fu(D){return D!==D}function du(D,H){var M=D==null?0:D.length;return M?fa(D,H)/M:Q}function ha(D){return function(H){return H==null?r:H[D]}}function la(D){return function(H){return D==null?r:D[H]}}function pu(D,H,M,ne,me){return me(D,function(Fe,Ft,Ge){M=ne?(ne=!1,Fe):H(M,Fe,Ft,Ge)}),M}function zd(D,H){var M=D.length;for(D.sort(H);M--;)D[M]=D[M].value;return D}function fa(D,H){for(var M,ne=-1,me=D.length;++ne<me;){var Fe=H(D[ne]);Fe!==r&&(M=M===r?Fe:M+Fe)}return M}function da(D,H){for(var M=-1,ne=Array(D);++M<D;)ne[M]=H(M);return ne}function Hd(D,H){return nt(H,function(M){return[M,D[M]]})}function gu(D){return D&&D.slice(0,wu(D)+1).replace(gt,"")}function mr(D){return function(H){return D(H)}}function pa(D,H){return nt(H,function(M){return D[M]})}function Dn(D,H){return D.has(H)}function yu(D,H){for(var M=-1,ne=D.length;++M<ne&&cn(H,D[M],0)>-1;);return M}function mu(D,H){for(var M=D.length;M--&&cn(H,D[M],0)>-1;);return M}function Bd(D,H){for(var M=D.length,ne=0;M--;)D[M]===H&&++ne;return ne}var kd=la(E),Kd=la($);function Vd(D){return"\\"+re[D]}function Wd(D,H){return D==null?r:D[H]}function un(D){return Cs.test(D)}function Gd(D){return Ui.test(D)}function Jd(D){for(var H,M=[];!(H=D.next()).done;)M.push(H.value);return M}function ga(D){var H=-1,M=Array(D.size);return D.forEach(function(ne,me){M[++H]=[me,ne]}),M}function vu(D,H){return function(M){return D(H(M))}}function _i(D,H){for(var M=-1,ne=D.length,me=0,Fe=[];++M<ne;){var Ft=D[M];(Ft===H||Ft===S)&&(D[M]=S,Fe[me++]=M)}return Fe}function Us(D){var H=-1,M=Array(D.size);return D.forEach(function(ne){M[++H]=ne}),M}function Qd(D){var H=-1,M=Array(D.size);return D.forEach(function(ne){M[++H]=[ne,ne]}),M}function Yd(D,H,M){for(var ne=M-1,me=D.length;++ne<me;)if(D[ne]===H)return ne;return-1}function Xd(D,H,M){for(var ne=M+1;ne--;)if(D[ne]===H)return ne;return ne}function hn(D){return un(D)?ep(D):jd(D)}function Ur(D){return un(D)?tp(D):Ld(D)}function wu(D){for(var H=D.length;H--&&wt.test(D.charAt(H)););return H}var Zd=la(V);function ep(D){for(var H=an.lastIndex=0;an.test(D);)++H;return H}function tp(D){return D.match(an)||[]}function rp(D){return D.match(Ns)||[]}var ip=function D(H){H=H==null?Ae:ln.defaults(Ae.Object(),H,ln.pick(Ae,$s));var M=H.Array,ne=H.Date,me=H.Error,Fe=H.Function,Ft=H.Math,Ge=H.Object,ya=H.RegExp,np=H.String,Pr=H.TypeError,js=M.prototype,sp=Fe.prototype,fn=Ge.prototype,Ls=H["__core-js_shared__"],Ms=sp.toString,Me=fn.hasOwnProperty,op=0,bu=function(){var e=/[^.]+$/.exec(Ls&&Ls.keys&&Ls.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),qs=fn.toString,ap=Ms.call(Ge),cp=Ae._,up=ya("^"+Ms.call(Me).replace(pt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zs=ar?H.Buffer:r,Ei=H.Symbol,Hs=H.Uint8Array,_u=zs?zs.allocUnsafe:r,Bs=vu(Ge.getPrototypeOf,Ge),Eu=Ge.create,Iu=fn.propertyIsEnumerable,ks=js.splice,Su=Ei?Ei.isConcatSpreadable:r,Fn=Ei?Ei.iterator:r,Li=Ei?Ei.toStringTag:r,Ks=function(){try{var e=Bi(Ge,"defineProperty");return e({},"",{}),e}catch{}}(),hp=H.clearTimeout!==Ae.clearTimeout&&H.clearTimeout,lp=ne&&ne.now!==Ae.Date.now&&ne.now,fp=H.setTimeout!==Ae.setTimeout&&H.setTimeout,Vs=Ft.ceil,Ws=Ft.floor,ma=Ge.getOwnPropertySymbols,dp=zs?zs.isBuffer:r,xu=H.isFinite,pp=js.join,gp=vu(Ge.keys,Ge),Ut=Ft.max,Wt=Ft.min,yp=ne.now,mp=H.parseInt,Pu=Ft.random,vp=js.reverse,va=Bi(H,"DataView"),Un=Bi(H,"Map"),wa=Bi(H,"Promise"),dn=Bi(H,"Set"),jn=Bi(H,"WeakMap"),Ln=Bi(Ge,"create"),Gs=jn&&new jn,pn={},wp=ki(va),bp=ki(Un),_p=ki(wa),Ep=ki(dn),Ip=ki(jn),Js=Ei?Ei.prototype:r,Mn=Js?Js.valueOf:r,Ou=Js?Js.toString:r;function p(e){if(mt(e)&&!we(e)&&!(e instanceof Oe)){if(e instanceof Or)return e;if(Me.call(e,"__wrapped__"))return Ah(e)}return new Or(e)}var gn=function(){function e(){}return function(i){if(!ut(i))return{};if(Eu)return Eu(i);e.prototype=i;var o=new e;return e.prototype=r,o}}();function Qs(){}function Or(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}p.templateSettings={escape:ft,evaluate:dt,interpolate:ct,variable:"",imports:{_:p}},p.prototype=Qs.prototype,p.prototype.constructor=p,Or.prototype=gn(Qs.prototype),Or.prototype.constructor=Or;function Oe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Z,this.__views__=[]}function Sp(){var e=new Oe(this.__wrapped__);return e.__actions__=cr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=cr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=cr(this.__views__),e}function xp(){if(this.__filtered__){var e=new Oe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Pp(){var e=this.__wrapped__.value(),i=this.__dir__,o=we(e),c=i<0,l=o?e.length:0,m=Lg(0,l,this.__views__),x=m.start,O=m.end,F=O-x,k=c?O:x-1,K=this.__iteratees__,G=K.length,te=0,ce=Wt(F,this.__takeCount__);if(!o||!c&&l==F&&ce==F)return Yu(e,this.__actions__);var fe=[];e:for(;F--&&te<ce;){k+=i;for(var Ee=-1,de=e[k];++Ee<G;){var xe=K[Ee],Re=xe.iteratee,br=xe.type,tr=Re(de);if(br==N)de=tr;else if(!tr){if(br==I)continue e;break e}}fe[te++]=de}return fe}Oe.prototype=gn(Qs.prototype),Oe.prototype.constructor=Oe;function Mi(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function Op(){this.__data__=Ln?Ln(null):{},this.size=0}function Ap(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function Rp(e){var i=this.__data__;if(Ln){var o=i[e];return o===P?r:o}return Me.call(i,e)?i[e]:r}function Tp(e){var i=this.__data__;return Ln?i[e]!==r:Me.call(i,e)}function Np(e,i){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=Ln&&i===r?P:i,this}Mi.prototype.clear=Op,Mi.prototype.delete=Ap,Mi.prototype.get=Rp,Mi.prototype.has=Tp,Mi.prototype.set=Np;function ti(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function Cp(){this.__data__=[],this.size=0}function $p(e){var i=this.__data__,o=Ys(i,e);if(o<0)return!1;var c=i.length-1;return o==c?i.pop():ks.call(i,o,1),--this.size,!0}function Dp(e){var i=this.__data__,o=Ys(i,e);return o<0?r:i[o][1]}function Fp(e){return Ys(this.__data__,e)>-1}function Up(e,i){var o=this.__data__,c=Ys(o,e);return c<0?(++this.size,o.push([e,i])):o[c][1]=i,this}ti.prototype.clear=Cp,ti.prototype.delete=$p,ti.prototype.get=Dp,ti.prototype.has=Fp,ti.prototype.set=Up;function ri(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function jp(){this.size=0,this.__data__={hash:new Mi,map:new(Un||ti),string:new Mi}}function Lp(e){var i=uo(this,e).delete(e);return this.size-=i?1:0,i}function Mp(e){return uo(this,e).get(e)}function qp(e){return uo(this,e).has(e)}function zp(e,i){var o=uo(this,e),c=o.size;return o.set(e,i),this.size+=o.size==c?0:1,this}ri.prototype.clear=jp,ri.prototype.delete=Lp,ri.prototype.get=Mp,ri.prototype.has=qp,ri.prototype.set=zp;function qi(e){var i=-1,o=e==null?0:e.length;for(this.__data__=new ri;++i<o;)this.add(e[i])}function Hp(e){return this.__data__.set(e,P),this}function Bp(e){return this.__data__.has(e)}qi.prototype.add=qi.prototype.push=Hp,qi.prototype.has=Bp;function jr(e){var i=this.__data__=new ti(e);this.size=i.size}function kp(){this.__data__=new ti,this.size=0}function Kp(e){var i=this.__data__,o=i.delete(e);return this.size=i.size,o}function Vp(e){return this.__data__.get(e)}function Wp(e){return this.__data__.has(e)}function Gp(e,i){var o=this.__data__;if(o instanceof ti){var c=o.__data__;if(!Un||c.length<a-1)return c.push([e,i]),this.size=++o.size,this;o=this.__data__=new ri(c)}return o.set(e,i),this.size=o.size,this}jr.prototype.clear=kp,jr.prototype.delete=Kp,jr.prototype.get=Vp,jr.prototype.has=Wp,jr.prototype.set=Gp;function Au(e,i){var o=we(e),c=!o&&Ki(e),l=!o&&!c&&Oi(e),m=!o&&!c&&!l&&wn(e),x=o||c||l||m,O=x?da(e.length,np):[],F=O.length;for(var k in e)(i||Me.call(e,k))&&!(x&&(k=="length"||l&&(k=="offset"||k=="parent")||m&&(k=="buffer"||k=="byteLength"||k=="byteOffset")||oi(k,F)))&&O.push(k);return O}function Ru(e){var i=e.length;return i?e[Ta(0,i-1)]:r}function Jp(e,i){return ho(cr(e),zi(i,0,e.length))}function Qp(e){return ho(cr(e))}function ba(e,i,o){(o!==r&&!Lr(e[i],o)||o===r&&!(i in e))&&ii(e,i,o)}function qn(e,i,o){var c=e[i];(!(Me.call(e,i)&&Lr(c,o))||o===r&&!(i in e))&&ii(e,i,o)}function Ys(e,i){for(var o=e.length;o--;)if(Lr(e[o][0],i))return o;return-1}function Yp(e,i,o,c){return Ii(e,function(l,m,x){i(c,l,o(l),x)}),c}function Tu(e,i){return e&&Jr(i,Mt(i),e)}function Xp(e,i){return e&&Jr(i,hr(i),e)}function ii(e,i,o){i=="__proto__"&&Ks?Ks(e,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[i]=o}function _a(e,i){for(var o=-1,c=i.length,l=M(c),m=e==null;++o<c;)l[o]=m?r:tc(e,i[o]);return l}function zi(e,i,o){return e===e&&(o!==r&&(e=e<=o?e:o),i!==r&&(e=e>=i?e:i)),e}function Ar(e,i,o,c,l,m){var x,O=i&A,F=i&j,k=i&B;if(o&&(x=l?o(e,c,l,m):o(e)),x!==r)return x;if(!ut(e))return e;var K=we(e);if(K){if(x=qg(e),!O)return cr(e,x)}else{var G=Gt(e),te=G==ae||G==ye;if(Oi(e))return eh(e,O);if(G==Pe||G==Ie||te&&!l){if(x=F||te?{}:wh(e),!O)return F?Rg(e,Xp(x,e)):Ag(e,Tu(x,e))}else{if(!He[G])return l?e:{};x=zg(e,G,O)}}m||(m=new jr);var ce=m.get(e);if(ce)return ce;m.set(e,x),Gh(e)?e.forEach(function(de){x.add(Ar(de,i,o,de,e,m))}):Vh(e)&&e.forEach(function(de,xe){x.set(xe,Ar(de,i,o,xe,e,m))});var fe=k?F?za:qa:F?hr:Mt,Ee=K?r:fe(e);return xr(Ee||e,function(de,xe){Ee&&(xe=de,de=e[xe]),qn(x,xe,Ar(de,i,o,xe,e,m))}),x}function Zp(e){var i=Mt(e);return function(o){return Nu(o,e,i)}}function Nu(e,i,o){var c=o.length;if(e==null)return!c;for(e=Ge(e);c--;){var l=o[c],m=i[l],x=e[l];if(x===r&&!(l in e)||!m(x))return!1}return!0}function Cu(e,i,o){if(typeof e!="function")throw new Pr(d);return Wn(function(){e.apply(r,o)},i)}function zn(e,i,o,c){var l=-1,m=Ds,x=!0,O=e.length,F=[],k=i.length;if(!O)return F;o&&(i=nt(i,mr(o))),c?(m=aa,x=!1):i.length>=a&&(m=Dn,x=!1,i=new qi(i));e:for(;++l<O;){var K=e[l],G=o==null?K:o(K);if(K=c||K!==0?K:0,x&&G===G){for(var te=k;te--;)if(i[te]===G)continue e;F.push(K)}else m(i,G,c)||F.push(K)}return F}var Ii=sh(Gr),$u=sh(Ia,!0);function eg(e,i){var o=!0;return Ii(e,function(c,l,m){return o=!!i(c,l,m),o}),o}function Xs(e,i,o){for(var c=-1,l=e.length;++c<l;){var m=e[c],x=i(m);if(x!=null&&(O===r?x===x&&!wr(x):o(x,O)))var O=x,F=m}return F}function tg(e,i,o,c){var l=e.length;for(o=be(o),o<0&&(o=-o>l?0:l+o),c=c===r||c>l?l:be(c),c<0&&(c+=l),c=o>c?0:Qh(c);o<c;)e[o++]=i;return e}function Du(e,i){var o=[];return Ii(e,function(c,l,m){i(c,l,m)&&o.push(c)}),o}function Kt(e,i,o,c,l){var m=-1,x=e.length;for(o||(o=Bg),l||(l=[]);++m<x;){var O=e[m];i>0&&o(O)?i>1?Kt(O,i-1,o,c,l):bi(l,O):c||(l[l.length]=O)}return l}var Ea=oh(),Fu=oh(!0);function Gr(e,i){return e&&Ea(e,i,Mt)}function Ia(e,i){return e&&Fu(e,i,Mt)}function Zs(e,i){return wi(i,function(o){return ai(e[o])})}function Hi(e,i){i=xi(i,e);for(var o=0,c=i.length;e!=null&&o<c;)e=e[Qr(i[o++])];return o&&o==c?e:r}function Uu(e,i,o){var c=i(e);return we(e)?c:bi(c,o(e))}function Zt(e){return e==null?e===r?at:De:Li&&Li in Ge(e)?jg(e):Qg(e)}function Sa(e,i){return e>i}function rg(e,i){return e!=null&&Me.call(e,i)}function ig(e,i){return e!=null&&i in Ge(e)}function ng(e,i,o){return e>=Wt(i,o)&&e<Ut(i,o)}function xa(e,i,o){for(var c=o?aa:Ds,l=e[0].length,m=e.length,x=m,O=M(m),F=1/0,k=[];x--;){var K=e[x];x&&i&&(K=nt(K,mr(i))),F=Wt(K.length,F),O[x]=!o&&(i||l>=120&&K.length>=120)?new qi(x&&K):r}K=e[0];var G=-1,te=O[0];e:for(;++G<l&&k.length<F;){var ce=K[G],fe=i?i(ce):ce;if(ce=o||ce!==0?ce:0,!(te?Dn(te,fe):c(k,fe,o))){for(x=m;--x;){var Ee=O[x];if(!(Ee?Dn(Ee,fe):c(e[x],fe,o)))continue e}te&&te.push(fe),k.push(ce)}}return k}function sg(e,i,o,c){return Gr(e,function(l,m,x){i(c,o(l),m,x)}),c}function Hn(e,i,o){i=xi(i,e),e=Ih(e,i);var c=e==null?e:e[Qr(Tr(i))];return c==null?r:Lt(c,e,o)}function ju(e){return mt(e)&&Zt(e)==Ie}function og(e){return mt(e)&&Zt(e)==$e}function ag(e){return mt(e)&&Zt(e)==U}function Bn(e,i,o,c,l){return e===i?!0:e==null||i==null||!mt(e)&&!mt(i)?e!==e&&i!==i:cg(e,i,o,c,Bn,l)}function cg(e,i,o,c,l,m){var x=we(e),O=we(i),F=x?It:Gt(e),k=O?It:Gt(i);F=F==Ie?Pe:F,k=k==Ie?Pe:k;var K=F==Pe,G=k==Pe,te=F==k;if(te&&Oi(e)){if(!Oi(i))return!1;x=!0,K=!1}if(te&&!K)return m||(m=new jr),x||wn(e)?yh(e,i,o,c,l,m):Fg(e,i,F,o,c,l,m);if(!(o&L)){var ce=K&&Me.call(e,"__wrapped__"),fe=G&&Me.call(i,"__wrapped__");if(ce||fe){var Ee=ce?e.value():e,de=fe?i.value():i;return m||(m=new jr),l(Ee,de,o,c,m)}}return te?(m||(m=new jr),Ug(e,i,o,c,l,m)):!1}function ug(e){return mt(e)&&Gt(e)==_e}function Pa(e,i,o,c){var l=o.length,m=l,x=!c;if(e==null)return!m;for(e=Ge(e);l--;){var O=o[l];if(x&&O[2]?O[1]!==e[O[0]]:!(O[0]in e))return!1}for(;++l<m;){O=o[l];var F=O[0],k=e[F],K=O[1];if(x&&O[2]){if(k===r&&!(F in e))return!1}else{var G=new jr;if(c)var te=c(k,K,F,e,i,G);if(!(te===r?Bn(K,k,L|J,c,G):te))return!1}}return!0}function Lu(e){if(!ut(e)||Kg(e))return!1;var i=ai(e)?up:Ko;return i.test(ki(e))}function hg(e){return mt(e)&&Zt(e)==ot}function lg(e){return mt(e)&&Gt(e)==Ue}function fg(e){return mt(e)&&mo(e.length)&&!!Ke[Zt(e)]}function Mu(e){return typeof e=="function"?e:e==null?lr:typeof e=="object"?we(e)?Hu(e[0],e[1]):zu(e):al(e)}function Oa(e){if(!Vn(e))return gp(e);var i=[];for(var o in Ge(e))Me.call(e,o)&&o!="constructor"&&i.push(o);return i}function dg(e){if(!ut(e))return Jg(e);var i=Vn(e),o=[];for(var c in e)c=="constructor"&&(i||!Me.call(e,c))||o.push(c);return o}function Aa(e,i){return e<i}function qu(e,i){var o=-1,c=ur(e)?M(e.length):[];return Ii(e,function(l,m,x){c[++o]=i(l,m,x)}),c}function zu(e){var i=Ba(e);return i.length==1&&i[0][2]?_h(i[0][0],i[0][1]):function(o){return o===e||Pa(o,e,i)}}function Hu(e,i){return Ka(e)&&bh(i)?_h(Qr(e),i):function(o){var c=tc(o,e);return c===r&&c===i?rc(o,e):Bn(i,c,L|J)}}function eo(e,i,o,c,l){e!==i&&Ea(i,function(m,x){if(l||(l=new jr),ut(m))pg(e,i,x,o,eo,c,l);else{var O=c?c(Wa(e,x),m,x+"",e,i,l):r;O===r&&(O=m),ba(e,x,O)}},hr)}function pg(e,i,o,c,l,m,x){var O=Wa(e,o),F=Wa(i,o),k=x.get(F);if(k){ba(e,o,k);return}var K=m?m(O,F,o+"",e,i,x):r,G=K===r;if(G){var te=we(F),ce=!te&&Oi(F),fe=!te&&!ce&&wn(F);K=F,te||ce||fe?we(O)?K=O:_t(O)?K=cr(O):ce?(G=!1,K=eh(F,!0)):fe?(G=!1,K=th(F,!0)):K=[]:Gn(F)||Ki(F)?(K=O,Ki(O)?K=Yh(O):(!ut(O)||ai(O))&&(K=wh(F))):G=!1}G&&(x.set(F,K),l(K,F,c,m,x),x.delete(F)),ba(e,o,K)}function Bu(e,i){var o=e.length;if(o)return i+=i<0?o:0,oi(i,o)?e[i]:r}function ku(e,i,o){i.length?i=nt(i,function(m){return we(m)?function(x){return Hi(x,m.length===1?m[0]:m)}:m}):i=[lr];var c=-1;i=nt(i,mr(le()));var l=qu(e,function(m,x,O){var F=nt(i,function(k){return k(m)});return{criteria:F,index:++c,value:m}});return zd(l,function(m,x){return Og(m,x,o)})}function gg(e,i){return Ku(e,i,function(o,c){return rc(e,c)})}function Ku(e,i,o){for(var c=-1,l=i.length,m={};++c<l;){var x=i[c],O=Hi(e,x);o(O,x)&&kn(m,xi(x,e),O)}return m}function yg(e){return function(i){return Hi(i,e)}}function Ra(e,i,o,c){var l=c?qd:cn,m=-1,x=i.length,O=e;for(e===i&&(i=cr(i)),o&&(O=nt(e,mr(o)));++m<x;)for(var F=0,k=i[m],K=o?o(k):k;(F=l(O,K,F,c))>-1;)O!==e&&ks.call(O,F,1),ks.call(e,F,1);return e}function Vu(e,i){for(var o=e?i.length:0,c=o-1;o--;){var l=i[o];if(o==c||l!==m){var m=l;oi(l)?ks.call(e,l,1):$a(e,l)}}return e}function Ta(e,i){return e+Ws(Pu()*(i-e+1))}function mg(e,i,o,c){for(var l=-1,m=Ut(Vs((i-e)/(o||1)),0),x=M(m);m--;)x[c?m:++l]=e,e+=o;return x}function Na(e,i){var o="";if(!e||i<1||i>Y)return o;do i%2&&(o+=e),i=Ws(i/2),i&&(e+=e);while(i);return o}function Se(e,i){return Ga(Eh(e,i,lr),e+"")}function vg(e){return Ru(bn(e))}function wg(e,i){var o=bn(e);return ho(o,zi(i,0,o.length))}function kn(e,i,o,c){if(!ut(e))return e;i=xi(i,e);for(var l=-1,m=i.length,x=m-1,O=e;O!=null&&++l<m;){var F=Qr(i[l]),k=o;if(F==="__proto__"||F==="constructor"||F==="prototype")return e;if(l!=x){var K=O[F];k=c?c(K,F,O):r,k===r&&(k=ut(K)?K:oi(i[l+1])?[]:{})}qn(O,F,k),O=O[F]}return e}var Wu=Gs?function(e,i){return Gs.set(e,i),e}:lr,bg=Ks?function(e,i){return Ks(e,"toString",{configurable:!0,enumerable:!1,value:nc(i),writable:!0})}:lr;function _g(e){return ho(bn(e))}function Rr(e,i,o){var c=-1,l=e.length;i<0&&(i=-i>l?0:l+i),o=o>l?l:o,o<0&&(o+=l),l=i>o?0:o-i>>>0,i>>>=0;for(var m=M(l);++c<l;)m[c]=e[c+i];return m}function Eg(e,i){var o;return Ii(e,function(c,l,m){return o=i(c,l,m),!o}),!!o}function to(e,i,o){var c=0,l=e==null?c:e.length;if(typeof i=="number"&&i===i&&l<=Be){for(;c<l;){var m=c+l>>>1,x=e[m];x!==null&&!wr(x)&&(o?x<=i:x<i)?c=m+1:l=m}return l}return Ca(e,i,lr,o)}function Ca(e,i,o,c){var l=0,m=e==null?0:e.length;if(m===0)return 0;i=o(i);for(var x=i!==i,O=i===null,F=wr(i),k=i===r;l<m;){var K=Ws((l+m)/2),G=o(e[K]),te=G!==r,ce=G===null,fe=G===G,Ee=wr(G);if(x)var de=c||fe;else k?de=fe&&(c||te):O?de=fe&&te&&(c||!ce):F?de=fe&&te&&!ce&&(c||!Ee):ce||Ee?de=!1:de=c?G<=i:G<i;de?l=K+1:m=K}return Wt(m,Je)}function Gu(e,i){for(var o=-1,c=e.length,l=0,m=[];++o<c;){var x=e[o],O=i?i(x):x;if(!o||!Lr(O,F)){var F=O;m[l++]=x===0?0:x}}return m}function Ju(e){return typeof e=="number"?e:wr(e)?Q:+e}function vr(e){if(typeof e=="string")return e;if(we(e))return nt(e,vr)+"";if(wr(e))return Ou?Ou.call(e):"";var i=e+"";return i=="0"&&1/e==-pe?"-0":i}function Si(e,i,o){var c=-1,l=Ds,m=e.length,x=!0,O=[],F=O;if(o)x=!1,l=aa;else if(m>=a){var k=i?null:$g(e);if(k)return Us(k);x=!1,l=Dn,F=new qi}else F=i?[]:O;e:for(;++c<m;){var K=e[c],G=i?i(K):K;if(K=o||K!==0?K:0,x&&G===G){for(var te=F.length;te--;)if(F[te]===G)continue e;i&&F.push(G),O.push(K)}else l(F,G,o)||(F!==O&&F.push(G),O.push(K))}return O}function $a(e,i){return i=xi(i,e),e=Ih(e,i),e==null||delete e[Qr(Tr(i))]}function Qu(e,i,o,c){return kn(e,i,o(Hi(e,i)),c)}function ro(e,i,o,c){for(var l=e.length,m=c?l:-1;(c?m--:++m<l)&&i(e[m],m,e););return o?Rr(e,c?0:m,c?m+1:l):Rr(e,c?m+1:0,c?l:m)}function Yu(e,i){var o=e;return o instanceof Oe&&(o=o.value()),ca(i,function(c,l){return l.func.apply(l.thisArg,bi([c],l.args))},o)}function Da(e,i,o){var c=e.length;if(c<2)return c?Si(e[0]):[];for(var l=-1,m=M(c);++l<c;)for(var x=e[l],O=-1;++O<c;)O!=l&&(m[l]=zn(m[l]||x,e[O],i,o));return Si(Kt(m,1),i,o)}function Xu(e,i,o){for(var c=-1,l=e.length,m=i.length,x={};++c<l;){var O=c<m?i[c]:r;o(x,e[c],O)}return x}function Fa(e){return _t(e)?e:[]}function Ua(e){return typeof e=="function"?e:lr}function xi(e,i){return we(e)?e:Ka(e,i)?[e]:Oh(je(e))}var Ig=Se;function Pi(e,i,o){var c=e.length;return o=o===r?c:o,!i&&o>=c?e:Rr(e,i,o)}var Zu=hp||function(e){return Ae.clearTimeout(e)};function eh(e,i){if(i)return e.slice();var o=e.length,c=_u?_u(o):new e.constructor(o);return e.copy(c),c}function ja(e){var i=new e.constructor(e.byteLength);return new Hs(i).set(new Hs(e)),i}function Sg(e,i){var o=i?ja(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function xg(e){var i=new e.constructor(e.source,Ir.exec(e));return i.lastIndex=e.lastIndex,i}function Pg(e){return Mn?Ge(Mn.call(e)):{}}function th(e,i){var o=i?ja(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function rh(e,i){if(e!==i){var o=e!==r,c=e===null,l=e===e,m=wr(e),x=i!==r,O=i===null,F=i===i,k=wr(i);if(!O&&!k&&!m&&e>i||m&&x&&F&&!O&&!k||c&&x&&F||!o&&F||!l)return 1;if(!c&&!m&&!k&&e<i||k&&o&&l&&!c&&!m||O&&o&&l||!x&&l||!F)return-1}return 0}function Og(e,i,o){for(var c=-1,l=e.criteria,m=i.criteria,x=l.length,O=o.length;++c<x;){var F=rh(l[c],m[c]);if(F){if(c>=O)return F;var k=o[c];return F*(k=="desc"?-1:1)}}return e.index-i.index}function ih(e,i,o,c){for(var l=-1,m=e.length,x=o.length,O=-1,F=i.length,k=Ut(m-x,0),K=M(F+k),G=!c;++O<F;)K[O]=i[O];for(;++l<x;)(G||l<m)&&(K[o[l]]=e[l]);for(;k--;)K[O++]=e[l++];return K}function nh(e,i,o,c){for(var l=-1,m=e.length,x=-1,O=o.length,F=-1,k=i.length,K=Ut(m-O,0),G=M(K+k),te=!c;++l<K;)G[l]=e[l];for(var ce=l;++F<k;)G[ce+F]=i[F];for(;++x<O;)(te||l<m)&&(G[ce+o[x]]=e[l++]);return G}function cr(e,i){var o=-1,c=e.length;for(i||(i=M(c));++o<c;)i[o]=e[o];return i}function Jr(e,i,o,c){var l=!o;o||(o={});for(var m=-1,x=i.length;++m<x;){var O=i[m],F=c?c(o[O],e[O],O,o,e):r;F===r&&(F=e[O]),l?ii(o,O,F):qn(o,O,F)}return o}function Ag(e,i){return Jr(e,ka(e),i)}function Rg(e,i){return Jr(e,mh(e),i)}function io(e,i){return function(o,c){var l=we(o)?Dd:Yp,m=i?i():{};return l(o,e,le(c,2),m)}}function yn(e){return Se(function(i,o){var c=-1,l=o.length,m=l>1?o[l-1]:r,x=l>2?o[2]:r;for(m=e.length>3&&typeof m=="function"?(l--,m):r,x&&er(o[0],o[1],x)&&(m=l<3?r:m,l=1),i=Ge(i);++c<l;){var O=o[c];O&&e(i,O,c,m)}return i})}function sh(e,i){return function(o,c){if(o==null)return o;if(!ur(o))return e(o,c);for(var l=o.length,m=i?l:-1,x=Ge(o);(i?m--:++m<l)&&c(x[m],m,x)!==!1;);return o}}function oh(e){return function(i,o,c){for(var l=-1,m=Ge(i),x=c(i),O=x.length;O--;){var F=x[e?O:++l];if(o(m[F],F,m)===!1)break}return i}}function Tg(e,i,o){var c=i&se,l=Kn(e);function m(){var x=this&&this!==Ae&&this instanceof m?l:e;return x.apply(c?o:this,arguments)}return m}function ah(e){return function(i){i=je(i);var o=un(i)?Ur(i):r,c=o?o[0]:i.charAt(0),l=o?Pi(o,1).join(""):i.slice(1);return c[e]()+l}}function mn(e){return function(i){return ca(sl(nl(i).replace(Cn,"")),e,"")}}function Kn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=gn(e.prototype),c=e.apply(o,i);return ut(c)?c:o}}function Ng(e,i,o){var c=Kn(e);function l(){for(var m=arguments.length,x=M(m),O=m,F=vn(l);O--;)x[O]=arguments[O];var k=m<3&&x[0]!==F&&x[m-1]!==F?[]:_i(x,F);if(m-=k.length,m<o)return fh(e,i,no,l.placeholder,r,x,k,r,r,o-m);var K=this&&this!==Ae&&this instanceof l?c:e;return Lt(K,this,x)}return l}function ch(e){return function(i,o,c){var l=Ge(i);if(!ur(i)){var m=le(o,3);i=Mt(i),o=function(O){return m(l[O],O,l)}}var x=e(i,o,c);return x>-1?l[m?i[x]:x]:r}}function uh(e){return si(function(i){var o=i.length,c=o,l=Or.prototype.thru;for(e&&i.reverse();c--;){var m=i[c];if(typeof m!="function")throw new Pr(d);if(l&&!x&&co(m)=="wrapper")var x=new Or([],!0)}for(c=x?c:o;++c<o;){m=i[c];var O=co(m),F=O=="wrapper"?Ha(m):r;F&&Va(F[0])&&F[1]==(C|y|w|R)&&!F[4].length&&F[9]==1?x=x[co(F[0])].apply(x,F[3]):x=m.length==1&&Va(m)?x[O]():x.thru(m)}return function(){var k=arguments,K=k[0];if(x&&k.length==1&&we(K))return x.plant(K).value();for(var G=0,te=o?i[G].apply(this,k):K;++G<o;)te=i[G].call(this,te);return te}})}function no(e,i,o,c,l,m,x,O,F,k){var K=i&C,G=i&se,te=i&he,ce=i&(y|b),fe=i&X,Ee=te?r:Kn(e);function de(){for(var xe=arguments.length,Re=M(xe),br=xe;br--;)Re[br]=arguments[br];if(ce)var tr=vn(de),_r=Bd(Re,tr);if(c&&(Re=ih(Re,c,l,ce)),m&&(Re=nh(Re,m,x,ce)),xe-=_r,ce&&xe<k){var Et=_i(Re,tr);return fh(e,i,no,de.placeholder,o,Re,Et,O,F,k-xe)}var Mr=G?o:this,ui=te?Mr[e]:e;return xe=Re.length,O?Re=Yg(Re,O):fe&&xe>1&&Re.reverse(),K&&F<xe&&(Re.length=F),this&&this!==Ae&&this instanceof de&&(ui=Ee||Kn(ui)),ui.apply(Mr,Re)}return de}function hh(e,i){return function(o,c){return sg(o,e,i(c),{})}}function so(e,i){return function(o,c){var l;if(o===r&&c===r)return i;if(o!==r&&(l=o),c!==r){if(l===r)return c;typeof o=="string"||typeof c=="string"?(o=vr(o),c=vr(c)):(o=Ju(o),c=Ju(c)),l=e(o,c)}return l}}function La(e){return si(function(i){return i=nt(i,mr(le())),Se(function(o){var c=this;return e(i,function(l){return Lt(l,c,o)})})})}function oo(e,i){i=i===r?" ":vr(i);var o=i.length;if(o<2)return o?Na(i,e):i;var c=Na(i,Vs(e/hn(i)));return un(i)?Pi(Ur(c),0,e).join(""):c.slice(0,e)}function Cg(e,i,o,c){var l=i&se,m=Kn(e);function x(){for(var O=-1,F=arguments.length,k=-1,K=c.length,G=M(K+F),te=this&&this!==Ae&&this instanceof x?m:e;++k<K;)G[k]=c[k];for(;F--;)G[k++]=arguments[++O];return Lt(te,l?o:this,G)}return x}function lh(e){return function(i,o,c){return c&&typeof c!="number"&&er(i,o,c)&&(o=c=r),i=ci(i),o===r?(o=i,i=0):o=ci(o),c=c===r?i<o?1:-1:ci(c),mg(i,o,c,e)}}function ao(e){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=Nr(i),o=Nr(o)),e(i,o)}}function fh(e,i,o,c,l,m,x,O,F,k){var K=i&y,G=K?x:r,te=K?r:x,ce=K?m:r,fe=K?r:m;i|=K?w:g,i&=~(K?g:w),i&f||(i&=~(se|he));var Ee=[e,i,l,ce,G,fe,te,O,F,k],de=o.apply(r,Ee);return Va(e)&&Sh(de,Ee),de.placeholder=c,xh(de,e,i)}function Ma(e){var i=Ft[e];return function(o,c){if(o=Nr(o),c=c==null?0:Wt(be(c),292),c&&xu(o)){var l=(je(o)+"e").split("e"),m=i(l[0]+"e"+(+l[1]+c));return l=(je(m)+"e").split("e"),+(l[0]+"e"+(+l[1]-c))}return i(o)}}var $g=dn&&1/Us(new dn([,-0]))[1]==pe?function(e){return new dn(e)}:ac;function dh(e){return function(i){var o=Gt(i);return o==_e?ga(i):o==Ue?Qd(i):Hd(i,e(i))}}function ni(e,i,o,c,l,m,x,O){var F=i&he;if(!F&&typeof e!="function")throw new Pr(d);var k=c?c.length:0;if(k||(i&=~(w|g),c=l=r),x=x===r?x:Ut(be(x),0),O=O===r?O:be(O),k-=l?l.length:0,i&g){var K=c,G=l;c=l=r}var te=F?r:Ha(e),ce=[e,i,o,c,l,K,G,m,x,O];if(te&&Gg(ce,te),e=ce[0],i=ce[1],o=ce[2],c=ce[3],l=ce[4],O=ce[9]=ce[9]===r?F?0:e.length:Ut(ce[9]-k,0),!O&&i&(y|b)&&(i&=~(y|b)),!i||i==se)var fe=Tg(e,i,o);else i==y||i==b?fe=Ng(e,i,O):(i==w||i==(se|w))&&!l.length?fe=Cg(e,i,o,c):fe=no.apply(r,ce);var Ee=te?Wu:Sh;return xh(Ee(fe,ce),e,i)}function ph(e,i,o,c){return e===r||Lr(e,fn[o])&&!Me.call(c,o)?i:e}function gh(e,i,o,c,l,m){return ut(e)&&ut(i)&&(m.set(i,e),eo(e,i,r,gh,m),m.delete(i)),e}function Dg(e){return Gn(e)?r:e}function yh(e,i,o,c,l,m){var x=o&L,O=e.length,F=i.length;if(O!=F&&!(x&&F>O))return!1;var k=m.get(e),K=m.get(i);if(k&&K)return k==i&&K==e;var G=-1,te=!0,ce=o&J?new qi:r;for(m.set(e,i),m.set(i,e);++G<O;){var fe=e[G],Ee=i[G];if(c)var de=x?c(Ee,fe,G,i,e,m):c(fe,Ee,G,e,i,m);if(de!==r){if(de)continue;te=!1;break}if(ce){if(!ua(i,function(xe,Re){if(!Dn(ce,Re)&&(fe===xe||l(fe,xe,o,c,m)))return ce.push(Re)})){te=!1;break}}else if(!(fe===Ee||l(fe,Ee,o,c,m))){te=!1;break}}return m.delete(e),m.delete(i),te}function Fg(e,i,o,c,l,m,x){switch(o){case ke:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case $e:return!(e.byteLength!=i.byteLength||!m(new Hs(e),new Hs(i)));case q:case U:case Ce:return Lr(+e,+i);case T:return e.name==i.name&&e.message==i.message;case ot:case Ye:return e==i+"";case _e:var O=ga;case Ue:var F=c&L;if(O||(O=Us),e.size!=i.size&&!F)return!1;var k=x.get(e);if(k)return k==i;c|=J,x.set(e,i);var K=yh(O(e),O(i),c,l,m,x);return x.delete(e),K;case Xe:if(Mn)return Mn.call(e)==Mn.call(i)}return!1}function Ug(e,i,o,c,l,m){var x=o&L,O=qa(e),F=O.length,k=qa(i),K=k.length;if(F!=K&&!x)return!1;for(var G=F;G--;){var te=O[G];if(!(x?te in i:Me.call(i,te)))return!1}var ce=m.get(e),fe=m.get(i);if(ce&&fe)return ce==i&&fe==e;var Ee=!0;m.set(e,i),m.set(i,e);for(var de=x;++G<F;){te=O[G];var xe=e[te],Re=i[te];if(c)var br=x?c(Re,xe,te,i,e,m):c(xe,Re,te,e,i,m);if(!(br===r?xe===Re||l(xe,Re,o,c,m):br)){Ee=!1;break}de||(de=te=="constructor")}if(Ee&&!de){var tr=e.constructor,_r=i.constructor;tr!=_r&&"constructor"in e&&"constructor"in i&&!(typeof tr=="function"&&tr instanceof tr&&typeof _r=="function"&&_r instanceof _r)&&(Ee=!1)}return m.delete(e),m.delete(i),Ee}function si(e){return Ga(Eh(e,r,Nh),e+"")}function qa(e){return Uu(e,Mt,ka)}function za(e){return Uu(e,hr,mh)}var Ha=Gs?function(e){return Gs.get(e)}:ac;function co(e){for(var i=e.name+"",o=pn[i],c=Me.call(pn,i)?o.length:0;c--;){var l=o[c],m=l.func;if(m==null||m==e)return l.name}return i}function vn(e){var i=Me.call(p,"placeholder")?p:e;return i.placeholder}function le(){var e=p.iteratee||sc;return e=e===sc?Mu:e,arguments.length?e(arguments[0],arguments[1]):e}function uo(e,i){var o=e.__data__;return kg(i)?o[typeof i=="string"?"string":"hash"]:o.map}function Ba(e){for(var i=Mt(e),o=i.length;o--;){var c=i[o],l=e[c];i[o]=[c,l,bh(l)]}return i}function Bi(e,i){var o=Wd(e,i);return Lu(o)?o:r}function jg(e){var i=Me.call(e,Li),o=e[Li];try{e[Li]=r;var c=!0}catch{}var l=qs.call(e);return c&&(i?e[Li]=o:delete e[Li]),l}var ka=ma?function(e){return e==null?[]:(e=Ge(e),wi(ma(e),function(i){return Iu.call(e,i)}))}:cc,mh=ma?function(e){for(var i=[];e;)bi(i,ka(e)),e=Bs(e);return i}:cc,Gt=Zt;(va&&Gt(new va(new ArrayBuffer(1)))!=ke||Un&&Gt(new Un)!=_e||wa&&Gt(wa.resolve())!=St||dn&&Gt(new dn)!=Ue||jn&&Gt(new jn)!=ze)&&(Gt=function(e){var i=Zt(e),o=i==Pe?e.constructor:r,c=o?ki(o):"";if(c)switch(c){case wp:return ke;case bp:return _e;case _p:return St;case Ep:return Ue;case Ip:return ze}return i});function Lg(e,i,o){for(var c=-1,l=o.length;++c<l;){var m=o[c],x=m.size;switch(m.type){case"drop":e+=x;break;case"dropRight":i-=x;break;case"take":i=Wt(i,e+x);break;case"takeRight":e=Ut(e,i-x);break}}return{start:e,end:i}}function Mg(e){var i=e.match(Qe);return i?i[1].split(Rt):[]}function vh(e,i,o){i=xi(i,e);for(var c=-1,l=i.length,m=!1;++c<l;){var x=Qr(i[c]);if(!(m=e!=null&&o(e,x)))break;e=e[x]}return m||++c!=l?m:(l=e==null?0:e.length,!!l&&mo(l)&&oi(x,l)&&(we(e)||Ki(e)))}function qg(e){var i=e.length,o=new e.constructor(i);return i&&typeof e[0]=="string"&&Me.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function wh(e){return typeof e.constructor=="function"&&!Vn(e)?gn(Bs(e)):{}}function zg(e,i,o){var c=e.constructor;switch(i){case $e:return ja(e);case q:case U:return new c(+e);case ke:return Sg(e,o);case ht:case Le:case xt:case Dt:case Bt:case kt:case jt:case Qt:case or:return th(e,o);case _e:return new c;case Ce:case Ye:return new c(e);case ot:return xg(e);case Ue:return new c;case Xe:return Pg(e)}}function Hg(e,i){var o=i.length;if(!o)return e;var c=o-1;return i[c]=(o>1?"& ":"")+i[c],i=i.join(o>2?", ":" "),e.replace(yt,`{
/* [wrapped with `+i+`] */
`)}function Bg(e){return we(e)||Ki(e)||!!(Su&&e&&e[Su])}function oi(e,i){var o=typeof e;return i=i??Y,!!i&&(o=="number"||o!="symbol"&&Wo.test(e))&&e>-1&&e%1==0&&e<i}function er(e,i,o){if(!ut(o))return!1;var c=typeof i;return(c=="number"?ur(o)&&oi(i,o.length):c=="string"&&i in o)?Lr(o[i],e):!1}function Ka(e,i){if(we(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||wr(e)?!0:Pt.test(e)||!it.test(e)||i!=null&&e in Ge(i)}function kg(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function Va(e){var i=co(e),o=p[i];if(typeof o!="function"||!(i in Oe.prototype))return!1;if(e===o)return!0;var c=Ha(o);return!!c&&e===c[0]}function Kg(e){return!!bu&&bu in e}var Vg=Ls?ai:uc;function Vn(e){var i=e&&e.constructor,o=typeof i=="function"&&i.prototype||fn;return e===o}function bh(e){return e===e&&!ut(e)}function _h(e,i){return function(o){return o==null?!1:o[e]===i&&(i!==r||e in Ge(o))}}function Wg(e){var i=go(e,function(c){return o.size===_&&o.clear(),c}),o=i.cache;return i}function Gg(e,i){var o=e[1],c=i[1],l=o|c,m=l<(se|he|C),x=c==C&&o==y||c==C&&o==R&&e[7].length<=i[8]||c==(C|R)&&i[7].length<=i[8]&&o==y;if(!(m||x))return e;c&se&&(e[2]=i[2],l|=o&se?0:f);var O=i[3];if(O){var F=e[3];e[3]=F?ih(F,O,i[4]):O,e[4]=F?_i(e[3],S):i[4]}return O=i[5],O&&(F=e[5],e[5]=F?nh(F,O,i[6]):O,e[6]=F?_i(e[5],S):i[6]),O=i[7],O&&(e[7]=O),c&C&&(e[8]=e[8]==null?i[8]:Wt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=l,e}function Jg(e){var i=[];if(e!=null)for(var o in Ge(e))i.push(o);return i}function Qg(e){return qs.call(e)}function Eh(e,i,o){return i=Ut(i===r?e.length-1:i,0),function(){for(var c=arguments,l=-1,m=Ut(c.length-i,0),x=M(m);++l<m;)x[l]=c[i+l];l=-1;for(var O=M(i+1);++l<i;)O[l]=c[l];return O[i]=o(x),Lt(e,this,O)}}function Ih(e,i){return i.length<2?e:Hi(e,Rr(i,0,-1))}function Yg(e,i){for(var o=e.length,c=Wt(i.length,o),l=cr(e);c--;){var m=i[c];e[c]=oi(m,o)?l[m]:r}return e}function Wa(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var Sh=Ph(Wu),Wn=fp||function(e,i){return Ae.setTimeout(e,i)},Ga=Ph(bg);function xh(e,i,o){var c=i+"";return Ga(e,Hg(c,Xg(Mg(c),o)))}function Ph(e){var i=0,o=0;return function(){var c=yp(),l=qe-(c-o);if(o=c,l>0){if(++i>=Ne)return arguments[0]}else i=0;return e.apply(r,arguments)}}function ho(e,i){var o=-1,c=e.length,l=c-1;for(i=i===r?c:i;++o<i;){var m=Ta(o,l),x=e[m];e[m]=e[o],e[o]=x}return e.length=i,e}var Oh=Wg(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Ot,function(o,c,l,m){i.push(l?m.replace(zo,"$1"):c||o)}),i});function Qr(e){if(typeof e=="string"||wr(e))return e;var i=e+"";return i=="0"&&1/e==-pe?"-0":i}function ki(e){if(e!=null){try{return Ms.call(e)}catch{}try{return e+""}catch{}}return""}function Xg(e,i){return xr(kr,function(o){var c="_."+o[0];i&o[1]&&!Ds(e,c)&&e.push(c)}),e.sort()}function Ah(e){if(e instanceof Oe)return e.clone();var i=new Or(e.__wrapped__,e.__chain__);return i.__actions__=cr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function Zg(e,i,o){(o?er(e,i,o):i===r)?i=1:i=Ut(be(i),0);var c=e==null?0:e.length;if(!c||i<1)return[];for(var l=0,m=0,x=M(Vs(c/i));l<c;)x[m++]=Rr(e,l,l+=i);return x}function ey(e){for(var i=-1,o=e==null?0:e.length,c=0,l=[];++i<o;){var m=e[i];m&&(l[c++]=m)}return l}function ty(){var e=arguments.length;if(!e)return[];for(var i=M(e-1),o=arguments[0],c=e;c--;)i[c-1]=arguments[c];return bi(we(o)?cr(o):[o],Kt(i,1))}var ry=Se(function(e,i){return _t(e)?zn(e,Kt(i,1,_t,!0)):[]}),iy=Se(function(e,i){var o=Tr(i);return _t(o)&&(o=r),_t(e)?zn(e,Kt(i,1,_t,!0),le(o,2)):[]}),ny=Se(function(e,i){var o=Tr(i);return _t(o)&&(o=r),_t(e)?zn(e,Kt(i,1,_t,!0),r,o):[]});function sy(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:be(i),Rr(e,i<0?0:i,c)):[]}function oy(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:be(i),i=c-i,Rr(e,0,i<0?0:i)):[]}function ay(e,i){return e&&e.length?ro(e,le(i,3),!0,!0):[]}function cy(e,i){return e&&e.length?ro(e,le(i,3),!0):[]}function uy(e,i,o,c){var l=e==null?0:e.length;return l?(o&&typeof o!="number"&&er(e,i,o)&&(o=0,c=l),tg(e,i,o,c)):[]}function Rh(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=o==null?0:be(o);return l<0&&(l=Ut(c+l,0)),Fs(e,le(i,3),l)}function Th(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=c-1;return o!==r&&(l=be(o),l=o<0?Ut(c+l,0):Wt(l,c-1)),Fs(e,le(i,3),l,!0)}function Nh(e){var i=e==null?0:e.length;return i?Kt(e,1):[]}function hy(e){var i=e==null?0:e.length;return i?Kt(e,pe):[]}function ly(e,i){var o=e==null?0:e.length;return o?(i=i===r?1:be(i),Kt(e,i)):[]}function fy(e){for(var i=-1,o=e==null?0:e.length,c={};++i<o;){var l=e[i];c[l[0]]=l[1]}return c}function Ch(e){return e&&e.length?e[0]:r}function dy(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=o==null?0:be(o);return l<0&&(l=Ut(c+l,0)),cn(e,i,l)}function py(e){var i=e==null?0:e.length;return i?Rr(e,0,-1):[]}var gy=Se(function(e){var i=nt(e,Fa);return i.length&&i[0]===e[0]?xa(i):[]}),yy=Se(function(e){var i=Tr(e),o=nt(e,Fa);return i===Tr(o)?i=r:o.pop(),o.length&&o[0]===e[0]?xa(o,le(i,2)):[]}),my=Se(function(e){var i=Tr(e),o=nt(e,Fa);return i=typeof i=="function"?i:r,i&&o.pop(),o.length&&o[0]===e[0]?xa(o,r,i):[]});function vy(e,i){return e==null?"":pp.call(e,i)}function Tr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function wy(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=c;return o!==r&&(l=be(o),l=l<0?Ut(c+l,0):Wt(l,c-1)),i===i?Xd(e,i,l):Fs(e,fu,l,!0)}function by(e,i){return e&&e.length?Bu(e,be(i)):r}var _y=Se($h);function $h(e,i){return e&&e.length&&i&&i.length?Ra(e,i):e}function Ey(e,i,o){return e&&e.length&&i&&i.length?Ra(e,i,le(o,2)):e}function Iy(e,i,o){return e&&e.length&&i&&i.length?Ra(e,i,r,o):e}var Sy=si(function(e,i){var o=e==null?0:e.length,c=_a(e,i);return Vu(e,nt(i,function(l){return oi(l,o)?+l:l}).sort(rh)),c});function xy(e,i){var o=[];if(!(e&&e.length))return o;var c=-1,l=[],m=e.length;for(i=le(i,3);++c<m;){var x=e[c];i(x,c,e)&&(o.push(x),l.push(c))}return Vu(e,l),o}function Ja(e){return e==null?e:vp.call(e)}function Py(e,i,o){var c=e==null?0:e.length;return c?(o&&typeof o!="number"&&er(e,i,o)?(i=0,o=c):(i=i==null?0:be(i),o=o===r?c:be(o)),Rr(e,i,o)):[]}function Oy(e,i){return to(e,i)}function Ay(e,i,o){return Ca(e,i,le(o,2))}function Ry(e,i){var o=e==null?0:e.length;if(o){var c=to(e,i);if(c<o&&Lr(e[c],i))return c}return-1}function Ty(e,i){return to(e,i,!0)}function Ny(e,i,o){return Ca(e,i,le(o,2),!0)}function Cy(e,i){var o=e==null?0:e.length;if(o){var c=to(e,i,!0)-1;if(Lr(e[c],i))return c}return-1}function $y(e){return e&&e.length?Gu(e):[]}function Dy(e,i){return e&&e.length?Gu(e,le(i,2)):[]}function Fy(e){var i=e==null?0:e.length;return i?Rr(e,1,i):[]}function Uy(e,i,o){return e&&e.length?(i=o||i===r?1:be(i),Rr(e,0,i<0?0:i)):[]}function jy(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:be(i),i=c-i,Rr(e,i<0?0:i,c)):[]}function Ly(e,i){return e&&e.length?ro(e,le(i,3),!1,!0):[]}function My(e,i){return e&&e.length?ro(e,le(i,3)):[]}var qy=Se(function(e){return Si(Kt(e,1,_t,!0))}),zy=Se(function(e){var i=Tr(e);return _t(i)&&(i=r),Si(Kt(e,1,_t,!0),le(i,2))}),Hy=Se(function(e){var i=Tr(e);return i=typeof i=="function"?i:r,Si(Kt(e,1,_t,!0),r,i)});function By(e){return e&&e.length?Si(e):[]}function ky(e,i){return e&&e.length?Si(e,le(i,2)):[]}function Ky(e,i){return i=typeof i=="function"?i:r,e&&e.length?Si(e,r,i):[]}function Qa(e){if(!(e&&e.length))return[];var i=0;return e=wi(e,function(o){if(_t(o))return i=Ut(o.length,i),!0}),da(i,function(o){return nt(e,ha(o))})}function Dh(e,i){if(!(e&&e.length))return[];var o=Qa(e);return i==null?o:nt(o,function(c){return Lt(i,r,c)})}var Vy=Se(function(e,i){return _t(e)?zn(e,i):[]}),Wy=Se(function(e){return Da(wi(e,_t))}),Gy=Se(function(e){var i=Tr(e);return _t(i)&&(i=r),Da(wi(e,_t),le(i,2))}),Jy=Se(function(e){var i=Tr(e);return i=typeof i=="function"?i:r,Da(wi(e,_t),r,i)}),Qy=Se(Qa);function Yy(e,i){return Xu(e||[],i||[],qn)}function Xy(e,i){return Xu(e||[],i||[],kn)}var Zy=Se(function(e){var i=e.length,o=i>1?e[i-1]:r;return o=typeof o=="function"?(e.pop(),o):r,Dh(e,o)});function Fh(e){var i=p(e);return i.__chain__=!0,i}function em(e,i){return i(e),e}function lo(e,i){return i(e)}var tm=si(function(e){var i=e.length,o=i?e[0]:0,c=this.__wrapped__,l=function(m){return _a(m,e)};return i>1||this.__actions__.length||!(c instanceof Oe)||!oi(o)?this.thru(l):(c=c.slice(o,+o+(i?1:0)),c.__actions__.push({func:lo,args:[l],thisArg:r}),new Or(c,this.__chain__).thru(function(m){return i&&!m.length&&m.push(r),m}))});function rm(){return Fh(this)}function im(){return new Or(this.value(),this.__chain__)}function nm(){this.__values__===r&&(this.__values__=Jh(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function sm(){return this}function om(e){for(var i,o=this;o instanceof Qs;){var c=Ah(o);c.__index__=0,c.__values__=r,i?l.__wrapped__=c:i=c;var l=c;o=o.__wrapped__}return l.__wrapped__=e,i}function am(){var e=this.__wrapped__;if(e instanceof Oe){var i=e;return this.__actions__.length&&(i=new Oe(this)),i=i.reverse(),i.__actions__.push({func:lo,args:[Ja],thisArg:r}),new Or(i,this.__chain__)}return this.thru(Ja)}function cm(){return Yu(this.__wrapped__,this.__actions__)}var um=io(function(e,i,o){Me.call(e,o)?++e[o]:ii(e,o,1)});function hm(e,i,o){var c=we(e)?hu:eg;return o&&er(e,i,o)&&(i=r),c(e,le(i,3))}function lm(e,i){var o=we(e)?wi:Du;return o(e,le(i,3))}var fm=ch(Rh),dm=ch(Th);function pm(e,i){return Kt(fo(e,i),1)}function gm(e,i){return Kt(fo(e,i),pe)}function ym(e,i,o){return o=o===r?1:be(o),Kt(fo(e,i),o)}function Uh(e,i){var o=we(e)?xr:Ii;return o(e,le(i,3))}function jh(e,i){var o=we(e)?Fd:$u;return o(e,le(i,3))}var mm=io(function(e,i,o){Me.call(e,o)?e[o].push(i):ii(e,o,[i])});function vm(e,i,o,c){e=ur(e)?e:bn(e),o=o&&!c?be(o):0;var l=e.length;return o<0&&(o=Ut(l+o,0)),vo(e)?o<=l&&e.indexOf(i,o)>-1:!!l&&cn(e,i,o)>-1}var wm=Se(function(e,i,o){var c=-1,l=typeof i=="function",m=ur(e)?M(e.length):[];return Ii(e,function(x){m[++c]=l?Lt(i,x,o):Hn(x,i,o)}),m}),bm=io(function(e,i,o){ii(e,o,i)});function fo(e,i){var o=we(e)?nt:qu;return o(e,le(i,3))}function _m(e,i,o,c){return e==null?[]:(we(i)||(i=i==null?[]:[i]),o=c?r:o,we(o)||(o=o==null?[]:[o]),ku(e,i,o))}var Em=io(function(e,i,o){e[o?0:1].push(i)},function(){return[[],[]]});function Im(e,i,o){var c=we(e)?ca:pu,l=arguments.length<3;return c(e,le(i,4),o,l,Ii)}function Sm(e,i,o){var c=we(e)?Ud:pu,l=arguments.length<3;return c(e,le(i,4),o,l,$u)}function xm(e,i){var o=we(e)?wi:Du;return o(e,yo(le(i,3)))}function Pm(e){var i=we(e)?Ru:vg;return i(e)}function Om(e,i,o){(o?er(e,i,o):i===r)?i=1:i=be(i);var c=we(e)?Jp:wg;return c(e,i)}function Am(e){var i=we(e)?Qp:_g;return i(e)}function Rm(e){if(e==null)return 0;if(ur(e))return vo(e)?hn(e):e.length;var i=Gt(e);return i==_e||i==Ue?e.size:Oa(e).length}function Tm(e,i,o){var c=we(e)?ua:Eg;return o&&er(e,i,o)&&(i=r),c(e,le(i,3))}var Nm=Se(function(e,i){if(e==null)return[];var o=i.length;return o>1&&er(e,i[0],i[1])?i=[]:o>2&&er(i[0],i[1],i[2])&&(i=[i[0]]),ku(e,Kt(i,1),[])}),po=lp||function(){return Ae.Date.now()};function Cm(e,i){if(typeof i!="function")throw new Pr(d);return e=be(e),function(){if(--e<1)return i.apply(this,arguments)}}function Lh(e,i,o){return i=o?r:i,i=e&&i==null?e.length:i,ni(e,C,r,r,r,r,i)}function Mh(e,i){var o;if(typeof i!="function")throw new Pr(d);return e=be(e),function(){return--e>0&&(o=i.apply(this,arguments)),e<=1&&(i=r),o}}var Ya=Se(function(e,i,o){var c=se;if(o.length){var l=_i(o,vn(Ya));c|=w}return ni(e,c,i,o,l)}),qh=Se(function(e,i,o){var c=se|he;if(o.length){var l=_i(o,vn(qh));c|=w}return ni(i,c,e,o,l)});function zh(e,i,o){i=o?r:i;var c=ni(e,y,r,r,r,r,r,i);return c.placeholder=zh.placeholder,c}function Hh(e,i,o){i=o?r:i;var c=ni(e,b,r,r,r,r,r,i);return c.placeholder=Hh.placeholder,c}function Bh(e,i,o){var c,l,m,x,O,F,k=0,K=!1,G=!1,te=!0;if(typeof e!="function")throw new Pr(d);i=Nr(i)||0,ut(o)&&(K=!!o.leading,G="maxWait"in o,m=G?Ut(Nr(o.maxWait)||0,i):m,te="trailing"in o?!!o.trailing:te);function ce(Et){var Mr=c,ui=l;return c=l=r,k=Et,x=e.apply(ui,Mr),x}function fe(Et){return k=Et,O=Wn(xe,i),K?ce(Et):x}function Ee(Et){var Mr=Et-F,ui=Et-k,cl=i-Mr;return G?Wt(cl,m-ui):cl}function de(Et){var Mr=Et-F,ui=Et-k;return F===r||Mr>=i||Mr<0||G&&ui>=m}function xe(){var Et=po();if(de(Et))return Re(Et);O=Wn(xe,Ee(Et))}function Re(Et){return O=r,te&&c?ce(Et):(c=l=r,x)}function br(){O!==r&&Zu(O),k=0,c=F=l=O=r}function tr(){return O===r?x:Re(po())}function _r(){var Et=po(),Mr=de(Et);if(c=arguments,l=this,F=Et,Mr){if(O===r)return fe(F);if(G)return Zu(O),O=Wn(xe,i),ce(F)}return O===r&&(O=Wn(xe,i)),x}return _r.cancel=br,_r.flush=tr,_r}var $m=Se(function(e,i){return Cu(e,1,i)}),Dm=Se(function(e,i,o){return Cu(e,Nr(i)||0,o)});function Fm(e){return ni(e,X)}function go(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new Pr(d);var o=function(){var c=arguments,l=i?i.apply(this,c):c[0],m=o.cache;if(m.has(l))return m.get(l);var x=e.apply(this,c);return o.cache=m.set(l,x)||m,x};return o.cache=new(go.Cache||ri),o}go.Cache=ri;function yo(e){if(typeof e!="function")throw new Pr(d);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function Um(e){return Mh(2,e)}var jm=Ig(function(e,i){i=i.length==1&&we(i[0])?nt(i[0],mr(le())):nt(Kt(i,1),mr(le()));var o=i.length;return Se(function(c){for(var l=-1,m=Wt(c.length,o);++l<m;)c[l]=i[l].call(this,c[l]);return Lt(e,this,c)})}),Xa=Se(function(e,i){var o=_i(i,vn(Xa));return ni(e,w,r,i,o)}),kh=Se(function(e,i){var o=_i(i,vn(kh));return ni(e,g,r,i,o)}),Lm=si(function(e,i){return ni(e,R,r,r,r,i)});function Mm(e,i){if(typeof e!="function")throw new Pr(d);return i=i===r?i:be(i),Se(e,i)}function qm(e,i){if(typeof e!="function")throw new Pr(d);return i=i==null?0:Ut(be(i),0),Se(function(o){var c=o[i],l=Pi(o,0,i);return c&&bi(l,c),Lt(e,this,l)})}function zm(e,i,o){var c=!0,l=!0;if(typeof e!="function")throw new Pr(d);return ut(o)&&(c="leading"in o?!!o.leading:c,l="trailing"in o?!!o.trailing:l),Bh(e,i,{leading:c,maxWait:i,trailing:l})}function Hm(e){return Lh(e,1)}function Bm(e,i){return Xa(Ua(i),e)}function km(){if(!arguments.length)return[];var e=arguments[0];return we(e)?e:[e]}function Km(e){return Ar(e,B)}function Vm(e,i){return i=typeof i=="function"?i:r,Ar(e,B,i)}function Wm(e){return Ar(e,A|B)}function Gm(e,i){return i=typeof i=="function"?i:r,Ar(e,A|B,i)}function Jm(e,i){return i==null||Nu(e,i,Mt(i))}function Lr(e,i){return e===i||e!==e&&i!==i}var Qm=ao(Sa),Ym=ao(function(e,i){return e>=i}),Ki=ju(function(){return arguments}())?ju:function(e){return mt(e)&&Me.call(e,"callee")&&!Iu.call(e,"callee")},we=M.isArray,Xm=Xt?mr(Xt):og;function ur(e){return e!=null&&mo(e.length)&&!ai(e)}function _t(e){return mt(e)&&ur(e)}function Zm(e){return e===!0||e===!1||mt(e)&&Zt(e)==q}var Oi=dp||uc,e0=Fr?mr(Fr):ag;function t0(e){return mt(e)&&e.nodeType===1&&!Gn(e)}function r0(e){if(e==null)return!0;if(ur(e)&&(we(e)||typeof e=="string"||typeof e.splice=="function"||Oi(e)||wn(e)||Ki(e)))return!e.length;var i=Gt(e);if(i==_e||i==Ue)return!e.size;if(Vn(e))return!Oa(e).length;for(var o in e)if(Me.call(e,o))return!1;return!0}function i0(e,i){return Bn(e,i)}function n0(e,i,o){o=typeof o=="function"?o:r;var c=o?o(e,i):r;return c===r?Bn(e,i,r,o):!!c}function Za(e){if(!mt(e))return!1;var i=Zt(e);return i==T||i==u||typeof e.message=="string"&&typeof e.name=="string"&&!Gn(e)}function s0(e){return typeof e=="number"&&xu(e)}function ai(e){if(!ut(e))return!1;var i=Zt(e);return i==ae||i==ye||i==z||i==vt}function Kh(e){return typeof e=="number"&&e==be(e)}function mo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Y}function ut(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function mt(e){return e!=null&&typeof e=="object"}var Vh=Sr?mr(Sr):ug;function o0(e,i){return e===i||Pa(e,i,Ba(i))}function a0(e,i,o){return o=typeof o=="function"?o:r,Pa(e,i,Ba(i),o)}function c0(e){return Wh(e)&&e!=+e}function u0(e){if(Vg(e))throw new me(h);return Lu(e)}function h0(e){return e===null}function l0(e){return e==null}function Wh(e){return typeof e=="number"||mt(e)&&Zt(e)==Ce}function Gn(e){if(!mt(e)||Zt(e)!=Pe)return!1;var i=Bs(e);if(i===null)return!0;var o=Me.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&Ms.call(o)==ap}var ec=Wr?mr(Wr):hg;function f0(e){return Kh(e)&&e>=-Y&&e<=Y}var Gh=$n?mr($n):lg;function vo(e){return typeof e=="string"||!we(e)&&mt(e)&&Zt(e)==Ye}function wr(e){return typeof e=="symbol"||mt(e)&&Zt(e)==Xe}var wn=ji?mr(ji):fg;function d0(e){return e===r}function p0(e){return mt(e)&&Gt(e)==ze}function g0(e){return mt(e)&&Zt(e)==Ze}var y0=ao(Aa),m0=ao(function(e,i){return e<=i});function Jh(e){if(!e)return[];if(ur(e))return vo(e)?Ur(e):cr(e);if(Fn&&e[Fn])return Jd(e[Fn]());var i=Gt(e),o=i==_e?ga:i==Ue?Us:bn;return o(e)}function ci(e){if(!e)return e===0?e:0;if(e=Nr(e),e===pe||e===-pe){var i=e<0?-1:1;return i*W}return e===e?e:0}function be(e){var i=ci(e),o=i%1;return i===i?o?i-o:i:0}function Qh(e){return e?zi(be(e),0,Z):0}function Nr(e){if(typeof e=="number")return e;if(wr(e))return Q;if(ut(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=ut(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=gu(e);var o=ko.test(e);return o||Vo.test(e)?ve(e.slice(2),o?2:8):Bo.test(e)?Q:+e}function Yh(e){return Jr(e,hr(e))}function v0(e){return e?zi(be(e),-Y,Y):e===0?e:0}function je(e){return e==null?"":vr(e)}var w0=yn(function(e,i){if(Vn(i)||ur(i)){Jr(i,Mt(i),e);return}for(var o in i)Me.call(i,o)&&qn(e,o,i[o])}),Xh=yn(function(e,i){Jr(i,hr(i),e)}),wo=yn(function(e,i,o,c){Jr(i,hr(i),e,c)}),b0=yn(function(e,i,o,c){Jr(i,Mt(i),e,c)}),_0=si(_a);function E0(e,i){var o=gn(e);return i==null?o:Tu(o,i)}var I0=Se(function(e,i){e=Ge(e);var o=-1,c=i.length,l=c>2?i[2]:r;for(l&&er(i[0],i[1],l)&&(c=1);++o<c;)for(var m=i[o],x=hr(m),O=-1,F=x.length;++O<F;){var k=x[O],K=e[k];(K===r||Lr(K,fn[k])&&!Me.call(e,k))&&(e[k]=m[k])}return e}),S0=Se(function(e){return e.push(r,gh),Lt(Zh,r,e)});function x0(e,i){return lu(e,le(i,3),Gr)}function P0(e,i){return lu(e,le(i,3),Ia)}function O0(e,i){return e==null?e:Ea(e,le(i,3),hr)}function A0(e,i){return e==null?e:Fu(e,le(i,3),hr)}function R0(e,i){return e&&Gr(e,le(i,3))}function T0(e,i){return e&&Ia(e,le(i,3))}function N0(e){return e==null?[]:Zs(e,Mt(e))}function C0(e){return e==null?[]:Zs(e,hr(e))}function tc(e,i,o){var c=e==null?r:Hi(e,i);return c===r?o:c}function $0(e,i){return e!=null&&vh(e,i,rg)}function rc(e,i){return e!=null&&vh(e,i,ig)}var D0=hh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=qs.call(i)),e[i]=o},nc(lr)),F0=hh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=qs.call(i)),Me.call(e,i)?e[i].push(o):e[i]=[o]},le),U0=Se(Hn);function Mt(e){return ur(e)?Au(e):Oa(e)}function hr(e){return ur(e)?Au(e,!0):dg(e)}function j0(e,i){var o={};return i=le(i,3),Gr(e,function(c,l,m){ii(o,i(c,l,m),c)}),o}function L0(e,i){var o={};return i=le(i,3),Gr(e,function(c,l,m){ii(o,l,i(c,l,m))}),o}var M0=yn(function(e,i,o){eo(e,i,o)}),Zh=yn(function(e,i,o,c){eo(e,i,o,c)}),q0=si(function(e,i){var o={};if(e==null)return o;var c=!1;i=nt(i,function(m){return m=xi(m,e),c||(c=m.length>1),m}),Jr(e,za(e),o),c&&(o=Ar(o,A|j|B,Dg));for(var l=i.length;l--;)$a(o,i[l]);return o});function z0(e,i){return el(e,yo(le(i)))}var H0=si(function(e,i){return e==null?{}:gg(e,i)});function el(e,i){if(e==null)return{};var o=nt(za(e),function(c){return[c]});return i=le(i),Ku(e,o,function(c,l){return i(c,l[0])})}function B0(e,i,o){i=xi(i,e);var c=-1,l=i.length;for(l||(l=1,e=r);++c<l;){var m=e==null?r:e[Qr(i[c])];m===r&&(c=l,m=o),e=ai(m)?m.call(e):m}return e}function k0(e,i,o){return e==null?e:kn(e,i,o)}function K0(e,i,o,c){return c=typeof c=="function"?c:r,e==null?e:kn(e,i,o,c)}var tl=dh(Mt),rl=dh(hr);function V0(e,i,o){var c=we(e),l=c||Oi(e)||wn(e);if(i=le(i,4),o==null){var m=e&&e.constructor;l?o=c?new m:[]:ut(e)?o=ai(m)?gn(Bs(e)):{}:o={}}return(l?xr:Gr)(e,function(x,O,F){return i(o,x,O,F)}),o}function W0(e,i){return e==null?!0:$a(e,i)}function G0(e,i,o){return e==null?e:Qu(e,i,Ua(o))}function J0(e,i,o,c){return c=typeof c=="function"?c:r,e==null?e:Qu(e,i,Ua(o),c)}function bn(e){return e==null?[]:pa(e,Mt(e))}function Q0(e){return e==null?[]:pa(e,hr(e))}function Y0(e,i,o){return o===r&&(o=i,i=r),o!==r&&(o=Nr(o),o=o===o?o:0),i!==r&&(i=Nr(i),i=i===i?i:0),zi(Nr(e),i,o)}function X0(e,i,o){return i=ci(i),o===r?(o=i,i=0):o=ci(o),e=Nr(e),ng(e,i,o)}function Z0(e,i,o){if(o&&typeof o!="boolean"&&er(e,i,o)&&(i=o=r),o===r&&(typeof i=="boolean"?(o=i,i=r):typeof e=="boolean"&&(o=e,e=r)),e===r&&i===r?(e=0,i=1):(e=ci(e),i===r?(i=e,e=0):i=ci(i)),e>i){var c=e;e=i,i=c}if(o||e%1||i%1){var l=Pu();return Wt(e+l*(i-e+Ve("1e-"+((l+"").length-1))),i)}return Ta(e,i)}var ev=mn(function(e,i,o){return i=i.toLowerCase(),e+(o?il(i):i)});function il(e){return ic(je(e).toLowerCase())}function nl(e){return e=je(e),e&&e.replace(Zr,kd).replace(sa,"")}function tv(e,i,o){e=je(e),i=vr(i);var c=e.length;o=o===r?c:zi(be(o),0,c);var l=o;return o-=i.length,o>=0&&e.slice(o,l)==i}function rv(e){return e=je(e),e&&rt.test(e)?e.replace(Ci,Kd):e}function iv(e){return e=je(e),e&&At.test(e)?e.replace(pt,"\\$&"):e}var nv=mn(function(e,i,o){return e+(o?"-":"")+i.toLowerCase()}),sv=mn(function(e,i,o){return e+(o?" ":"")+i.toLowerCase()}),ov=ah("toLowerCase");function av(e,i,o){e=je(e),i=be(i);var c=i?hn(e):0;if(!i||c>=i)return e;var l=(i-c)/2;return oo(Ws(l),o)+e+oo(Vs(l),o)}function cv(e,i,o){e=je(e),i=be(i);var c=i?hn(e):0;return i&&c<i?e+oo(i-c,o):e}function uv(e,i,o){e=je(e),i=be(i);var c=i?hn(e):0;return i&&c<i?oo(i-c,o)+e:e}function hv(e,i,o){return o||i==null?i=0:i&&(i=+i),mp(je(e).replace(gt,""),i||0)}function lv(e,i,o){return(o?er(e,i,o):i===r)?i=1:i=be(i),Na(je(e),i)}function fv(){var e=arguments,i=je(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var dv=mn(function(e,i,o){return e+(o?"_":"")+i.toLowerCase()});function pv(e,i,o){return o&&typeof o!="number"&&er(e,i,o)&&(i=o=r),o=o===r?Z:o>>>0,o?(e=je(e),e&&(typeof i=="string"||i!=null&&!ec(i))&&(i=vr(i),!i&&un(e))?Pi(Ur(e),0,o):e.split(i,o)):[]}var gv=mn(function(e,i,o){return e+(o?" ":"")+ic(i)});function yv(e,i,o){return e=je(e),o=o==null?0:zi(be(o),0,e.length),i=vr(i),e.slice(o,o+i.length)==i}function mv(e,i,o){var c=p.templateSettings;o&&er(e,i,o)&&(i=r),e=je(e),i=wo({},i,c,ph);var l=wo({},i.imports,c.imports,ph),m=Mt(l),x=pa(l,m),O,F,k=0,K=i.interpolate||en,G="__p += '",te=ya((i.escape||en).source+"|"+K.source+"|"+(K===ct?Ho:en).source+"|"+(i.evaluate||en).source+"|$","g"),ce="//# sourceURL="+(Me.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++oa+"]")+`
`;e.replace(te,function(de,xe,Re,br,tr,_r){return Re||(Re=br),G+=e.slice(k,_r).replace(Go,Vd),xe&&(O=!0,G+=`' +
__e(`+xe+`) +
'`),tr&&(F=!0,G+=`';
`+tr+`;
__p += '`),Re&&(G+=`' +
((__t = (`+Re+`)) == null ? '' : __t) +
'`),k=_r+de.length,de}),G+=`';
`;var fe=Me.call(i,"variable")&&i.variable;if(!fe)G=`with (obj) {
`+G+`
}
`;else if(qo.test(fe))throw new me(v);G=(F?G.replace(Kr,""):G).replace(Yt,"$1").replace(Xr,"$1;"),G="function("+(fe||"obj")+`) {
`+(fe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(O?", __e = _.escape":"")+(F?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+G+`return __p
}`;var Ee=ol(function(){return Fe(m,ce+"return "+G).apply(r,x)});if(Ee.source=G,Za(Ee))throw Ee;return Ee}function vv(e){return je(e).toLowerCase()}function wv(e){return je(e).toUpperCase()}function bv(e,i,o){if(e=je(e),e&&(o||i===r))return gu(e);if(!e||!(i=vr(i)))return e;var c=Ur(e),l=Ur(i),m=yu(c,l),x=mu(c,l)+1;return Pi(c,m,x).join("")}function _v(e,i,o){if(e=je(e),e&&(o||i===r))return e.slice(0,wu(e)+1);if(!e||!(i=vr(i)))return e;var c=Ur(e),l=mu(c,Ur(i))+1;return Pi(c,0,l).join("")}function Ev(e,i,o){if(e=je(e),e&&(o||i===r))return e.replace(gt,"");if(!e||!(i=vr(i)))return e;var c=Ur(e),l=yu(c,Ur(i));return Pi(c,l).join("")}function Iv(e,i){var o=oe,c=ge;if(ut(i)){var l="separator"in i?i.separator:l;o="length"in i?be(i.length):o,c="omission"in i?vr(i.omission):c}e=je(e);var m=e.length;if(un(e)){var x=Ur(e);m=x.length}if(o>=m)return e;var O=o-hn(c);if(O<1)return c;var F=x?Pi(x,0,O).join(""):e.slice(0,O);if(l===r)return F+c;if(x&&(O+=F.length-O),ec(l)){if(e.slice(O).search(l)){var k,K=F;for(l.global||(l=ya(l.source,je(Ir.exec(l))+"g")),l.lastIndex=0;k=l.exec(K);)var G=k.index;F=F.slice(0,G===r?O:G)}}else if(e.indexOf(vr(l),O)!=O){var te=F.lastIndexOf(l);te>-1&&(F=F.slice(0,te))}return F+c}function Sv(e){return e=je(e),e&&lt.test(e)?e.replace(mi,Zd):e}var xv=mn(function(e,i,o){return e+(o?" ":"")+i.toUpperCase()}),ic=ah("toUpperCase");function sl(e,i,o){return e=je(e),i=o?r:i,i===r?Gd(e)?rp(e):Md(e):e.match(i)||[]}var ol=Se(function(e,i){try{return Lt(e,r,i)}catch(o){return Za(o)?o:new me(o)}}),Pv=si(function(e,i){return xr(i,function(o){o=Qr(o),ii(e,o,Ya(e[o],e))}),e});function Ov(e){var i=e==null?0:e.length,o=le();return e=i?nt(e,function(c){if(typeof c[1]!="function")throw new Pr(d);return[o(c[0]),c[1]]}):[],Se(function(c){for(var l=-1;++l<i;){var m=e[l];if(Lt(m[0],this,c))return Lt(m[1],this,c)}})}function Av(e){return Zp(Ar(e,A))}function nc(e){return function(){return e}}function Rv(e,i){return e==null||e!==e?i:e}var Tv=uh(),Nv=uh(!0);function lr(e){return e}function sc(e){return Mu(typeof e=="function"?e:Ar(e,A))}function Cv(e){return zu(Ar(e,A))}function $v(e,i){return Hu(e,Ar(i,A))}var Dv=Se(function(e,i){return function(o){return Hn(o,e,i)}}),Fv=Se(function(e,i){return function(o){return Hn(e,o,i)}});function oc(e,i,o){var c=Mt(i),l=Zs(i,c);o==null&&!(ut(i)&&(l.length||!c.length))&&(o=i,i=e,e=this,l=Zs(i,Mt(i)));var m=!(ut(o)&&"chain"in o)||!!o.chain,x=ai(e);return xr(l,function(O){var F=i[O];e[O]=F,x&&(e.prototype[O]=function(){var k=this.__chain__;if(m||k){var K=e(this.__wrapped__),G=K.__actions__=cr(this.__actions__);return G.push({func:F,args:arguments,thisArg:e}),K.__chain__=k,K}return F.apply(e,bi([this.value()],arguments))})}),e}function Uv(){return Ae._===this&&(Ae._=cp),this}function ac(){}function jv(e){return e=be(e),Se(function(i){return Bu(i,e)})}var Lv=La(nt),Mv=La(hu),qv=La(ua);function al(e){return Ka(e)?ha(Qr(e)):yg(e)}function zv(e){return function(i){return e==null?r:Hi(e,i)}}var Hv=lh(),Bv=lh(!0);function cc(){return[]}function uc(){return!1}function kv(){return{}}function Kv(){return""}function Vv(){return!0}function Wv(e,i){if(e=be(e),e<1||e>Y)return[];var o=Z,c=Wt(e,Z);i=le(i),e-=Z;for(var l=da(c,i);++o<e;)i(o);return l}function Gv(e){return we(e)?nt(e,Qr):wr(e)?[e]:cr(Oh(je(e)))}function Jv(e){var i=++op;return je(e)+i}var Qv=so(function(e,i){return e+i},0),Yv=Ma("ceil"),Xv=so(function(e,i){return e/i},1),Zv=Ma("floor");function e1(e){return e&&e.length?Xs(e,lr,Sa):r}function t1(e,i){return e&&e.length?Xs(e,le(i,2),Sa):r}function r1(e){return du(e,lr)}function i1(e,i){return du(e,le(i,2))}function n1(e){return e&&e.length?Xs(e,lr,Aa):r}function s1(e,i){return e&&e.length?Xs(e,le(i,2),Aa):r}var o1=so(function(e,i){return e*i},1),a1=Ma("round"),c1=so(function(e,i){return e-i},0);function u1(e){return e&&e.length?fa(e,lr):0}function h1(e,i){return e&&e.length?fa(e,le(i,2)):0}return p.after=Cm,p.ary=Lh,p.assign=w0,p.assignIn=Xh,p.assignInWith=wo,p.assignWith=b0,p.at=_0,p.before=Mh,p.bind=Ya,p.bindAll=Pv,p.bindKey=qh,p.castArray=km,p.chain=Fh,p.chunk=Zg,p.compact=ey,p.concat=ty,p.cond=Ov,p.conforms=Av,p.constant=nc,p.countBy=um,p.create=E0,p.curry=zh,p.curryRight=Hh,p.debounce=Bh,p.defaults=I0,p.defaultsDeep=S0,p.defer=$m,p.delay=Dm,p.difference=ry,p.differenceBy=iy,p.differenceWith=ny,p.drop=sy,p.dropRight=oy,p.dropRightWhile=ay,p.dropWhile=cy,p.fill=uy,p.filter=lm,p.flatMap=pm,p.flatMapDeep=gm,p.flatMapDepth=ym,p.flatten=Nh,p.flattenDeep=hy,p.flattenDepth=ly,p.flip=Fm,p.flow=Tv,p.flowRight=Nv,p.fromPairs=fy,p.functions=N0,p.functionsIn=C0,p.groupBy=mm,p.initial=py,p.intersection=gy,p.intersectionBy=yy,p.intersectionWith=my,p.invert=D0,p.invertBy=F0,p.invokeMap=wm,p.iteratee=sc,p.keyBy=bm,p.keys=Mt,p.keysIn=hr,p.map=fo,p.mapKeys=j0,p.mapValues=L0,p.matches=Cv,p.matchesProperty=$v,p.memoize=go,p.merge=M0,p.mergeWith=Zh,p.method=Dv,p.methodOf=Fv,p.mixin=oc,p.negate=yo,p.nthArg=jv,p.omit=q0,p.omitBy=z0,p.once=Um,p.orderBy=_m,p.over=Lv,p.overArgs=jm,p.overEvery=Mv,p.overSome=qv,p.partial=Xa,p.partialRight=kh,p.partition=Em,p.pick=H0,p.pickBy=el,p.property=al,p.propertyOf=zv,p.pull=_y,p.pullAll=$h,p.pullAllBy=Ey,p.pullAllWith=Iy,p.pullAt=Sy,p.range=Hv,p.rangeRight=Bv,p.rearg=Lm,p.reject=xm,p.remove=xy,p.rest=Mm,p.reverse=Ja,p.sampleSize=Om,p.set=k0,p.setWith=K0,p.shuffle=Am,p.slice=Py,p.sortBy=Nm,p.sortedUniq=$y,p.sortedUniqBy=Dy,p.split=pv,p.spread=qm,p.tail=Fy,p.take=Uy,p.takeRight=jy,p.takeRightWhile=Ly,p.takeWhile=My,p.tap=em,p.throttle=zm,p.thru=lo,p.toArray=Jh,p.toPairs=tl,p.toPairsIn=rl,p.toPath=Gv,p.toPlainObject=Yh,p.transform=V0,p.unary=Hm,p.union=qy,p.unionBy=zy,p.unionWith=Hy,p.uniq=By,p.uniqBy=ky,p.uniqWith=Ky,p.unset=W0,p.unzip=Qa,p.unzipWith=Dh,p.update=G0,p.updateWith=J0,p.values=bn,p.valuesIn=Q0,p.without=Vy,p.words=sl,p.wrap=Bm,p.xor=Wy,p.xorBy=Gy,p.xorWith=Jy,p.zip=Qy,p.zipObject=Yy,p.zipObjectDeep=Xy,p.zipWith=Zy,p.entries=tl,p.entriesIn=rl,p.extend=Xh,p.extendWith=wo,oc(p,p),p.add=Qv,p.attempt=ol,p.camelCase=ev,p.capitalize=il,p.ceil=Yv,p.clamp=Y0,p.clone=Km,p.cloneDeep=Wm,p.cloneDeepWith=Gm,p.cloneWith=Vm,p.conformsTo=Jm,p.deburr=nl,p.defaultTo=Rv,p.divide=Xv,p.endsWith=tv,p.eq=Lr,p.escape=rv,p.escapeRegExp=iv,p.every=hm,p.find=fm,p.findIndex=Rh,p.findKey=x0,p.findLast=dm,p.findLastIndex=Th,p.findLastKey=P0,p.floor=Zv,p.forEach=Uh,p.forEachRight=jh,p.forIn=O0,p.forInRight=A0,p.forOwn=R0,p.forOwnRight=T0,p.get=tc,p.gt=Qm,p.gte=Ym,p.has=$0,p.hasIn=rc,p.head=Ch,p.identity=lr,p.includes=vm,p.indexOf=dy,p.inRange=X0,p.invoke=U0,p.isArguments=Ki,p.isArray=we,p.isArrayBuffer=Xm,p.isArrayLike=ur,p.isArrayLikeObject=_t,p.isBoolean=Zm,p.isBuffer=Oi,p.isDate=e0,p.isElement=t0,p.isEmpty=r0,p.isEqual=i0,p.isEqualWith=n0,p.isError=Za,p.isFinite=s0,p.isFunction=ai,p.isInteger=Kh,p.isLength=mo,p.isMap=Vh,p.isMatch=o0,p.isMatchWith=a0,p.isNaN=c0,p.isNative=u0,p.isNil=l0,p.isNull=h0,p.isNumber=Wh,p.isObject=ut,p.isObjectLike=mt,p.isPlainObject=Gn,p.isRegExp=ec,p.isSafeInteger=f0,p.isSet=Gh,p.isString=vo,p.isSymbol=wr,p.isTypedArray=wn,p.isUndefined=d0,p.isWeakMap=p0,p.isWeakSet=g0,p.join=vy,p.kebabCase=nv,p.last=Tr,p.lastIndexOf=wy,p.lowerCase=sv,p.lowerFirst=ov,p.lt=y0,p.lte=m0,p.max=e1,p.maxBy=t1,p.mean=r1,p.meanBy=i1,p.min=n1,p.minBy=s1,p.stubArray=cc,p.stubFalse=uc,p.stubObject=kv,p.stubString=Kv,p.stubTrue=Vv,p.multiply=o1,p.nth=by,p.noConflict=Uv,p.noop=ac,p.now=po,p.pad=av,p.padEnd=cv,p.padStart=uv,p.parseInt=hv,p.random=Z0,p.reduce=Im,p.reduceRight=Sm,p.repeat=lv,p.replace=fv,p.result=B0,p.round=a1,p.runInContext=D,p.sample=Pm,p.size=Rm,p.snakeCase=dv,p.some=Tm,p.sortedIndex=Oy,p.sortedIndexBy=Ay,p.sortedIndexOf=Ry,p.sortedLastIndex=Ty,p.sortedLastIndexBy=Ny,p.sortedLastIndexOf=Cy,p.startCase=gv,p.startsWith=yv,p.subtract=c1,p.sum=u1,p.sumBy=h1,p.template=mv,p.times=Wv,p.toFinite=ci,p.toInteger=be,p.toLength=Qh,p.toLower=vv,p.toNumber=Nr,p.toSafeInteger=v0,p.toString=je,p.toUpper=wv,p.trim=bv,p.trimEnd=_v,p.trimStart=Ev,p.truncate=Iv,p.unescape=Sv,p.uniqueId=Jv,p.upperCase=xv,p.upperFirst=ic,p.each=Uh,p.eachRight=jh,p.first=Ch,oc(p,function(){var e={};return Gr(p,function(i,o){Me.call(p.prototype,o)||(e[o]=i)}),e}(),{chain:!1}),p.VERSION=s,xr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){p[e].placeholder=p}),xr(["drop","take"],function(e,i){Oe.prototype[e]=function(o){o=o===r?1:Ut(be(o),0);var c=this.__filtered__&&!i?new Oe(this):this.clone();return c.__filtered__?c.__takeCount__=Wt(o,c.__takeCount__):c.__views__.push({size:Wt(o,Z),type:e+(c.__dir__<0?"Right":"")}),c},Oe.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),xr(["filter","map","takeWhile"],function(e,i){var o=i+1,c=o==I||o==ie;Oe.prototype[e]=function(l){var m=this.clone();return m.__iteratees__.push({iteratee:le(l,3),type:o}),m.__filtered__=m.__filtered__||c,m}}),xr(["head","last"],function(e,i){var o="take"+(i?"Right":"");Oe.prototype[e]=function(){return this[o](1).value()[0]}}),xr(["initial","tail"],function(e,i){var o="drop"+(i?"":"Right");Oe.prototype[e]=function(){return this.__filtered__?new Oe(this):this[o](1)}}),Oe.prototype.compact=function(){return this.filter(lr)},Oe.prototype.find=function(e){return this.filter(e).head()},Oe.prototype.findLast=function(e){return this.reverse().find(e)},Oe.prototype.invokeMap=Se(function(e,i){return typeof e=="function"?new Oe(this):this.map(function(o){return Hn(o,e,i)})}),Oe.prototype.reject=function(e){return this.filter(yo(le(e)))},Oe.prototype.slice=function(e,i){e=be(e);var o=this;return o.__filtered__&&(e>0||i<0)?new Oe(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),i!==r&&(i=be(i),o=i<0?o.dropRight(-i):o.take(i-e)),o)},Oe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Oe.prototype.toArray=function(){return this.take(Z)},Gr(Oe.prototype,function(e,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),c=/^(?:head|last)$/.test(i),l=p[c?"take"+(i=="last"?"Right":""):i],m=c||/^find/.test(i);l&&(p.prototype[i]=function(){var x=this.__wrapped__,O=c?[1]:arguments,F=x instanceof Oe,k=O[0],K=F||we(x),G=function(xe){var Re=l.apply(p,bi([xe],O));return c&&te?Re[0]:Re};K&&o&&typeof k=="function"&&k.length!=1&&(F=K=!1);var te=this.__chain__,ce=!!this.__actions__.length,fe=m&&!te,Ee=F&&!ce;if(!m&&K){x=Ee?x:new Oe(this);var de=e.apply(x,O);return de.__actions__.push({func:lo,args:[G],thisArg:r}),new Or(de,te)}return fe&&Ee?e.apply(this,O):(de=this.thru(G),fe?c?de.value()[0]:de.value():de)})}),xr(["pop","push","shift","sort","splice","unshift"],function(e){var i=js[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);p.prototype[e]=function(){var l=arguments;if(c&&!this.__chain__){var m=this.value();return i.apply(we(m)?m:[],l)}return this[o](function(x){return i.apply(we(x)?x:[],l)})}}),Gr(Oe.prototype,function(e,i){var o=p[i];if(o){var c=o.name+"";Me.call(pn,c)||(pn[c]=[]),pn[c].push({name:i,func:o})}}),pn[no(r,he).name]=[{name:"wrapper",func:r}],Oe.prototype.clone=Sp,Oe.prototype.reverse=xp,Oe.prototype.value=Pp,p.prototype.at=tm,p.prototype.chain=rm,p.prototype.commit=im,p.prototype.next=nm,p.prototype.plant=om,p.prototype.reverse=am,p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=cm,p.prototype.first=p.prototype.head,Fn&&(p.prototype[Fn]=sm),p},ln=ip();bt?((bt.exports=ln)._=ln,We._=ln):Ae._=ln}).call(ts)})(Mc,Mc.exports);var qS=Object.defineProperty,zS=Object.defineProperties,HS=Object.getOwnPropertyDescriptors,xf=Object.getOwnPropertySymbols,BS=Object.prototype.hasOwnProperty,kS=Object.prototype.propertyIsEnumerable,Pf=(n,t,r)=>t in n?qS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,So=(n,t)=>{for(var r in t||(t={}))BS.call(t,r)&&Pf(n,r,t[r]);if(xf)for(var r of xf(t))kS.call(t,r)&&Pf(n,r,t[r]);return n},KS=(n,t)=>zS(n,HS(t));function Ti(n,t,r){var s;const a=TS(n);return((s=t.rpcMap)==null?void 0:s[a.reference])||`${MS}?chainId=${a.namespace}:${a.reference}&projectId=${r}`}function Zi(n){return n.includes(":")?n.split(":")[1]:n}function Cd(n){return n.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function VS(n,t){const r=Object.keys(t.namespaces).filter(a=>a.includes(n));if(!r.length)return[];const s=[];return r.forEach(a=>{const h=t.namespaces[a].accounts;s.push(...h)}),s}function WS(n={},t={}){const r=Of(n),s=Of(t);return Mc.exports.merge(r,s)}function Of(n){var t,r,s,a;const h={};if(!CS(n))return h;for(const[d,v]of Object.entries(n)){const P=au(d)?[d]:v.chains,_=v.methods||[],S=v.events||[],A=v.rpcMap||{},j=is(d);h[j]=KS(So(So({},h[j]),v),{chains:Ic(P,(t=h[j])==null?void 0:t.chains),methods:Ic(_,(r=h[j])==null?void 0:r.methods),events:Ic(S,(s=h[j])==null?void 0:s.events),rpcMap:So(So({},A),(a=h[j])==null?void 0:a.rpcMap)})}return h}function GS(n){return n.includes(":")?n.split(":")[2]:n}function JS(n){const t={};for(const[r,s]of Object.entries(n)){const a=s.methods||[],h=s.events||[],d=s.accounts||[],v=au(r)?[r]:s.chains?s.chains:Cd(s.accounts);t[r]={chains:v,methods:a,events:h,accounts:d}}return t}function Sc(n){return typeof n=="number"?n:n.includes("0x")?parseInt(n,16):n.includes(":")?Number(n.split(":")[1]):Number(n)}const $d={},st=n=>$d[n],xc=(n,t)=>{$d[n]=t};class QS{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Zi(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ti(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ni(s,st("disableProviderPing")))}}class YS{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||Ti(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ni(s,st("disableProviderPing")))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=parseInt(Zi(r));t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,s;let a=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const h=parseInt(a,16);if(this.isChainApproved(h))this.setDefaultChain(`${h}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:a}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${h}`);else throw new Error(`Failed to switch to chain 'eip155:${h}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class XS{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Zi(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ti(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ni(s,st("disableProviderPing")))}}class ZS{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Zi(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ti(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ni(s,st("disableProviderPing")))}}class ex{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r),a=Zi(r);t[a]=this.createHttpProvider(a,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ni(s,st("disableProviderPing")))}}class tx{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Zi(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ti(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ni(s,st("disableProviderPing")))}}class rx{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Zi(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ti(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ni(s,st("disableProviderPing")))}}class ix{constructor(t){this.name="near",this.namespace=t.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||Ti(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ti(t,this.namespace);return typeof s>"u"?void 0:new gi(new Ni(s,st("disableProviderPing")))}}var nx=Object.defineProperty,sx=Object.defineProperties,ox=Object.getOwnPropertyDescriptors,Af=Object.getOwnPropertySymbols,ax=Object.prototype.hasOwnProperty,cx=Object.prototype.propertyIsEnumerable,Rf=(n,t,r)=>t in n?nx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,xo=(n,t)=>{for(var r in t||(t={}))ax.call(t,r)&&Rf(n,r,t[r]);if(Af)for(var r of Af(t))cx.call(t,r)&&Rf(n,r,t[r]);return n},Pc=(n,t)=>sx(n,ox(t));class cu{constructor(t){this.events=new Wc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Te.pino(Te.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||If})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new cu(t);return await r.initialize(),r}async request(t,r){const[s,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:xo({},t),chainId:`${s}:${a}`,topic:this.session.topic})}sendAsync(t,r,s){this.request(t,s).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:vf("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(h=>{this.session=h,this.namespaces||(this.namespaces=JS(h.namespaces),this.persist("namespaces",this.namespaces))}).catch(h=>{if(h.message!==Td)throw h;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[s,a]=this.validateChain(t);this.getProvider(s).setDefaultChain(a,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(wf(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await OS.init({logger:this.providerOpts.logger||If,relayUrl:this.providerOpts.relayUrl||US,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>is(r)))];xc("client",this.client),xc("events",this.events),xc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const s=VS(r,this.session),a=Cd(s),h=WS(this.namespaces,this.optionalNamespaces),d=Pc(xo({},h[r]),{accounts:s,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new YS({namespace:d});break;case"solana":this.rpcProviders[r]=new XS({namespace:d});break;case"cosmos":this.rpcProviders[r]=new ZS({namespace:d});break;case"polkadot":this.rpcProviders[r]=new QS({namespace:d});break;case"cip34":this.rpcProviders[r]=new ex({namespace:d});break;case"elrond":this.rpcProviders[r]=new tx({namespace:d});break;case"multiversx":this.rpcProviders[r]=new rx({namespace:d});break;case"near":this.rpcProviders[r]=new ix({namespace:d});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;if(s.name==="accountsChanged"){const a=s.data;a&&wf(a)&&this.events.emit("accountsChanged",a.map(GS))}else if(s.name==="chainChanged"){const a=r.chainId,h=r.event.data,d=is(a),v=Sc(a)!==Sc(h)?`${d}:${Sc(h)}`:a;this.onChainChanged(v)}else this.events.emit(s.name,s.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:a}=r,h=(s=this.client)==null?void 0:s.session.get(t);this.session=Pc(xo({},h),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Pc(xo({},vf("USER_DISCONNECTED")),{data:t.topic}))}),this.on(yi.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:a}=t;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(d=>is(d)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const a=is(Object.keys(this.namespaces)[0]),h=this.rpcProviders[a].getDefaultChain();return[a,h]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var s;if(!this.namespaces)return;const[a,h]=this.validateChain(t);r||this.getProvider(a).setDefaultChain(h),((s=this.namespaces[a])!=null?s:this.namespaces[`${a}:${h}`]).defaultChain=h,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",h)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${Sf}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${Sf}/${t}`)}}const ux=cu,hx="wc",lx="ethereum_provider",fx=`${hx}@2:${lx}:`,dx="https://rpc.walletconnect.com/v1/",qc=["eth_sendTransaction","personal_sign"],px=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],zc=["chainChanged","accountsChanged"],gx=["chainChanged","accountsChanged","message","disconnect","connect"];var yx=Object.defineProperty,mx=Object.defineProperties,vx=Object.getOwnPropertyDescriptors,Tf=Object.getOwnPropertySymbols,wx=Object.prototype.hasOwnProperty,bx=Object.prototype.propertyIsEnumerable,Nf=(n,t,r)=>t in n?yx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,ns=(n,t)=>{for(var r in t||(t={}))wx.call(t,r)&&Nf(n,r,t[r]);if(Tf)for(var r of Tf(t))bx.call(t,r)&&Nf(n,r,t[r]);return n},Cf=(n,t)=>mx(n,vx(t));function Do(n){return Number(n[0].split(":")[1])}function Oc(n){return`0x${n.toString(16)}`}function _x(n){const{chains:t,optionalChains:r,methods:s,optionalMethods:a,events:h,optionalEvents:d,rpcMap:v}=n;if(!Rc(t))throw new Error("Invalid chains");const P={chains:t,methods:s||qc,events:h||zc,rpcMap:ns({},t.length?{[Do(t)]:v[Do(t)]}:{})},_=h==null?void 0:h.filter(B=>!zc.includes(B)),S=s==null?void 0:s.filter(B=>!qc.includes(B));if(!r&&!d&&!a&&!(_!=null&&_.length)&&!(S!=null&&S.length))return{required:t.length?P:void 0};const A=(_==null?void 0:_.length)&&(S==null?void 0:S.length)||!r,j={chains:[...new Set(A?P.chains.concat(r||[]):r)],methods:[...new Set(P.methods.concat(a!=null&&a.length?a:px))],events:[...new Set(P.events.concat(d!=null&&d.length?d:gx))],rpcMap:v};return{required:t.length?P:void 0,optional:r.length?j:void 0}}class uu{constructor(){this.events=new $r.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=fx,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new uu;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:s}=_x(this.rpc);try{const a=await new Promise(async(d,v)=>{var P;this.rpc.showQrModal&&((P=this.modal)==null||P.subscribeModal(_=>{!_.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),v(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Cf(ns({namespaces:ns({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(_=>{d(_)}).catch(_=>{v(new Error(_.message))})});if(!a)return;const h=B1(a.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:h),this.setAccounts(h),this.events.emit("connect",{chainId:Oc(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",Oc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",Cf(ns({},K1("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Oc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,s,a]=t.split(":");return{chainId:`${r}:${s}`,address:a}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;const a=(r=t==null?void 0:t.chains)!=null?r:[],h=(s=t==null?void 0:t.optionalChains)!=null?s:[],d=a.concat(h);if(!d.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const v=a.length?(t==null?void 0:t.methods)||qc:[],P=a.length?(t==null?void 0:t.events)||zc:[],_=(t==null?void 0:t.optionalMethods)||[],S=(t==null?void 0:t.optionalEvents)||[],A=(t==null?void 0:t.rpcMap)||this.buildRpcMap(d,t.projectId),j=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map(B=>this.formatChainId(B)),optionalChains:h.map(B=>this.formatChainId(B)),methods:v,events:P,optionalMethods:_,optionalEvents:S,rpcMap:A,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:j,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const s={};return t.forEach(a=>{s[a]=this.getRpcUrl(a,r)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Do(this.rpc.chains):Do(this.rpc.optionalChains),this.signer=await ux.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await O1(()=>import("./index-eb0593a8.js").then(a=>a.i),["assets/index-eb0593a8.js","assets/index-1e3b5e9c.js","assets/index-5aaf2e1f.css"]);r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(ns({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:s,rpcMap:a}=t;r&&Rc(r)&&(this.rpc.chains=r.map(h=>this.formatChainId(h)),r.forEach(h=>{this.rpc.rpcMap[h]=(a==null?void 0:a[h])||this.getRpcUrl(h)})),s&&Rc(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(h=>this.formatChainId(h)),s.forEach(h=>{this.rpc.rpcMap[h]=(a==null?void 0:a[h])||this.getRpcUrl(h)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${dx}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const qx=uu;export{qx as EthereumProvider,gx as OPTIONAL_EVENTS,px as OPTIONAL_METHODS,zc as REQUIRED_EVENTS,qc as REQUIRED_METHODS,uu as default};
