import{an as V,a_ as J,bf as ae,b1 as se,a$ as me,ag as f,b0 as ge,bx as D,ad as xe,cJ as Ce,$ as he,b4 as ye,bz as we,au as p,av as E,aH as t,b5 as o,ah as e,a4 as B,aF as k,bj as ee,bA as G,aE as C,bd as K,ck as qe,bc as U,bk as O,b3 as A,b9 as be,ba as ke,at as X,b2 as Se,aY as Y,b7 as re,b6 as te,bC as ie,bb as Q,b8 as Ue,bB as Ae,bi as Ee}from"./index-1e3b5e9c.js";import{B as Z}from"./battle-pool-contract-service-be03c21e.js";import{C as Fe}from"./contract-api-service-fb5a844b.js";import{P as Me,a as Ne}from"./bignumber-c053b17e.js";import{i as $e,e as Te}from"./regexp-d43f6901.js";import{T}from"./publicUnit-82a6e2b0.js";import{N as je}from"./index-1a12df55.js";import{M as He,N as Re}from"./match-service-ebe62e39.js";import{_ as de}from"./index.vue_vue_type_script_setup_true_lang-d51c3f46.js";import{E as We}from"./erc721-service-bd0ec81e.js";import{R as fe,C as ve}from"./index-1f6fe659.js";import"./transaction-api-service-8b388dbb.js";import"./utils-518c8eb5.js";import"./contract-data-service-bee1e717.js";import"./index-f42bfe17.js";import"./firstNotUndefined-748ee901.js";import"./match-utils-793d0e6d.js";import"./battle-contract-service-bdced59b.js";import"./match-api-service-85ee51bf.js";import"./match-data-ext-5e1df082.js";import"./nft-data-00f9cd4d.js";import"./challenge-api-service-8347c7e6.js";import"./constants-2bfeaeae.js";import"./Col-006999ba.js";import"./responsiveObserve-f3a612e5.js";import"./useFlexGapSupport-f4e16cef.js";const ne=w=>(be("data-v-92c4c13f"),w=w(),ke(),w),De={class:"relative ethBox"},Le={class:"flex flex-col my-5 pc"},Pe={class:"flex"},Ve={class:"w-3/12 text-xs f-1 font-pf"},Xe=ne(()=>t("p",{class:"w-1/12"},null,-1)),ze={class:"flex items-center justify-between w-4/12 text-xs f-1 font-pf"},Ge=ne(()=>t("p",{class:"w-1/12"},null,-1)),Ke={class:"w-3/12 text-xs f-1 font-pf"},Oe={class:"flex mt-[15px]"},Je={class:"flex items-center text-xl text-white h-[44px] w-3/12"},Ye={class:"flex items-center justify-center w-1/12 pb-3 text-2xl font-black f-1"},Qe={class:"flex items-center w-4/12"},Ze=ne(()=>t("p",{class:"flex items-center justify-center w-1/12 pb-3 text-2xl font-black f-1"},"=",-1)),et={class:"flex items-center text-xl text-white h-[44px] w-3/12"},tt={class:"mobile"},at={class:"balance"},st={class:"title"},nt={class:"number"},ot={class:"amount_manage"},lt={class:"title"},ct={class:"number"},ut={class:"input"},rt={class:"account_balance"},it={class:"title"},dt={class:"number"},ft={class:"absolute space-y-3 -translate-x-1/2 submit bottom-[10px] left-1/2"},vt=V({__name:"ETH",setup(w){const{t:a}=J(),n=ae(),v=se(),l=me(),r=f(0),_=f(0),c=f(0),M=f(0),b=f(!1);let q=f("");const{open:I}=ge(),m=D.debounce(g=>{g==""||$e.test(Te(g))?q.value=g:c.value=q.value,n.query.type=="1"?M.value=Me(_.value,c.value):n.query.type=="2"&&(M.value=Ne(_.value,c.value))},0),h=D.throttle(()=>{n.query.type=="1"?c.value=r.value:n.query.type=="2"&&(c.value=_.value),m(c.value+"")},200);xe(async()=>{if(!l.address){I();return}Ce({address:l.address,chainId:he()}).then(g=>{r.value=Number(g.formatted)}),Z.connect().then(g=>{g.getUserBalance(l.address).then(s=>{_.value=s,M.value=s})})});const F=async g=>{if(b.value=!0,g=="1")try{if(!l.address){I();return}if(c.value<=0||M.value<0){b.value=!1;return}if(c.value>r.value){A(a("views.account.amountManage.t24",{unit:T}),"warning",!1),b.value=!1;return}const s=await Z.connect(),x=c.value,j=await s.deposit(x);await s.waitForTransaction(j),b.value=!1,A(a("views.account.amountManage.t15"),"success",!1,2,()=>{v.go(0)})}catch{b.value=!1}else if(g=="2")try{if(!l.address){b.value=!1,I();return}if(M.value<0){A(a("views.account.amountManage.t25"),"warning",!1),b.value=!1;return}if(c.value<=0){b.value=!1;return}const s=await Z.connect(),x=await s.getUserNonce(l.address),H=await new Fe().getWithdrawSignature(l.address,c.value,x),R=await s.withdraw(c.value,H);await s.waitForTransaction(R),A(a("views.account.amountManage.t17"),"success",!1,2,()=>{v.go(0)})}catch(s){A(s.message,"error",!1)}finally{b.value=!1}};return ye(()=>{c.value=0}),(g,s)=>{var j,H,R,L,S,W;const x=we("loading");return p(),E("div",De,[t("div",Le,[t("div",Pe,[t("p",Ve,o(e(a)("views.account.amountManage.t4",{unit:e(T)})),1),Xe,t("p",ze,[t("span",null,o(((j=e(n).query)==null?void 0:j.type)=="2"?e(a)("views.account.amountManage.t5",{unit:e(T)}):e(a)("views.account.amountManage.t5_1",{unit:e(T)})),1),t("span",null,o(e(a)("views.account.amountManage.t6"))+"："+o(r.value),1)]),Ge,t("p",Ke,o(((H=e(n).query)==null?void 0:H.type)=="2"?e(a)("views.account.amountManage.t7"):e(a)("views.account.amountManage.t7_1")),1)]),t("div",Oe,[t("p",Je,o(_.value),1),t("p",Ye,o(g.$route.query.type=="1"?"+":"-"),1),t("div",Qe,[B(e(ee),{value:c.value,"onUpdate:value":s[1]||(s[1]=y=>c.value=y),class:"w-[300px] text-white bg-black border-0 rounded-none h-[44px] flex item-center items-center",bordered:!1,controls:!1,placeholder:e(a)("views.account.amountManage.t8"),onInput:s[2]||(s[2]=y=>e(m)(y.target.value))},{addonAfter:k(()=>[t("span",{class:"text-base cursor-pointer font-autom font-primary",onClick:s[0]||(s[0]=(...y)=>e(h)&&e(h)(...y))},"MAX")]),_:1},8,["value","placeholder"])]),Ze,t("p",et,o(M.value||0)+" "+o(e(T)),1)])]),t("div",tt,[t("div",at,[t("div",st,o(e(a)("views.account.amountManage.t4",{unit:e(T)})),1),t("div",nt,o(_.value),1)]),t("div",ot,[t("div",lt,o(((R=e(n).query)==null?void 0:R.type)=="2"?e(a)("views.account.amountManage.t5",{unit:e(T)}):e(a)("views.account.amountManage.t5_1",{unit:e(T)})),1),t("div",ct,o(e(a)("views.account.amountManage.t6"))+"："+o(r.value),1)]),t("div",ut,[B(e(ee),{value:c.value,"onUpdate:value":s[4]||(s[4]=y=>c.value=y),class:"w-[300px] text-white bg-black border-0 rounded-none h-[44px] flex item-center items-center",bordered:!1,controls:!1,placeholder:e(a)("views.account.amountManage.t8"),onInput:s[5]||(s[5]=y=>e(m)(y.target.value))},{addonAfter:k(()=>[t("span",{class:"text-base cursor-pointer font-autom font-primary",onClick:s[3]||(s[3]=(...y)=>e(h)&&e(h)(...y))},"MAX")]),_:1},8,["value","placeholder"])]),t("div",rt,[t("div",it,o(((L=e(n).query)==null?void 0:L.type)=="2"?e(a)("views.account.amountManage.t7"):e(a)("views.account.amountManage.t7_1")),1),t("div",dt,o(M.value||0)+" "+o(e(T)),1)])]),t("div",ft,[G((p(),C(e(O),{onClick:s[6]||(s[6]=y=>{var z;return F((z=e(n).query)==null?void 0:z.type)}),class:U(["rounded-none",((S=e(n).query)==null?void 0:S.type)=="1"&&(c.value<=0||c.value>r.value)||((W=e(n).query)==null?void 0:W.type)=="2"&&(M.value<0||c.value<=0)?" can_click":"click"])},{default:k(()=>{var y;return[K(o(((y=g.$route.query)==null?void 0:y.type)=="1"?e(a)("views.account.amountManage.t9_1"):e(a)("views.account.amountManage.t9"))+" "+o(e(qe)(c.value)||0)+" "+o(e(T)),1)]}),_:1},8,["class"])),[[x,b.value]])])])}}});const _t=X(vt,[["__scopeId","data-v-92c4c13f"]]),pt=w=>(be("data-v-d2e6efe5"),w=w(),ke(),w),mt={class:"relative burnBox"},gt={class:"flex space-x-10"},xt={class:"text-xs f-1 font-pf"},ht={class:"flex items-center text-lg text-white m1"},yt={class:"flex items-end"},wt={class:"flex items-center text-lg m1 f-1"},bt={class:"flex items-center justify-between text-xs f-1 font-pf"},kt={class:"flex items-center m1"},Mt=pt(()=>t("section",{class:"flex items-end"},[t("p",{class:"flex items-center text-lg m1 f-1"},"=")],-1)),Nt={class:"text-xs f-1 font-pf"},$t={class:"flex items-center text-lg text-white m1"},Tt={class:"mx-auto mt-16 mb-8 submit"},It=V({__name:"BURN",setup(w){const{t:a}=J(),n=ae(),v=f(0),l=f(0),r=f(0),_=f(10),c=f(!1);let M=f("");const b=D.debounce(m=>{m==""||$e.test(Te(m))?M.value=m:v.value=M.value,n.query.type=="1"?l.value=Me(r.value,v.value):n.query.type=="2"&&(l.value=Ne(r.value,v.value))},0),q=D.throttle(()=>{n.query.type=="1"?v.value=_.value:n.query.type=="2"&&(v.value=r.value),b(v.value+"")},200),I=m=>{};return ye(()=>{v.value=0}),(m,h)=>{var g,s;const F=we("loading");return p(),E("div",mt,[t("div",gt,[t("section",null,[t("p",xt,o(e(a)("views.account.amountManage.t10")),1),t("p",ht,o(r.value),1)]),t("section",yt,[t("p",wt,o(m.$route.query.type=="1"?"+":"-"),1)]),t("section",null,[t("p",bt,[t("span",null,o(((g=m.$route.query)==null?void 0:g.type)=="2"?e(a)("views.account.amountManage.t11"):e(a)("views.account.amountManage.t11_1")),1),t("span",null,o(e(a)("views.account.amountManage.t6"))+"："+o(_.value),1)]),t("div",kt,[B(e(ee),{value:v.value,"onUpdate:value":h[1]||(h[1]=x=>v.value=x),class:"text-white bg-black border-0 rounded-none",bordered:!1,controls:!1,placeholder:e(a)("views.account.amountManage.t8"),onInput:h[2]||(h[2]=x=>e(b)(x.target.value))},{addonAfter:k(()=>[t("span",{class:"text-base cursor-pointer font-autom font-primary",onClick:h[0]||(h[0]=(...x)=>e(q)&&e(q)(...x))},"MAX ")]),_:1},8,["value","placeholder"])])]),Mt,t("section",null,[t("p",Nt,o(((s=m.$route.query)==null?void 0:s.type)=="2"?e(a)("views.account.amountManage.t7"):e(a)("views.account.amountManage.t7_1")),1),t("p",$t,o(l.value||0)+" BURN",1)])]),t("div",Tt,[G((p(),C(e(O),{class:U(["flex items-center justify-center w-full font-semibold text-black border-0 rounded-none text-[17px]",v.value<=0||v.value>_.value||l.value<0?" bg-[#333333] rounded-sm cursor-not-allowed nhover":"bg-primary ohover"]),style:{color:"#000"},onClick:h[3]||(h[3]=x=>I(m.$route.query.type))},{default:k(()=>{var x;return[K(o(((x=m.$route.query)==null?void 0:x.type)=="2"?e(a)("views.account.amountManage.t9"):e(a)("views.account.amountManage.t9_1"))+" "+o(v.value||0)+" BURN ",1)]}),_:1},8,["class"])),[[F,c.value]])])])}}});const Bt=X(It,[["__scopeId","data-v-d2e6efe5"]]),Ct={class:"relative nftItem"},qt=V({__name:"NFTItem",props:{data:{type:Object,default:()=>{}}},emits:["update:checked"],setup(w,{emit:a}){return se(),(n,v)=>{var l,r,_;return p(),E("div",Ct,[B(je,{img:(l=w.data)==null?void 0:l.imageUri,name:(r=w.data)==null?void 0:r.metaName,koNum:(_=w.data)==null?void 0:_.koScore,styleKo:{color:"#BBF74C"},color:"#000"},null,8,["img","name","koNum"])])}}});const _e=X(qt,[["__scopeId","data-v-7c4721b8"]]),St={class:"flex flex-col space-y-3 nftBox"},Ut={key:0,class:"flex flex-col"},At={class:"flex-shrink-0 pb-[18px] f-1 font-pf m_title"},Et={class:"text-[#666] text-center text-lg"},Ft={key:1,class:"flex flex-col"},jt={class:"flex-shrink-0 pb-[18px] f-1 font-pf m_title"},Ht={class:"text-[#666] text-center text-lg"},Rt={class:"absolute left-0 flex items-end justify-center w-full submit"},pe=180,Wt=5,Dt=V({__name:"NFT",setup(w){var ue;const{t:a}=J(),{chain:n}=Se(),v=f(!1),l=f(!1),r=me(),_=f([]),c=f([]),M=ae(),b=se(),q=new Ue,I=f(-1),m=f(),h=f(!1),F=f(!1),g=f();let s=20;const x=f(!0),j=f(!0),H=f(0),R=f(0),{open:L}=ge(),S=f(!0);xe(()=>{Be(),y()});const W=((ue=M.query)==null?void 0:ue.type)=="2";async function y(){if(!r.address||!n){L();return}v.value=!0,W?q.getMyAddressNft(r.address,{start:0,length:s,accountType:"BURN",chainId:n==null?void 0:n.id}).then(i=>{i.map(u=>u.checked=!1),c.value=i,v.value=!1}).catch(i=>{v.value=!1,console.error(i)}):q.getMyAddressNft(r.address,{start:0,length:s,accountType:"WALLET",chainId:n==null?void 0:n.id}).then(i=>{i.map(u=>u.checked=!1),_.value=i,v.value=!1}).catch(i=>{v.value=!1,console.error(i)})}const z=async()=>{if(l.value=!0,!r.address){l.value=!1,L();return}const i=he();if(!m.value){A(a("views.account.amountManage.t18"),"error",!1),l.value=!1;return}if(!await Ae(r.address,i)){A(a("views.account.amountManage.t20",{unit:T}),"error",!1),l.value=!1;return}const{nftAddress:u,nftTokenId:N}=m.value;He.redeem(i,r.address,u,N).then(async d=>{console.log(d),l.value=!1,A(a("views.account.amountManage.t16"),"success",!1,2,()=>{b.go(0)})}).catch(d=>{console.error(d),l.value=!1})},Ie=async()=>{l.value=!0;try{const{nftAddress:i,nftTokenId:u}=m.value,N=await Re.connect(),$=await(await We.connect(i)).safeTransferFrom(r.address,N.getContractAddress(),u);await N.waitForTransaction($),A(a("views.account.amountManage.t14"),"success",!1,2,()=>{y()})}catch(i){A(i.message,"error",!1)}finally{l.value=!1}},oe=(i,u)=>{I.value=u,m.value=i},le=D.throttle(async i=>{var d;const u=i.target,N=u.scrollTop+u.clientHeight>=u.scrollHeight;if(console.log(u.scrollTop,u.clientHeight,u.scrollHeight,x.value,S.value),N&&x.value&&S.value){h.value=!0,S.value=!1;const $=await q.getMyAddressNft(r.address,{start:s+s*H.value,length:s,accountType:"WALLET",chainId:n==null?void 0:n.id});H.value+=1,$.length==0&&(x.value=!1,h.value=!1),_.value=(d=_.value)==null?void 0:d.concat($),h.value=!1,S.value=!0}},300),ce=D.throttle(async i=>{var d;const u=i.target;if(u.scrollTop+u.clientHeight>=u.scrollHeight&&j.value&&S.value){S.value=!1,F.value=!0;const $=await q.getMyAddressNft(r.address,{start:s+s*R.value,length:s,accountType:"BURN",chainId:n==null?void 0:n.id});R.value+=1,$.length==0&&(j.value=!1,F.value=!1),c.value=(d=c.value)==null?void 0:d.concat($),F.value=!1,S.value=!0}},300),Be=()=>{var u;const i=(u=g.value)==null?void 0:u.offsetHeight;i&&pe&&(s=(Math.ceil(i/pe)+1)*Wt)};return(i,u)=>(p(),E(Y,null,[t("div",St,[W?(p(),E("div",Ft,[t("p",jt,o(e(a)("views.account.amountManage.t12")),1),B(e(Q),{spinning:v.value},{default:k(()=>{var N;return[t("section",{class:U(["grow content_r",c.value.length?"":"fja"]),onScroll:u[1]||(u[1]=(...d)=>e(ce)&&e(ce)(...d))},[B(e(fe),{gutter:[10,10]},{default:k(()=>[(p(!0),E(Y,null,re(c.value,(d,$)=>(p(),C(e(ve),{md:4,xs:12,key:d},{default:k(()=>[B(_e,{checked:d.checked,"onUpdate:checked":P=>d.checked=P,data:d,class:U([I.value==$?"select":"","nft_item"]),onClick:P=>oe(d,$)},null,8,["checked","onUpdate:checked","data","class","onClick"])]),_:2},1024))),128))]),_:1}),(N=c.value)!=null&&N.length?te("",!0):(p(),C(de,{key:0})),G(t("div",Ht," loading... ",512),[[ie,F.value]])],34)]}),_:1},8,["spinning"])])):(p(),E("div",Ut,[t("p",At,o(e(a)("views.account.amountManage.t12_1")),1),B(e(Q),{spinning:v.value},{default:k(()=>{var N;return[t("section",{class:U(["grow content_r",_.value.length?"":"fja"]),onScroll:u[0]||(u[0]=(...d)=>e(le)&&e(le)(...d)),ref_key:"walletNftEle",ref:g},[B(e(fe),{gutter:[10,10]},{default:k(()=>[(p(!0),E(Y,null,re(_.value,(d,$)=>(p(),C(e(ve),{md:4,xs:12,key:d},{default:k(()=>[B(_e,{checked:d.checked,"onUpdate:checked":P=>d.checked=P,data:d,class:U([I.value==$?"select":"","nft_item"]),onClick:P=>oe(d,$)},null,8,["checked","onUpdate:checked","data","class","onClick"])]),_:2},1024))),128))]),_:1}),(N=_.value)!=null&&N.length?te("",!0):(p(),C(de,{key:0})),G(t("div",Et," loading... ",512),[[ie,h.value]])],34)]}),_:1},8,["spinning"])]))]),t("section",Rt,[B(e(Q),{spinning:l.value},{default:k(()=>[W?(p(),C(e(O),{key:1,class:U([{unSelect:I.value==-1},"flex text-[17px] items-center justify-center w-full font-semibold border-0 rounded-none bg-primary"]),onClick:z},{default:k(()=>[K(o(e(a)("views.account.amountManage.t13")),1)]),_:1},8,["class"])):(p(),C(e(O),{key:0,class:U([{unSelect:I.value==-1},"flex text-[17px] items-center justify-center w-full font-semibold border-0 rounded-none bg-primary"]),onClick:Ie},{default:k(()=>[K(o(e(a)("views.account.amountManage.t13_1")),1)]),_:1},8,["class"]))]),_:1},8,["spinning"])])],64))}});const Lt=X(Dt,[["__scopeId","data-v-f3c51427"]]),Pt={class:"px-[40px] py-[30px] amountMange"},Vt={class:"flex bg-black tabs h-[44px]"},Xt={class:"relative"},zt=V({__name:"index",setup(w){const{t:a}=J(),n=Ee({current:3});return(v,l)=>(p(),E("section",Pt,[t("section",Vt,[t("div",{class:U(["flex items-center justify-center w-1/2 h-full text-sm font-medium cursor-pointer t1 f-1",n.current==1?"t1-active font-primary":""]),onClick:l[0]||(l[0]=r=>n.current=1)},o(e(a)("views.account.amountManage.t1",{unit:e(T)})),3),te("",!0),t("div",{class:U(["flex items-center justify-center w-1/2 h-full text-sm font-medium cursor-pointer t1 f-1",n.current==3?"t1-active font-primary":""]),onClick:l[2]||(l[2]=r=>n.current=3)},o(e(a)("views.account.amountManage.t3")),3)]),t("section",Xt,[n.current==1?(p(),C(_t,{key:0})):n.current==2?(p(),C(Bt,{key:1})):(p(),C(Lt,{key:2}))])]))}});const ha=X(zt,[["__scopeId","data-v-192654f9"]]);export{ha as default};
