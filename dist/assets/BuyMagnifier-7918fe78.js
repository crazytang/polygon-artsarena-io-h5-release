var Q=Object.defineProperty;var X=(s,e,t)=>e in s?Q(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var O=(s,e,t)=>(X(s,typeof e!="symbol"?e+"":e,t),t);import{$ as N,a0 as Z,a3 as P,a1 as M,an as ee,a_ as te,b1 as ae,bf as ie,ag as d,a$ as se,b2 as ne,b0 as re,ad as ce,b3 as p,au as f,av as _,a4 as I,ah as i,aH as a,b5 as o,b6 as m,aF as R,b9 as oe,ba as le,bb as C,bB as ue,at as de}from"./index-1e3b5e9c.js";import{C as E,T as $}from"./transaction-api-service-8b388dbb.js";import{C as A}from"./contract-data-service-bee1e717.js";import{T}from"./publicUnit-82a6e2b0.js";import{M as D,a as fe}from"./constants-2bfeaeae.js";import{M as _e}from"./magnifier-api-service-8e21454b.js";import"./utils-518c8eb5.js";class B extends E{constructor(e,t,n){super(e,t,n)}static async connect(){const e=N(),t=await A.getMagnifierBuyData(e);return new B(t.contract_address,t.abi,e)}async magnifierPrice(){return Z(await this.contract.magnifier_price(),18)}async buyMagnifier(){const e=BigInt((await this.contract.magnifier_price()).toString());await this.checkNetwork();const{hash:t}=await P({...this.getConfig(),functionName:"buyMagnifier",args:[],value:e});return await new $().pushTxHash(t,this.chainId),t}}class S extends E{constructor(t,n,r){super(t,n,r);O(this,"default_token_id",0)}static async connect(){const t=N(),n=await A.getMagnifierNFTData(t);return new S(n.contract_address,n.abi,t)}async name(){return await this.contract.name()}async symbol(){return await this.contract.symbol()}async uri(){return await this.contract.uri(this.default_token_id)}async balanceOf(t){return M(await this.contract.balanceOf(t,this.default_token_id))}async totalSupply(){return await this.contract["totalSupply()"]()}}class q extends E{constructor(e,t,n){super(e,t,n)}static async connect(){const e=N(),t=await A.getMagnifierAirDropForOldUsersData(e);return new q(t.contract_address,t.abi,e)}async getMaxAmount(){return M(await this.contract.getMaxAmount())}async getExpiredTime(){return M(await this.contract.getExpiredTime())}async getTotalClaimedAmount(){return M(await this.contract.getTotalClaimedAmount())}async userIsEligible(e){return await this.contract.userIsEligible(e)}async userIsOld(e){return await this.contract.userIsOld(e)}async claimMagnifier(){await this.checkNetwork();const{hash:e}=await P({...this.getConfig(),functionName:"claimMagnifier",args:[]});return await new $().pushTxHash(e,this.chainId),e}}const b=s=>(oe("data-v-e61017dc"),s=s(),le(),s),ge={class:"font-f bg-[#161616] rounded-sm border-solid border-[1px] border-[#222] mt-[27px] m_magnifier",width:"1200px","wrap-class-name":"full-modal"},he={key:0,class:"flex space-x-[30px] py-[46px] px-[40px] m_content"},pe=b(()=>a("div",{class:"magnifier w-1/2 h-[573px]"},null,-1)),me={class:"w-1/2 m_buy_info"},ve={key:0},ye={class:"text-2xl text-white mb-[16px] m_title"},be={class:"text-[40px] text-[#BBF74C] m_price"},we={class:"delete free_mint"},xe=b(()=>a("div",{class:"w-[536px] h-[1px] bg-[#222222] my-[20px] m_line"},null,-1)),Me={key:1},ke={class:"text-2xl text-white mb-[16px]"},Ie={class:"text-[17px] text-[#666666] space-y-2.5 default-family"},Ce={class:"flex items-center"},Te=b(()=>a("div",{class:"mr-3 ball"},null,-1)),Ne=["innerHTML"],Ee={class:"flex items-center"},Ae=b(()=>a("div",{class:"mr-3 ball"},null,-1)),Be=["innerHTML"],Se={class:"flex items-center"},qe=b(()=>a("div",{class:"mr-3 ball"},null,-1)),Fe=["innerHTML"],He={key:0,class:"flex justify-between text-[17px] font-semibold h-[55px] mt-[30px] space-x-[15px]"},Le={key:0,class:"mt-[30px] text-[17px] text-black"},Oe={key:1,class:"mt-[30px] text-black"},Re=ee({__name:"BuyMagnifier",setup(s){const{t:e}=te(),t=ae(),n=ie();d(D);const r=d(0),v=d(!1);let F,w;const k=d(),g=se(),U=ne(),{open:V}=re(),l=d(!1),{match_id:h,quick:H}=n.query,y=d(!1),x=d(!1),L=new _e;ce(async()=>{v.value=!0;try{await G(),r.value==0&&await Y(),v.value=!1}catch(c){p(c.message,"error",!1,3),v.value=!1}});const G=async()=>{if(await L.checkUserHasMagnifier(g.address)){r.value=1;return}F=await S.connect(),r.value=await F.balanceOf(g.address)},Y=async()=>{var u;if(k.value=await q.connect(),await L.checkAirdrop(g.address,(u=U.chain)==null?void 0:u.id)){l.value=!0;return}l.value=await k.value.userIsEligible(g.address)},j=async()=>{if(!g.address){V();return}if(y.value=!0,w=await B.connect(),!await ue(g.address,w.getChainId())){p(`You may not finished the transaction, please check your ${T} balance`,"error",!1,3),y.value=!1;return}try{const c=await w.buyMagnifier();await w.waitForTransaction(c),p(e("views.buyMangifier.t10"),"success",!1,3),y.value=!1,h?H?t.push({path:"/fightInfo/index",query:{match_id:h,quick:"quick"}}):t.push({path:"/fightInfo/index",query:{match_id:h}}):t.push("/challenge/index")}catch(c){p(e("views.buyMangifier.t11"),"error",!1,3),console.log(c),y.value=!1}},K=async()=>{x.value=!0;try{await k.value.claimMagnifier(),p("claim success","success",!1,2,()=>{x.value=!1,h?H?t.push({path:"/fightInfo/index",query:{match_id:h,quick:"quick"}}):t.push({path:"/fightInfo/index",query:{match_id:h}}):t.push("/challenge/index")})}catch(c){p(c.message,"error",!1,3),x.value=!1}},W=()=>{t.push("/challenge/index")},z=()=>{t.go(-1)};return(c,u)=>(f(),_("div",ge,[I(i(C),{spinning:v.value},null,8,["spinning"]),v.value?m("",!0):(f(),_("div",he,[pe,a("div",me,[r.value==0?(f(),_("div",ve,[a("div",ye,o(l.value?i(e)("views.buyMangifier.t12"):i(e)("views.buyMangifier.t1")),1),a("div",be,o(l.value?0:i(D))+" "+o(i(T)),1),a("div",we,o(i(fe))+" "+o(i(T)),1),xe])):m("",!0),r.value!==0?(f(),_("div",Me,[a("div",ke,o(i(e)("views.buyMangifier.t7")),1)])):m("",!0),a("div",null,[a("div",Ie,[a("div",Ce,[Te,a("div",{innerHTML:i(e)("views.buyMangifier.t2")},null,8,Ne)]),a("div",Ee,[Ae,a("div",{innerHTML:i(e)("views.buyMangifier.t3")},null,8,Be)]),a("div",Se,[qe,a("div",{innerHTML:i(e)("views.buyMangifier.t4")},null,8,Fe)])]),I(i(C),{spinning:y.value},{default:R(()=>[r.value==0&&!l.value?(f(),_("div",He,[a("div",{class:"w-4/5 bg-primary mangifier mangifier_buy event_buy_magnifier",onClick:j},o(i(e)("views.buyMangifier.t5")),1),a("div",{class:"w-1/5 mangifier mangifier_back",onClick:z},o(i(e)("views.buyMangifier.t6")),1)])):m("",!0)]),_:1},8,["spinning"]),r.value!==0&&!l.value?(f(),_("div",Le,[a("div",{class:"h-[55px] mangifier bg-primary font-semibold",onClick:u[0]||(u[0]=J=>W())},o(i(e)("views.buyMangifier.t8")),1)])):m("",!0),l.value?(f(),_("div",Oe,[I(i(C),{spinning:x.value},{default:R(()=>[a("div",{class:"h-[55px] text-[17px] mangifier bg-primary font-semibold font-f event_buy_magnifier",onClick:u[1]||(u[1]=J=>K())}," Free Mint ")]),_:1},8,["spinning"])])):m("",!0)])])]))]))}});const Ke=de(Re,[["__scopeId","data-v-e61017dc"]]);export{Ke as default};
